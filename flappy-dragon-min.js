(function(a,c){function d(q){var a=Ja[q]={};return f.each(q.split(aa),function(q,c){a[c]=!0}),a}function b(q,a,b){if(b===c&&1===q.nodeType)if(b="data-"+a.replace(qb,"-$1").toLowerCase(),b=q.getAttribute(b),"string"==typeof b){try{b="true"===b?!0:"false"===b?!1:"null"===b?null:+b+""===b?+b:rb.test(b)?f.parseJSON(b):b}catch(d){}f.data(q,a,b)}else b=c;return b}function e(q){for(var a in q)if(!("data"===a&&f.isEmptyObject(q[a]))&&"toJSON"!==a)return!1;return!0}function g(){return!1}function l(){return!0}
function k(q){return!q||!q.parentNode||11===q.parentNode.nodeType}function n(q,a){do q=q[a];while(q&&1!==q.nodeType);return q}function s(q,a,c){a=a||0;if(f.isFunction(a))return f.grep(q,function(q,b){return!!a.call(q,b,q)===c});if(a.nodeType)return f.grep(q,function(q,b){return q===a===c});if("string"==typeof a){var b=f.grep(q,function(q){return 1===q.nodeType});if(sb.test(a))return f.filter(a,b,!c);a=f.filter(a,b)}return f.grep(q,function(q,b){return 0<=f.inArray(q,a)===c})}function u(q){var a=Ka.split("|");
q=q.createDocumentFragment();if(q.createElement)for(;a.length;)q.createElement(a.pop());return q}function t(q,a){if(1===a.nodeType&&f.hasData(q)){var c,b,d;b=f._data(q);var e=f._data(a,b),v=b.events;if(v)for(c in delete e.handle,e.events={},v){b=0;for(d=v[c].length;b<d;b++)f.event.add(a,c,v[c][b])}e.data&&(e.data=f.extend({},e.data))}}function r(q,a){var c;1===a.nodeType&&(a.clearAttributes&&a.clearAttributes(),a.mergeAttributes&&a.mergeAttributes(q),c=a.nodeName.toLowerCase(),"object"===c?(a.parentNode&&
(a.outerHTML=q.outerHTML),f.support.html5Clone&&q.innerHTML&&!f.trim(a.innerHTML)&&(a.innerHTML=q.innerHTML)):"input"===c&&La.test(q.type)?(a.defaultChecked=a.checked=q.checked,a.value!==q.value&&(a.value=q.value)):"option"===c?a.selected=q.defaultSelected:"input"===c||"textarea"===c?a.defaultValue=q.defaultValue:"script"===c&&a.text!==q.text&&(a.text=q.text),a.removeAttribute(f.expando))}function h(a){return"undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName("*"):"undefined"!=typeof a.querySelectorAll?
a.querySelectorAll("*"):[]}function m(a){La.test(a.type)&&(a.defaultChecked=a.checked)}function p(a,c){if(c in a)return c;for(var b=c.charAt(0).toUpperCase()+c.slice(1),f=c,d=Ma.length;d--;)if(c=Ma[d]+b,c in a)return c;return f}function y(a,c){return a=c||a,"none"===f.css(a,"display")||!f.contains(a.ownerDocument,a)}function C(a,c){for(var b,d,e=[],w=0,v=a.length;w<v;w++)b=a[w],b.style&&(e[w]=f._data(b,"olddisplay"),c?(!e[w]&&"none"===b.style.display&&(b.style.display=""),""===b.style.display&&y(b)&&
(e[w]=f._data(b,"olddisplay",Q(b.nodeName)))):(d=L(b,"display"),!e[w]&&"none"!==d&&f._data(b,"olddisplay",d)));for(w=0;w<v;w++)if(b=a[w],b.style&&(!c||"none"===b.style.display||""===b.style.display))b.style.display=c?e[w]||"":"none";return a}function D(a,c,b){return(a=tb.exec(c))?Math.max(0,a[1]-(b||0))+(a[2]||"px"):c}function E(a,c,b,d){c=b===(d?"border":"content")?4:"width"===c?1:0;for(var e=0;4>c;c+=2)"margin"===b&&(e+=f.css(a,b+ba[c],!0)),d?("content"===b&&(e-=parseFloat(L(a,"padding"+ba[c]))||
0),"margin"!==b&&(e-=parseFloat(L(a,"border"+ba[c]+"Width"))||0)):(e+=parseFloat(L(a,"padding"+ba[c]))||0,"padding"!==b&&(e+=parseFloat(L(a,"border"+ba[c]+"Width"))||0));return e}function H(a,c,b){var d="width"===c?a.offsetWidth:a.offsetHeight,e=!0,w=f.support.boxSizing&&"border-box"===f.css(a,"boxSizing");if(0>=d||null==d){d=L(a,c);if(0>d||null==d)d=a.style[c];if(ha.test(d))return d;e=w&&(f.support.boxSizingReliable||d===a.style[c]);d=parseFloat(d)||0}return d+E(a,c,b||(w?"border":"content"),e)+
"px"}function Q(a){if(ya[a])return ya[a];var c=f("\x3c"+a+"\x3e").appendTo(x.body),b=c.css("display");c.remove();if("none"===b||""===b){Z=x.body.appendChild(Z||f.extend(x.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!ea||!Z.createElement)ea=(Z.contentWindow||Z.contentDocument).document,ea.write("\x3c!doctype html\x3e\x3chtml\x3e\x3cbody\x3e"),ea.close();c=ea.body.appendChild(ea.createElement(a));b=L(c,"display");x.body.removeChild(Z)}return ya[a]=b,b}function S(a,c,b,d){var e;if(f.isArray(c))f.each(c,
function(c,z){b||ub.test(a)?d(a,z):S(a+"["+("object"==typeof z?c:"")+"]",z,b,d)});else if(!b&&"object"===f.type(c))for(e in c)S(a+"["+e+"]",c[e],b,d);else d(a,c)}function A(a){return function(c,b){"string"!=typeof c&&(b=c,c="*");var d,e,w=c.toLowerCase().split(aa),v=0,h=w.length;if(f.isFunction(b))for(;v<h;v++)d=w[v],(e=/^\+/.test(d))&&(d=d.substr(1)||"*"),d=a[d]=a[d]||[],d[e?"unshift":"push"](b)}}function J(a,b,d,f,e,w){e=e||b.dataTypes[0];w=w||{};w[e]=!0;var v;e=a[e];for(var h=0,g=e?e.length:0,
p=a===za;h<g&&(p||!v);h++)v=e[h](b,d,f),"string"==typeof v&&(!p||w[v]?v=c:(b.dataTypes.unshift(v),v=J(a,b,d,f,v,w)));return(p||!v)&&!w["*"]&&(v=J(a,b,d,f,"*",w)),v}function ka(a,b){var d,e,P=f.ajaxSettings.flatOptions||{};for(d in b)b[d]!==c&&((P[d]?a:e||(e={}))[d]=b[d]);e&&f.extend(!0,a,e)}function la(){try{return new a.XMLHttpRequest}catch(q){}}function ma(){return setTimeout(function(){pa=c},0),pa=f.now()}function ra(a,c){f.each(c,function(c,b){for(var z=(ia[c]||[]).concat(ia["*"]),d=0,f=z.length;d<
f&&!z[d].call(a,c,b);d++);})}function sa(a,c,b){var d=0,e=ta.length,w=f.Deferred().always(function(){delete v.elem}),v=function(){for(var c=pa||ma(),c=Math.max(0,h.startTime+h.duration-c),b=1-(c/h.duration||0),z=0,d=h.tweens.length;z<d;z++)h.tweens[z].run(b);return w.notifyWith(a,[h,b,c]),1>b&&d?c:(w.resolveWith(a,[h]),!1)},h=w.promise({elem:a,props:f.extend({},c),opts:f.extend(!0,{specialEasing:{}},b),originalProperties:c,originalOptions:b,startTime:pa||ma(),duration:b.duration,tweens:[],createTween:function(c,
b,z){c=f.Tween(a,h.opts,c,b,h.opts.specialEasing[c]||h.opts.easing);return h.tweens.push(c),c},stop:function(c){for(var b=0,z=c?h.tweens.length:0;b<z;b++)h.tweens[b].run(1);return c?w.resolveWith(a,[h,c]):w.rejectWith(a,[h,c]),this}});b=h.props;for(Aa(b,h.opts.specialEasing);d<e;d++)if(c=ta[d].call(h,a,b,h.opts))return c;return ra(h,b),f.isFunction(h.opts.start)&&h.opts.start.call(a,h),f.fx.timer(f.extend(v,{anim:h,queue:h.opts.queue,elem:a})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}
function Aa(a,c){var b,d,e,h,v;for(b in a)if(d=f.camelCase(b),e=c[d],h=a[b],f.isArray(h)&&(e=h[1],h=a[b]=h[0]),b!==d&&(a[d]=h,delete a[b]),(v=f.cssHooks[d])&&"expand"in v)for(b in h=v.expand(h),delete a[d],h)b in a||(a[b]=h[b],c[b]=e);else c[d]=e}function M(a,c,b,d,f){return new M.prototype.init(a,c,b,d,f)}function V(a,c){var b,d={height:a},f=0;for(c=c?1:0;4>f;f+=2-c)b=ba[f],d["margin"+b]=d["padding"+b]=a;return c&&(d.opacity=d.width=a),d}function B(a){return f.isWindow(a)?a:9===a.nodeType?a.defaultView||
a.parentWindow:!1}var N,O,x=a.document,vb=a.location,qa=a.navigator,wb=a.jQuery,xb=a.$,Oa=Array.prototype.push,T=Array.prototype.slice,Pa=Array.prototype.indexOf,yb=Object.prototype.toString,Ba=Object.prototype.hasOwnProperty,Ca=String.prototype.trim,f=function(a,c){return new f.fn.init(a,c,N)},ua=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,zb=/\S/,aa=/\s+/,Ab=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Bb=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Qa=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Cb=/^[\],:{}\s]*$/,Db=
/(?:^|:|,)(?:\s*\[)+/g,Eb=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Fb=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,Gb=/^-ms-/,Hb=/-([\da-z])/gi,Ib=function(a,c){return(c+"").toUpperCase()},va=function(){x.addEventListener?(x.removeEventListener("DOMContentLoaded",va,!1),f.ready()):"complete"===x.readyState&&(x.detachEvent("onreadystatechange",va),f.ready())},Ra={};f.fn=f.prototype={constructor:f,init:function(a,b,d){var e,P;if(!a)return this;if(a.nodeType)return this.context=this[0]=
a,this.length=1,this;if("string"==typeof a){"\x3c"===a.charAt(0)&&"\x3e"===a.charAt(a.length-1)&&3<=a.length?e=[null,a,null]:e=Bb.exec(a);if(e&&(e[1]||!b)){if(e[1])return b=b instanceof f?b[0]:b,P=b&&b.nodeType?b.ownerDocument||b:x,a=f.parseHTML(e[1],P,!0),Qa.test(e[1])&&f.isPlainObject(b)&&this.attr.call(a,b,!0),f.merge(this,a);if((b=x.getElementById(e[2]))&&b.parentNode){if(b.id!==e[2])return d.find(a);this.length=1;this[0]=b}return this.context=x,this.selector=a,this}return!b||b.jquery?(b||d).find(a):
this.constructor(b).find(a)}return f.isFunction(a)?d.ready(a):(a.selector!==c&&(this.selector=a.selector,this.context=a.context),f.makeArray(a,this))},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return T.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a,c,b){a=f.merge(this.constructor(),a);return a.prevObject=this,a.context=this.context,"find"===c?a.selector=this.selector+(this.selector?" ":
"")+b:c&&(a.selector=this.selector+"."+c+"("+b+")"),a},each:function(a,c){return f.each(this,a,c)},ready:function(a){return f.ready.promise().done(a),this},eq:function(a){return a=+a,-1===a?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(T.apply(this,arguments),"slice",T.call(arguments).join(","))},map:function(a){return this.pushStack(f.map(this,function(c,b){return a.call(c,b,c)}))},end:function(){return this.prevObject||
this.constructor(null)},push:Oa,sort:[].sort,splice:[].splice};f.fn.init.prototype=f.fn;f.extend=f.fn.extend=function(){var a,b,d,e,P,h,v=arguments[0]||{},g=1,p=arguments.length,m=!1;"boolean"==typeof v&&(m=v,v=arguments[1]||{},g=2);"object"!=typeof v&&!f.isFunction(v)&&(v={});for(p===g&&(v=this,--g);g<p;g++)if(null!=(a=arguments[g]))for(b in a)d=v[b],e=a[b],v!==e&&(m&&e&&(f.isPlainObject(e)||(P=f.isArray(e)))?(P?(P=!1,h=d&&f.isArray(d)?d:[]):h=d&&f.isPlainObject(d)?d:{},v[b]=f.extend(m,h,e)):e!==
c&&(v[b]=e));return v};f.extend({noConflict:function(q){return a.$===f&&(a.$=xb),q&&a.jQuery===f&&(a.jQuery=wb),f},isReady:!1,readyWait:1,holdReady:function(a){a?f.readyWait++:f.ready(!0)},ready:function(a){if(!(!0===a?--f.readyWait:f.isReady)){if(!x.body)return setTimeout(f.ready,1);f.isReady=!0;!0!==a&&0<--f.readyWait||(O.resolveWith(x,[f]),f.fn.trigger&&f(x).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===f.type(a)},isArray:Array.isArray||function(a){return"array"===
f.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):Ra[yb.call(a)]||"object"},isPlainObject:function(a){if(!a||"object"!==f.type(a)||a.nodeType||f.isWindow(a))return!1;try{if(a.constructor&&!Ba.call(a,"constructor")&&!Ba.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}for(var d in a);return d===c||Ba.call(a,d)},isEmptyObject:function(a){for(var c in a)return!1;
return!0},error:function(a){throw Error(a);},parseHTML:function(a,c,b){var d;return!a||"string"!=typeof a?null:("boolean"==typeof c&&(b=c,c=0),c=c||x,(d=Qa.exec(a))?[c.createElement(d[1])]:(d=f.buildFragment([a],c,b?null:[]),f.merge([],(d.cacheable?f.clone(d.fragment):d.fragment).childNodes)))},parseJSON:function(q){if(!q||"string"!=typeof q)return null;q=f.trim(q);if(a.JSON&&a.JSON.parse)return a.JSON.parse(q);if(Cb.test(q.replace(Eb,"@").replace(Fb,"]").replace(Db,"")))return(new Function("return "+
q))();f.error("Invalid JSON: "+q)},parseXML:function(q){var b,d;if(!q||"string"!=typeof q)return null;try{a.DOMParser?(d=new DOMParser,b=d.parseFromString(q,"text/xml")):(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(q))}catch(e){b=c}return(!b||!b.documentElement||b.getElementsByTagName("parsererror").length)&&f.error("Invalid XML: "+q),b},noop:function(){},globalEval:function(q){q&&zb.test(q)&&(a.execScript||function(q){a.eval.call(a,q)})(q)},camelCase:function(a){return a.replace(Gb,
"ms-").replace(Hb,Ib)},nodeName:function(a,c){return a.nodeName&&a.nodeName.toLowerCase()===c.toLowerCase()},each:function(a,b,d){var e,h=0,w=a.length,v=w===c||f.isFunction(a);if(d)if(v)for(e in a){if(!1===b.apply(a[e],d))break}else for(;h<w&&!1!==b.apply(a[h++],d););else if(v)for(e in a){if(!1===b.call(a[e],e,a[e]))break}else for(;h<w&&!1!==b.call(a[h],h,a[h++]););return a},trim:Ca&&!Ca.call("\ufeff\u00a0")?function(a){return null==a?"":Ca.call(a)}:function(a){return null==a?"":(a+"").replace(Ab,
"")},makeArray:function(a,c){var b,d=c||[];return null!=a&&(b=f.type(a),null==a.length||"string"===b||"function"===b||"regexp"===b||f.isWindow(a)?Oa.call(d,a):f.merge(d,a)),d},inArray:function(a,c,b){var d;if(c){if(Pa)return Pa.call(c,a,b);d=c.length;for(b=b?0>b?Math.max(0,d+b):b:0;b<d;b++)if(b in c&&c[b]===a)return b}return-1},merge:function(a,b){var d=b.length,f=a.length,e=0;if("number"==typeof d)for(;e<d;e++)a[f++]=b[e];else for(;b[e]!==c;)a[f++]=b[e++];return a.length=f,a},grep:function(a,c,b){var d,
f=[],e=0,h=a.length;for(b=!!b;e<h;e++)d=!!c(a[e],e),b!==d&&f.push(a[e]);return f},map:function(a,b,d){var e,h,w=[],v=0,g=a.length;if(a instanceof f||g!==c&&"number"==typeof g&&(0<g&&a[0]&&a[g-1]||0===g||f.isArray(a)))for(;v<g;v++)e=b(a[v],v,d),null!=e&&(w[w.length]=e);else for(h in a)e=b(a[h],h,d),null!=e&&(w[w.length]=e);return w.concat.apply([],w)},guid:1,proxy:function(a,b){var d,e,h;return"string"==typeof b&&(d=a[b],b=a,a=d),f.isFunction(a)?(e=T.call(arguments,2),h=function(){return a.apply(b,
e.concat(T.call(arguments)))},h.guid=a.guid=a.guid||f.guid++,h):c},access:function(a,b,d,e,h,w,v){var g,p=null==d,m=0,k=a.length;if(d&&"object"==typeof d){for(m in d)f.access(a,b,m,d[m],1,w,e);h=1}else if(e!==c){g=v===c&&f.isFunction(e);p&&(g?(g=b,b=function(a,c,q){return g.call(f(a),q)}):(b.call(a,e),b=null));if(b)for(;m<k;m++)b(a[m],d,g?e.call(a[m],m,b(a[m],d)):e,v);h=1}return h?a:p?b.call(a):k?b(a[0],d):w},now:function(){return(new Date).getTime()}});f.ready.promise=function(c){if(!O)if(O=f.Deferred(),
"complete"===x.readyState)setTimeout(f.ready,1);else if(x.addEventListener)x.addEventListener("DOMContentLoaded",va,!1),a.addEventListener("load",f.ready,!1);else{x.attachEvent("onreadystatechange",va);a.attachEvent("onload",f.ready);var b=!1;try{b=null==a.frameElement&&x.documentElement}catch(d){}b&&b.doScroll&&function P(){if(!f.isReady){try{b.doScroll("left")}catch(a){return setTimeout(P,50)}f.ready()}}()}return O.promise(c)};f.each("Boolean Number String Function Array Date RegExp Object".split(" "),
function(a,c){Ra["[object "+c+"]"]=c.toLowerCase()});N=f(x);var Ja={};f.Callbacks=function(a){a="string"==typeof a?Ja[a]||d(a):f.extend({},a);var b,e,h,P,w,v,g=[],p=!a.once&&[],m=function(c){b=a.memory&&c;e=!0;v=P||0;P=0;w=g.length;for(h=!0;g&&v<w;v++)if(!1===g[v].apply(c[0],c[1])&&a.stopOnFalse){b=!1;break}h=!1;g&&(p?p.length&&m(p.shift()):b?g=[]:k.disable())},k={add:function(){if(g){var c=g.length;(function Jb(c){f.each(c,function(c,b){var d=f.type(b);"function"===d&&(!a.unique||!k.has(b))?g.push(b):
b&&b.length&&"string"!==d&&Jb(b)})})(arguments);h?w=g.length:b&&(P=c,m(b))}return this},remove:function(){return g&&f.each(arguments,function(a,c){for(var b;-1<(b=f.inArray(c,g,b));)g.splice(b,1),h&&(b<=w&&w--,b<=v&&v--)}),this},has:function(a){return-1<f.inArray(a,g)},empty:function(){return g=[],this},disable:function(){return g=p=b=c,this},disabled:function(){return!g},lock:function(){return p=c,b||k.disable(),this},locked:function(){return!p},fireWith:function(a,c){return c=c||[],c=[a,c.slice?
c.slice():c],g&&(!e||p)&&(h?p.push(c):m(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!e}};return k};f.extend({Deferred:function(a){var c=[["resolve","done",f.Callbacks("once memory"),"resolved"],["reject","fail",f.Callbacks("once memory"),"rejected"],["notify","progress",f.Callbacks("memory")]],b="pending",d={state:function(){return b},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return f.Deferred(function(b){f.each(c,
function(c,q){var d=q[0],z=a[c];e[q[1]](f.isFunction(z)?function(){var a=z.apply(this,arguments);a&&f.isFunction(a.promise)?a.promise().done(b.resolve).fail(b.reject).progress(b.notify):b[d+"With"](this===e?b:this,[a])}:b[d])});a=null}).promise()},promise:function(a){return null!=a?f.extend(a,d):d}},e={};return d.pipe=d.then,f.each(c,function(a,q){var f=q[2],h=q[3];d[q[1]]=f.add;h&&f.add(function(){b=h},c[a^1][2].disable,c[2][2].lock);e[q[0]]=f.fire;e[q[0]+"With"]=f.fireWith}),d.promise(e),a&&a.call(e,
e),e},when:function(a){var c=0,b=T.call(arguments),d=b.length,e=1!==d||a&&f.isFunction(a.promise)?d:0,h=1===e?a:f.Deferred(),g=function(a,c,b){return function(q){c[a]=this;b[a]=1<arguments.length?T.call(arguments):q;b===p?h.notifyWith(c,b):--e||h.resolveWith(c,b)}},p,m,k;if(1<d){p=Array(d);m=Array(d);for(k=Array(d);c<d;c++)b[c]&&f.isFunction(b[c].promise)?b[c].promise().done(g(c,k,b)).fail(h.reject).progress(g(c,m,p)):--e}return e||h.resolveWith(k,b),h.promise()}});f.support=function(){var c,b,d,
e,h,g,v,p,m=x.createElement("div");m.setAttribute("className","t");m.innerHTML="  \x3clink/\x3e\x3ctable\x3e\x3c/table\x3e\x3ca href\x3d'/a'\x3ea\x3c/a\x3e\x3cinput type\x3d'checkbox'/\x3e";b=m.getElementsByTagName("*");d=m.getElementsByTagName("a")[0];d.style.cssText="top:1px;float:left;opacity:.5";if(!b||!b.length)return{};e=x.createElement("select");h=e.appendChild(x.createElement("option"));b=m.getElementsByTagName("input")[0];c={leadingWhitespace:3===m.firstChild.nodeType,tbody:!m.getElementsByTagName("tbody").length,
htmlSerialize:!!m.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:"/a"===d.getAttribute("href"),opacity:/^0.5/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:"on"===b.value,optSelected:h.selected,getSetAttribute:"t"!==m.className,enctype:!!x.createElement("form").enctype,html5Clone:"\x3c:nav\x3e\x3c/:nav\x3e"!==x.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===x.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,
deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1};b.checked=!0;c.noCloneChecked=b.cloneNode(!0).checked;e.disabled=!0;c.optDisabled=!h.disabled;try{delete m.test}catch(k){c.deleteExpando=!1}!m.addEventListener&&m.attachEvent&&m.fireEvent&&(m.attachEvent("onclick",p=function(){c.noCloneEvent=!1}),m.cloneNode(!0).fireEvent("onclick"),m.detachEvent("onclick",p));b=x.createElement("input");b.value="t";b.setAttribute("type",
"radio");c.radioValue="t"===b.value;b.setAttribute("checked","checked");b.setAttribute("name","t");m.appendChild(b);d=x.createDocumentFragment();d.appendChild(m.lastChild);c.checkClone=d.cloneNode(!0).cloneNode(!0).lastChild.checked;c.appendChecked=b.checked;d.removeChild(b);d.appendChild(m);if(m.attachEvent)for(g in{submit:!0,change:!0,focusin:!0})b="on"+g,(v=b in m)||(m.setAttribute(b,"return;"),v="function"==typeof m[b]),c[g+"Bubbles"]=v;return f(function(){var b,d,f,e,z=x.getElementsByTagName("body")[0];
z&&(b=x.createElement("div"),b.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",z.insertBefore(b,z.firstChild),d=x.createElement("div"),b.appendChild(d),d.innerHTML="\x3ctable\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3et\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",f=d.getElementsByTagName("td"),f[0].style.cssText="padding:0;margin:0;border:0;display:none",v=0===f[0].offsetHeight,f[0].style.display="",f[1].style.display="none",c.reliableHiddenOffsets=v&&0===
f[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",c.boxSizing=4===d.offsetWidth,c.doesNotIncludeMarginInBodyOffset=1!==z.offsetTop,a.getComputedStyle&&(c.pixelPosition="1%"!==(a.getComputedStyle(d,null)||{}).top,c.boxSizingReliable="4px"===(a.getComputedStyle(d,null)||{width:"4px"}).width,e=x.createElement("div"),e.style.cssText=d.style.cssText=
"padding:0;margin:0;border:0;display:block;overflow:hidden;",e.style.marginRight=e.style.width="0",d.style.width="1px",d.appendChild(e),c.reliableMarginRight=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight)),"undefined"!=typeof d.style.zoom&&(d.innerHTML="",d.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;width:1px;padding:1px;display:inline;zoom:1",c.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.style.overflow="visible",d.innerHTML="\x3cdiv\x3e\x3c/div\x3e",
d.firstChild.style.width="5px",c.shrinkWrapBlocks=3!==d.offsetWidth,b.style.zoom=1),z.removeChild(b))}),d.removeChild(m),b=d=e=h=b=d=m=null,c}();var rb=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,qb=/([A-Z])/g;f.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?f.cache[a[f.expando]]:a[f.expando],!!a&&!e(a)},data:function(a,b,d,e){if(f.acceptData(a)){var h,
g,v=f.expando,m="string"==typeof b,p=a.nodeType,k=p?f.cache:a,r=p?a[v]:a[v]&&v;if(r&&k[r]&&(e||k[r].data)||!(m&&d===c)){r||(p?a[v]=r=f.deletedIds.pop()||f.guid++:r=v);k[r]||(k[r]={},p||(k[r].toJSON=f.noop));if("object"==typeof b||"function"==typeof b)e?k[r]=f.extend(k[r],b):k[r].data=f.extend(k[r].data,b);return h=k[r],e||(h.data||(h.data={}),h=h.data),d!==c&&(h[f.camelCase(b)]=d),m?(g=h[b],null==g&&(g=h[f.camelCase(b)])):g=h,g}}},removeData:function(a,c,b){if(f.acceptData(a)){var d,h,g,v=a.nodeType,
m=v?f.cache:a,p=v?a[f.expando]:f.expando;if(m[p]){if(c&&(d=b?m[p]:m[p].data)){f.isArray(c)||(c in d?c=[c]:(c=f.camelCase(c),c in d?c=[c]:c=c.split(" ")));h=0;for(g=c.length;h<g;h++)delete d[c[h]];if(!(b?e:f.isEmptyObject)(d))return}if(!b&&(delete m[p].data,!e(m[p])))return;v?f.cleanData([a],!0):f.support.deleteExpando||m!=m.window?delete m[p]:m[p]=null}}},_data:function(a,c,b){return f.data(a,c,b,!0)},acceptData:function(a){var c=a.nodeName&&f.noData[a.nodeName.toLowerCase()];return!c||!0!==c&&a.getAttribute("classid")===
c}});f.fn.extend({data:function(a,d){var e,h,g,m,v,p=this[0],k=0,r=null;if(a===c){if(this.length&&(r=f.data(p),1===p.nodeType&&!f._data(p,"parsedAttrs"))){g=p.attributes;for(v=g.length;k<v;k++)m=g[k].name,m.indexOf("data-")||(m=f.camelCase(m.substring(5)),b(p,m,r[m]));f._data(p,"parsedAttrs",!0)}return r}return"object"==typeof a?this.each(function(){f.data(this,a)}):(e=a.split(".",2),e[1]=e[1]?"."+e[1]:"",h=e[1]+"!",f.access(this,function(d){if(d===c)return r=this.triggerHandler("getData"+h,[e[0]]),
r===c&&p&&(r=f.data(p,a),r=b(p,a,r)),r===c&&e[1]?this.data(e[0]):r;e[1]=d;this.each(function(){var c=f(this);c.triggerHandler("setData"+h,e);f.data(this,a,d);c.triggerHandler("changeData"+h,e)})},null,d,1<arguments.length,null,!1))},removeData:function(a){return this.each(function(){f.removeData(this,a)})}});f.extend({queue:function(a,c,b){var d;if(a)return c=(c||"fx")+"queue",d=f._data(a,c),b&&(!d||f.isArray(b)?d=f._data(a,c,f.makeArray(b)):d.push(b)),d||[]},dequeue:function(a,c){c=c||"fx";var b=
f.queue(a,c),d=b.length,e=b.shift(),h=f._queueHooks(a,c),g=function(){f.dequeue(a,c)};"inprogress"===e&&(e=b.shift(),d--);e&&("fx"===c&&b.unshift("inprogress"),delete h.stop,e.call(a,g,h));!d&&h&&h.empty.fire()},_queueHooks:function(a,c){var b=c+"queueHooks";return f._data(a,b)||f._data(a,b,{empty:f.Callbacks("once memory").add(function(){f.removeData(a,c+"queue",!0);f.removeData(a,b,!0)})})}});f.fn.extend({queue:function(a,b){var d=2;return"string"!=typeof a&&(b=a,a="fx",d--),arguments.length<d?
f.queue(this[0],a):b===c?this:this.each(function(){var c=f.queue(this,a,b);f._queueHooks(this,a);"fx"===a&&"inprogress"!==c[0]&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,c){return a=f.fx?f.fx.speeds[a]||a:a,c=c||"fx",this.queue(c,function(c,b){var d=setTimeout(c,a);b.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var d,e=1,h=f.Deferred(),g=this,m=this.length,p=function(){--e||
h.resolveWith(g,[g])};"string"!=typeof a&&(b=a,a=c);for(a=a||"fx";m--;)(d=f._data(g[m],a+"queueHooks"))&&d.empty&&(e++,d.empty.add(p));return p(),h.promise(b)}});var R,Sa,Ta,Ua=/[\t\r\n]/g,Kb=/\r/g,Lb=/^(?:button|input)$/i,Mb=/^(?:button|input|object|select|textarea)$/i,Nb=/^a(?:rea|)$/i,Va=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Wa=f.support.getSetAttribute;f.fn.extend({attr:function(a,c){return f.access(this,f.attr,
a,c,1<arguments.length)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,c){return f.access(this,f.prop,a,c,1<arguments.length)},removeProp:function(a){return a=f.propFix[a]||a,this.each(function(){try{this[a]=c,delete this[a]}catch(b){}})},addClass:function(a){var c,b,d,e,h,g,m;if(f.isFunction(a))return this.each(function(c){f(this).addClass(a.call(this,c,this.className))});if(a&&"string"==typeof a){c=a.split(aa);b=0;for(d=this.length;b<d;b++)if(e=this[b],
1===e.nodeType)if(!e.className&&1===c.length)e.className=a;else{h=" "+e.className+" ";g=0;for(m=c.length;g<m;g++)0>h.indexOf(" "+c[g]+" ")&&(h+=c[g]+" ");e.className=f.trim(h)}}return this},removeClass:function(a){var b,d,e,h,g,m,p;if(f.isFunction(a))return this.each(function(c){f(this).removeClass(a.call(this,c,this.className))});if(a&&"string"==typeof a||a===c){b=(a||"").split(aa);m=0;for(p=this.length;m<p;m++)if(e=this[m],1===e.nodeType&&e.className){d=(" "+e.className+" ").replace(Ua," ");h=0;
for(g=b.length;h<g;h++)for(;0<=d.indexOf(" "+b[h]+" ");)d=d.replace(" "+b[h]+" "," ");e.className=a?f.trim(d):""}}return this},toggleClass:function(a,c){var b=typeof a,d="boolean"==typeof c;return f.isFunction(a)?this.each(function(b){f(this).toggleClass(a.call(this,b,this.className,c),c)}):this.each(function(){if("string"===b)for(var e,h=0,g=f(this),m=c,p=a.split(aa);e=p[h++];)m=d?m:!g.hasClass(e),g[m?"addClass":"removeClass"](e);else if("undefined"===b||"boolean"===b)this.className&&f._data(this,
"__className__",this.className),this.className=this.className||!1===a?"":f._data(this,"__className__")||""})},hasClass:function(a){a=" "+a+" ";for(var c=0,b=this.length;c<b;c++)if(1===this[c].nodeType&&0<=(" "+this[c].className+" ").replace(Ua," ").indexOf(a))return!0;return!1},val:function(a){var b,d,e,h=this[0];if(arguments.length)return e=f.isFunction(a),this.each(function(d){var F,h=f(this);if(1===this.nodeType&&(e?F=a.call(this,d,h.val()):F=a,null==F?F="":"number"==typeof F?F+="":f.isArray(F)&&
(F=f.map(F,function(a){return null==a?"":a+""})),b=f.valHooks[this.type]||f.valHooks[this.nodeName.toLowerCase()],!b||!("set"in b)||b.set(this,F,"value")===c))this.value=F});if(h)return b=f.valHooks[h.type]||f.valHooks[h.nodeName.toLowerCase()],b&&"get"in b&&(d=b.get(h,"value"))!==c?d:(d=h.value,"string"==typeof d?d.replace(Kb,""):null==d?"":d)}});f.extend({valHooks:{option:{get:function(a){var c=a.attributes.value;return!c||c.specified?a.value:a.text}},select:{get:function(a){var c,b,d=a.selectedIndex,
e=[],h=a.options,g="select-one"===a.type;if(0>d)return null;a=g?d:0;for(b=g?d+1:h.length;a<b;a++)if(c=h[a],c.selected&&(f.support.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!f.nodeName(c.parentNode,"optgroup"))){c=f(c).val();if(g)return c;e.push(c)}return g&&!e.length&&h.length?f(h[d]).val():e},set:function(a,c){var b=f.makeArray(c);return f(a).find("option").each(function(){this.selected=0<=f.inArray(f(this).val(),b)}),b.length||(a.selectedIndex=-1),b}}},
attrFn:{},attr:function(a,b,d,e){var h,g,m=a.nodeType;if(a&&!(3===m||8===m||2===m)){if(e&&f.isFunction(f.fn[b]))return f(a)[b](d);if("undefined"==typeof a.getAttribute)return f.prop(a,b,d);(e=1!==m||!f.isXMLDoc(a))&&(b=b.toLowerCase(),g=f.attrHooks[b]||(Va.test(b)?Sa:R));if(d!==c){if(null===d){f.removeAttr(a,b);return}return g&&"set"in g&&e&&(h=g.set(a,d,b))!==c?h:(a.setAttribute(b,d+""),d)}return g&&"get"in g&&e&&null!==(h=g.get(a,b))?h:(h=a.getAttribute(b),null===h?c:h)}},removeAttr:function(a,
c){var b,d,e,h,g=0;if(c&&1===a.nodeType)for(d=c.split(aa);g<d.length;g++)(e=d[g])&&(b=f.propFix[e]||e,h=Va.test(e),h||f.attr(a,e,""),a.removeAttribute(Wa?e:b),h&&b in a&&(a[b]=!1))},attrHooks:{type:{set:function(a,c){if(Lb.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&"radio"===c&&f.nodeName(a,"input")){var b=a.value;return a.setAttribute("type",c),b&&(a.value=b),c}}},value:{get:function(a,c){return R&&f.nodeName(a,"button")?R.get(a,c):c in
a?a.value:null},set:function(a,c,b){if(R&&f.nodeName(a,"button"))return R.set(a,c,b);a.value=c}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,b,d){var e,h,g,m=a.nodeType;if(a&&!(3===m||8===m||2===m))return g=1!==m||!f.isXMLDoc(a),g&&(b=f.propFix[b]||b,h=f.propHooks[b]),
d!==c?h&&"set"in h&&(e=h.set(a,d,b))!==c?e:a[b]=d:h&&"get"in h&&null!==(e=h.get(a,b))?e:a[b]},propHooks:{tabIndex:{get:function(a){var b=a.getAttributeNode("tabindex");return b&&b.specified?parseInt(b.value,10):Mb.test(a.nodeName)||Nb.test(a.nodeName)&&a.href?0:c}}}});Sa={get:function(a,b){var d,e=f.prop(a,b);return!0===e||"boolean"!=typeof e&&(d=a.getAttributeNode(b))&&!1!==d.nodeValue?b.toLowerCase():c},set:function(a,c,b){var d;return!1===c?f.removeAttr(a,b):(d=f.propFix[b]||b,d in a&&(a[d]=!0),
a.setAttribute(b,b.toLowerCase())),b}};Wa||(Ta={name:!0,id:!0,coords:!0},R=f.valHooks.button={get:function(a,b){var d;return d=a.getAttributeNode(b),d&&(Ta[b]?""!==d.value:d.specified)?d.value:c},set:function(a,c,b){var d=a.getAttributeNode(b);return d||(d=x.createAttribute(b),a.setAttributeNode(d)),d.value=c+""}},f.each(["width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{set:function(a,b){if(""===b)return a.setAttribute(c,"auto"),b}})}),f.attrHooks.contenteditable={get:R.get,
set:function(a,c,b){""===c&&(c="false");R.set(a,c,b)}});f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{get:function(a){a=a.getAttribute(b,2);return null===a?c:a}})});f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||c},set:function(a,c){return a.style.cssText=c+""}});f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){a=a.parentNode;return a&&(a.selectedIndex,
a.parentNode&&a.parentNode.selectedIndex),null}}));f.support.enctype||(f.propFix.enctype="encoding");f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}});f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,c){if(f.isArray(c))return a.checked=0<=f.inArray(f(a).val(),c)}})});var Da=/^(?:textarea|input|select)$/i,Xa=/^([^\.]*|)(?:\.(.+)|)$/,Ob=/(?:^|\s)hover(\.\S+|)\b/,
Pb=/^key/,Qb=/^(?:mouse|contextmenu)|click/,Ya=/^(?:focusinfocus|focusoutblur)$/,Za=function(a){return f.event.special.hover?a:a.replace(Ob,"mouseenter$1 mouseleave$1")};f.event={add:function(a,b,d,e,h){var g,m,p,k,r,l,y,n,s;if(!(3===a.nodeType||8===a.nodeType||!b||!d||!(g=f._data(a)))){d.handler&&(y=d,d=y.handler,h=y.selector);d.guid||(d.guid=f.guid++);(p=g.events)||(g.events=p={});(m=g.handle)||(g.handle=m=function(a){return"undefined"!=typeof f&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(m.elem,
arguments):c},m.elem=a);b=f.trim(Za(b)).split(" ");for(g=0;g<b.length;g++){k=Xa.exec(b[g])||[];r=k[1];l=(k[2]||"").split(".").sort();s=f.event.special[r]||{};r=(h?s.delegateType:s.bindType)||r;s=f.event.special[r]||{};k=f.extend({type:r,origType:k[1],data:e,handler:d,guid:d.guid,selector:h,needsContext:h&&f.expr.match.needsContext.test(h),namespace:l.join(".")},y);n=p[r];if(!n&&(n=p[r]=[],n.delegateCount=0,!s.setup||!1===s.setup.call(a,e,l,m)))a.addEventListener?a.addEventListener(r,m,!1):a.attachEvent&&
a.attachEvent("on"+r,m);s.add&&(s.add.call(a,k),k.handler.guid||(k.handler.guid=d.guid));h?n.splice(n.delegateCount++,0,k):n.push(k);f.event.global[r]=!0}a=null}},global:{},remove:function(a,c,b,d,e){var h,g,m,p,k,r,l,y,n,s,D=f.hasData(a)&&f._data(a);if(D&&(l=D.events)){c=f.trim(Za(c||"")).split(" ");for(h=0;h<c.length;h++)if(g=Xa.exec(c[h])||[],m=p=g[1],g=g[2],m){y=f.event.special[m]||{};m=(d?y.delegateType:y.bindType)||m;n=l[m]||[];k=n.length;g=g?RegExp("(^|\\.)"+g.split(".").sort().join("\\.(?:.*\\.|)")+
"(\\.|$)"):null;for(r=0;r<n.length;r++)s=n[r],(e||p===s.origType)&&(!b||b.guid===s.guid)&&(!g||g.test(s.namespace))&&(!d||d===s.selector||"**"===d&&s.selector)&&(n.splice(r--,1),s.selector&&n.delegateCount--,y.remove&&y.remove.call(a,s));0===n.length&&k!==n.length&&((!y.teardown||!1===y.teardown.call(a,g,D.handle))&&f.removeEvent(a,m,D.handle),delete l[m])}else for(m in l)f.event.remove(a,m+c[h],b,d,!0);f.isEmptyObject(l)&&(delete D.handle,f.removeData(a,"events",!0))}},customEvent:{getData:!0,setData:!0,
changeData:!0},trigger:function(b,d,e,h){if(!e||3!==e.nodeType&&8!==e.nodeType){var g,m,p,k,r,l,y,n=b.type||b;k=[];if(!Ya.test(n+f.event.triggered)&&(0<=n.indexOf("!")&&(n=n.slice(0,-1),g=!0),0<=n.indexOf(".")&&(k=n.split("."),n=k.shift(),k.sort()),e&&!f.event.customEvent[n]||f.event.global[n]))if(b="object"==typeof b?b[f.expando]?b:new f.Event(n,b):new f.Event(n),b.type=n,b.isTrigger=!0,b.exclusive=g,b.namespace=k.join("."),b.namespace_re=b.namespace?RegExp("(^|\\.)"+k.join("\\.(?:.*\\.|)")+"(\\.|$)"):
null,k=0>n.indexOf(":")?"on"+n:"",e){if(b.result=c,b.target||(b.target=e),d=null!=d?f.makeArray(d):[],d.unshift(b),r=f.event.special[n]||{},!(r.trigger&&!1===r.trigger.apply(e,d))){y=[[e,r.bindType||n]];if(!h&&!r.noBubble&&!f.isWindow(e)){m=r.delegateType||n;g=Ya.test(m+n)?e:e.parentNode;for(p=e;g;g=g.parentNode)y.push([g,m]),p=g;p===(e.ownerDocument||x)&&y.push([p.defaultView||p.parentWindow||a,m])}for(m=0;m<y.length&&!b.isPropagationStopped();m++)g=y[m][0],b.type=y[m][1],(l=(f._data(g,"events")||
{})[b.type]&&f._data(g,"handle"))&&l.apply(g,d),(l=k&&g[k])&&f.acceptData(g)&&l.apply&&!1===l.apply(g,d)&&b.preventDefault();return b.type=n,!h&&!b.isDefaultPrevented()&&(!r._default||!1===r._default.apply(e.ownerDocument,d))&&("click"!==n||!f.nodeName(e,"a"))&&f.acceptData(e)&&k&&e[n]&&("focus"!==n&&"blur"!==n||0!==b.target.offsetWidth)&&!f.isWindow(e)&&(p=e[k],p&&(e[k]=null),f.event.triggered=n,e[n](),f.event.triggered=c,p&&(e[k]=p)),b.result}}else for(m in e=f.cache,e)e[m].events&&e[m].events[n]&&
f.event.trigger(b,d,e[m].handle.elem,!0)}},dispatch:function(b){b=f.event.fix(b||a.event);var d,e,h,g,m,p,k=(f._data(this,"events")||{})[b.type]||[],r=k.delegateCount,l=T.call(arguments),n=!b.exclusive&&!b.namespace,y=f.event.special[b.type]||{},s=[];l[0]=b;b.delegateTarget=this;if(!(y.preDispatch&&!1===y.preDispatch.call(this,b))){if(r&&(!b.button||"click"!==b.type))for(e=b.target;e!=this;e=e.parentNode||this)if(!0!==e.disabled||"click"!==b.type){g={};m=[];for(d=0;d<r;d++)h=k[d],p=h.selector,g[p]===
c&&(g[p]=h.needsContext?0<=f(p,this).index(e):f.find(p,this,null,[e]).length),g[p]&&m.push(h);m.length&&s.push({elem:e,matches:m})}k.length>r&&s.push({elem:this,matches:k.slice(r)});for(d=0;d<s.length&&!b.isPropagationStopped();d++){g=s[d];b.currentTarget=g.elem;for(e=0;e<g.matches.length&&!b.isImmediatePropagationStopped();e++)if(h=g.matches[e],n||!b.namespace&&!h.namespace||b.namespace_re&&b.namespace_re.test(h.namespace))b.data=h.data,b.handleObj=h,h=((f.event.special[h.origType]||{}).handle||
h.handler).apply(g.elem,l),h!==c&&(b.result=h,!1===h&&(b.preventDefault(),b.stopPropagation()))}return y.postDispatch&&y.postDispatch.call(this,b),b.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(a,b){var d,e,f,h=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||x,e=d.documentElement,f=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),!a.which&&h!==c&&(a.which=h&1?1:h&2?3:h&4?2:0),a}},fix:function(a){if(a[f.expando])return a;var b,
c,d=a,e=f.event.fixHooks[a.type]||{},h=e.props?this.props.concat(e.props):this.props;a=f.Event(d);for(b=h.length;b;)c=h[--b],a[c]=d[c];return a.target||(a.target=d.srcElement||x),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,e.filter?e.filter(a,d):a},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=
null)}}},simulate:function(a,b,c,d){a=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(a,null,b):f.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};f.event.handle=f.event.dispatch;f.removeEvent=x.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){b="on"+b;a.detachEvent&&("undefined"==typeof a[b]&&(a[b]=null),a.detachEvent(b,c))};f.Event=function(a,b){if(this instanceof f.Event)a&&a.type?(this.originalEvent=
a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?l:g):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0;else return new f.Event(a,b)};f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=l;var a=this.originalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=l;var a=this.originalEvent;a&&(a.stopPropagation&&
a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l;this.stopPropagation()},isDefaultPrevented:g,isPropagationStopped:g,isImmediatePropagationStopped:g};f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=a.relatedTarget,e=a.handleObj;if(!d||d!==this&&!f.contains(this,d))a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b;return c}}});f.support.submitBubbles||
(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){a=a.target;(a=f.nodeName(a,"input")||f.nodeName(a,"button")?a.form:c)&&!f._data(a,"_submit_attached")&&(f.event.add(a,"submit._submit",function(a){a._submit_bubble=!0}),f._data(a,"_submit_attached",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(f.nodeName(this,
"form"))return!1;f.event.remove(this,"._submit")}});f.support.changeBubbles||(f.event.special.change={setup:function(){if(Da.test(this.nodeName)){if("checkbox"===this.type||"radio"===this.type)f.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1);f.event.simulate("change",this,a,!0)});return!1}f.event.add(this,"beforeactivate._change",
function(a){a=a.target;Da.test(a.nodeName)&&!f._data(a,"_change_attached")&&(f.event.add(a,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),f._data(a,"_change_attached",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type)return a.handleObj.handler.apply(this,arguments)},teardown:function(){return f.event.remove(this,"._change"),!Da.test(this.nodeName)}});
f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){0===c++&&x.addEventListener(a,d,!0)},teardown:function(){0===--c&&x.removeEventListener(a,d,!0)}}});f.fn.extend({on:function(a,b,d,e,h){var m,p;if("object"==typeof a){"string"!=typeof b&&(d=d||b,b=c);for(p in a)this.on(p,b,d,a[p],h);return this}null==d&&null==e?(e=b,d=b=c):null==e&&("string"==typeof b?(e=d,d=c):
(e=d,d=b,b=c));if(!1===e)e=g;else if(!e)return this;return 1===h&&(m=e,e=function(a){return f().off(a),m.apply(this,arguments)},e.guid=m.guid||(m.guid=f.guid++)),this.each(function(){f.event.add(this,a,e,d,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,d){var e,h;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,f(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof a){for(h in a)this.off(h,b,a[h]);return this}if(!1===
b||"function"==typeof b)d=b,b=c;return!1===d&&(d=g),this.each(function(){f.event.remove(this,a,d,b)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return f(this.context).on(a,this.selector,b,c),this},die:function(a,b){return f(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,
b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;return f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(a,b){f.fn[b]=function(a,c){return null==c&&(c=a,a=null),0<arguments.length?this.on(b,null,a,c):this.trigger(b)};Pb.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks);Qb.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)});(function(a,b){function c(a,b,d,e){d=d||[];b=b||W;var f,q,h,g,m=b.nodeType;if(!a||"string"!=typeof a)return d;if(1!==m&&9!==m)return[];h=x(b);if(!h&&!e&&(f=da.exec(a)))if(g=f[1])if(9===m){q=b.getElementById(g);if(!q||!q.parentNode)return d;if(q.id===g)return d.push(q),d}else{if(b.ownerDocument&&
(q=b.ownerDocument.getElementById(g))&&E(b,q)&&q.id===g)return d.push(q),d}else{if(f[2])return na.apply(d,oa.call(b.getElementsByTagName(a),0)),d;if((g=f[3])&&ha&&b.getElementsByClassName)return na.apply(d,oa.call(b.getElementsByClassName(g),0)),d}return s(a.replace(R,"$1"),b,d,e,h)}function d(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function e(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function h(a){return X(function(b){return b=
+b,X(function(c,d){for(var e,f=a([],c.length,b),q=f.length;q--;)c[e=f[q]]&&(c[e]=!(d[e]=c[e]))})})}function g(a,b,c){if(a===b)return c;for(a=a.nextSibling;a;){if(a===b)return-1;a=a.nextSibling}return 1}function m(a,b){var d,e,f,q,h,g,p;if(h=T[K][a])return b?0:h.slice(0);h=a;g=[];for(p=u.preFilter;h;){if(!d||(e=aa.exec(h)))e&&(h=h.slice(e[0].length)),g.push(f=[]);d=!1;if(e=ba.exec(h))f.push(d=new Q(e.shift())),h=h.slice(d.length),d.type=e[0].replace(R," ");for(q in u.filter)(e=Y[q].exec(h))&&(!p[q]||
(e=p[q](e,W,!0)))&&(f.push(d=new Q(e.shift())),h=h.slice(d.length),d.type=q,d.matches=e);if(!d)break}return b?h.length:h?c.error(a):T(a,g).slice(0)}function p(a,b,c){var d=b.dir,e=c&&"parentNode"===b.dir,f=S++;return b.first?function(b,c,f){for(;b=b[d];)if(e||1===b.nodeType)return a(b,c,f)}:function(b,c,q){if(q)for(;b=b[d];){if((e||1===b.nodeType)&&a(b,c,q))return b}else for(var h,g=J+" "+f+" ",m=g+V;b=b[d];)if(e||1===b.nodeType){if((h=b[K])===m)return b.sizset;if("string"==typeof h&&0===h.indexOf(g)){if(b.sizset)return b}else{b[K]=
m;if(a(b,c,q))return b.sizset=!0,b;b.sizset=!1}}}}function k(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function r(a,b,c,d,e){for(var f,q=[],h=0,g=a.length,m=null!=b;h<g;h++)if(f=a[h])if(!c||c(f,d,e))q.push(f),m&&b.push(h);return q}function l(a,b,d,e,f,q){return e&&!e[K]&&(e=l(e)),f&&!f[K]&&(f=l(f,q)),X(function(q,h,g,m){if(!q||!f){var p,z,k=[],l=[],v=h.length;if(!(z=q)){z=b||"*";var w=g.nodeType?[g]:g,G=[];p=0;for(var n=w.length;p<n;p++)c(z,
w[p],G,q);z=G}w=a&&(q||!b)?r(z,k,a,g,m):z;G=d?f||(q?a:v||e)?[]:h:w;d&&d(w,G,g,m);if(e){z=r(G,l);e(z,[],g,m);for(g=z.length;g--;)if(p=z[g])G[l[g]]=!(w[l[g]]=p)}if(q)for(g=a&&G.length;g--;){if(p=G[g])q[k[g]]=!(h[k[g]]=p)}else G=r(G===h?G.splice(v,G.length):G),f?f(null,h,G,m):na.apply(h,G)}})}function n(a){var b,c,d,e=a.length,f=u.relative[a[0].type];c=f||u.relative[" "];for(var q=f?1:0,h=p(function(a){return a===b},c,!0),g=p(function(a){return-1<L.call(b,a)},c,!0),m=[function(a,c,d){return!f&&(d||c!==
H)||((b=c).nodeType?h(a,c,d):g(a,c,d))}];q<e;q++)if(c=u.relative[a[q].type])m=[p(k(m),c)];else{c=u.filter[a[q].type].apply(null,a[q].matches);if(c[K]){for(d=++q;d<e&&!u.relative[a[d].type];d++);return l(1<q&&k(m),1<q&&a.slice(0,q-1).join("").replace(R,"$1"),c,q<d&&n(a.slice(q,d)),d<e&&n(a=a.slice(d)),d<e&&a.join(""))}m.push(c)}return k(m)}function y(a,b){var d=0<b.length,e=0<a.length,f=function(q,h,g,m,p){var z,k,l=[],v=0,G="0",w=q&&[],n=null!=p,y=H,P=q||e&&u.find.TAG("*",p&&h.parentNode||h),s=J+=
null==y?1:Math.E;for(n&&(H=h!==W&&h,V=f.el);null!=(p=P[G]);G++){if(e&&p){for(z=0;k=a[z];z++)if(k(p,h,g)){m.push(p);break}n&&(J=s,V=++f.el)}d&&((p=!k&&p)&&v--,q&&w.push(p))}v+=G;if(d&&G!==v){for(z=0;k=b[z];z++)k(w,l,h,g);if(q){if(0<v)for(;G--;)!w[G]&&!l[G]&&(l[G]=M.call(m));l=r(l)}na.apply(m,l);n&&!q&&0<l.length&&1<v+b.length&&c.uniqueSort(m)}return n&&(J=s,H=y),w};return f.el=0,d?X(f):f}function s(a,b,c,d,e){var f,q,h,g,p=m(a);if(!d&&1===p.length){q=p[0]=p[0].slice(0);if(2<q.length&&"ID"===(h=q[0]).type&&
9===b.nodeType&&!e&&u.relative[q[1].type]){b=u.find.ID(h.matches[0].replace(ja,""),b,e)[0];if(!b)return c;a=a.slice(q.shift().length)}for(f=Y.POS.test(a)?-1:q.length-1;0<=f;f--){h=q[f];if(u.relative[g=h.type])break;if(g=u.find[g])if(d=g(h.matches[0].replace(ja,""),Z.test(q[0].type)&&b.parentNode||b,e)){q.splice(f,1);a=d.length&&q.join("");if(!a)return na.apply(c,oa.call(d,0)),c;break}}}return B(a,p)(d,b,e,c,Z.test(a)),c}function D(){}var V,t,u,C,x,E,B,N,O,H,A=!0,K=("sizcache"+Math.random()).replace(".",
""),Q=String,W=a.document,U=W.documentElement,J=0,S=0,M=[].pop,na=[].push,oa=[].slice,L=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1},X=function(a,b){return a[K]=null==b||b,a},I=function(){var a={},b=[];return X(function(c,d){return b.push(c)>u.cacheLength&&delete a[b.shift()],a[c]=d},a)},$a=I(),T=I(),ab=I(),I="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?\x3d)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+
"(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("w","w#")+")|)|)[\\x20\\t\\r\\n\\f]*\\]",qa=":((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+I+")|[^:]|\\\\.)*|.*))\\)|)",R=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),aa=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,ba=/^[\x20\t\r\n\f]*([\x20\t\r\n\f>+~])[\x20\t\r\n\f]*/,la=RegExp(qa),da=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,Z=/[\x20\t\r\n\f]*[+~]/,ea=/h\d/i,ka=/input|select|textarea|button/i,
ja=/\\(?!\\)/g,Y={ID:/^#((?:\\.|[-\w]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[-\w]|[^\x00-\xa0])+)/,NAME:/^\[name=['"]?((?:\\.|[-\w]|[^\x00-\xa0])+)['"]?\]/,TAG:RegExp("^("+"(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+I),PSEUDO:RegExp("^"+qa),POS:/:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i,CHILD:RegExp("^:(only|nth|first|last)-child(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)",
"i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[\x3e+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?\x3d[^-]|$)","i")},fa=function(a){var b=W.createElement("div");try{return a(b)}catch(c){return!1}finally{}},I=fa(function(a){return a.appendChild(W.createComment("")),!a.getElementsByTagName("*").length}),ga=fa(function(a){return a.innerHTML="\x3ca href\x3d'#'\x3e\x3c/a\x3e",a.firstChild&&"undefined"!==typeof a.firstChild.getAttribute&&"#"===
a.firstChild.getAttribute("href")}),ia=fa(function(a){a.innerHTML="\x3cselect\x3e\x3c/select\x3e";a=typeof a.lastChild.getAttribute("multiple");return"boolean"!==a&&"string"!==a}),ha=fa(function(a){return a.innerHTML="\x3cdiv class\x3d'hidden e'\x3e\x3c/div\x3e\x3cdiv class\x3d'hidden'\x3e\x3c/div\x3e",!a.getElementsByClassName||!a.getElementsByClassName("e").length?!1:(a.lastChild.className="e",2===a.getElementsByClassName("e").length)}),ma=fa(function(a){a.id=K+0;a.innerHTML="\x3ca name\x3d'"+K+
"'\x3e\x3c/a\x3e\x3cdiv name\x3d'"+K+"'\x3e\x3c/div\x3e";U.insertBefore(a,U.firstChild);var b=W.getElementsByName&&W.getElementsByName(K).length===2+W.getElementsByName(K+0).length;return t=!W.getElementById(K),U.removeChild(a),b});try{oa.call(U.childNodes,0)[0].nodeType}catch(pa){oa=function(a){for(var b,c=[];b=this[a];a++)c.push(b);return c}}c.matches=function(a,b){return c(a,null,null,b)};c.matchesSelector=function(a,b){return 0<c(b,null,null,[a]).length};C=c.getText=function(a){var b,c="",d=0;
if(b=a.nodeType)if(1===b||9===b||11===b){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=C(a)}else{if(3===b||4===b)return a.nodeValue}else for(;b=a[d];d++)c+=C(b);return c};x=c.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};E=c.contains=U.contains?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||!(1===d.nodeType&&c.contains&&c.contains(d)))}:U.compareDocumentPosition?
function(a,b){return b&&!!(a.compareDocumentPosition(b)&16)}:function(a,b){for(;b=b.parentNode;)if(b===a)return!0;return!1};c.attr=function(a,b){var c,d=x(a);return d||(b=b.toLowerCase()),(c=u.attrHandle[b])?c(a):d||ia?a.getAttribute(b):(c=a.getAttributeNode(b),c?"boolean"==typeof a[b]?a[b]?b:null:c.specified?c.value:null:null)};u=c.selectors={cacheLength:50,createPseudo:X,match:Y,attrHandle:ga?{}:{href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}},
find:{ID:t?function(a,b,c){if("undefined"!==typeof b.getElementById&&!c)return(a=b.getElementById(a))&&a.parentNode?[a]:[]}:function(a,c,d){if("undefined"!==typeof c.getElementById&&!d)return(c=c.getElementById(a))?c.id===a||"undefined"!==typeof c.getAttributeNode&&c.getAttributeNode("id").value===a?[c]:b:[]},TAG:I?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a)}:function(a,b){var c=b.getElementsByTagName(a);if("*"===a){for(var d,e=[],f=0;d=c[f];f++)1===
d.nodeType&&e.push(d);return e}return c},NAME:ma&&function(a,b){if("undefined"!==typeof b.getElementsByName)return b.getElementsByName(name)},CLASS:ha&&function(a,b,c){if("undefined"!==typeof b.getElementsByClassName&&!c)return b.getElementsByClassName(a)}},relative:{"\x3e":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ja,""),a[3]=(a[4]||a[5]||"").replace(ja,""),"~\x3d"===a[2]&&
(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1]?(a[2]||c.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*("even"===a[2]||"odd"===a[2])),a[4]=+(a[6]+a[7]||"odd"===a[2])):a[2]&&c.error(a[0]),a},PSEUDO:function(a){var b,c;if(Y.CHILD.test(a[0]))return null;if(a[3])a[2]=a[3];else if(b=a[4])la.test(b)&&(c=m(b,!0))&&(c=b.indexOf(")",b.length-c)-b.length)&&(b=b.slice(0,c),a[0]=a[0].slice(0,c)),a[2]=b;return a.slice(0,3)}},filter:{ID:t?function(a){return a=a.replace(ja,
""),function(b){return b.getAttribute("id")===a}}:function(a){return a=a.replace(ja,""),function(b){return(b="undefined"!==typeof b.getAttributeNode&&b.getAttributeNode("id"))&&b.value===a}},TAG:function(a){return"*"===a?function(){return!0}:(a=a.replace(ja,"").toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=$a[K][a];return b||(b=$a(a,RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))),function(a){return b.test(a.className||"undefined"!==
typeof a.getAttribute&&a.getAttribute("class")||"")}},ATTR:function(a,b,d){return function(e,f){var q=c.attr(e,a);return null==q?"!\x3d"===b:b?(q+="","\x3d"===b?q===d:"!\x3d"===b?q!==d:"^\x3d"===b?d&&0===q.indexOf(d):"*\x3d"===b?d&&-1<q.indexOf(d):"$\x3d"===b?d&&q.substr(q.length-d.length)===d:"~\x3d"===b?-1<(" "+q+" ").indexOf(d):"|\x3d"===b?q===d||q.substr(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d){return"nth"===a?function(a){var b,e;b=a.parentNode;if(1===c&&0===d)return!0;if(b){e=0;
for(b=b.firstChild;b&&!(1===b.nodeType&&(e++,a===b));b=b.nextSibling);}return e-=d,e===c||0===e%c&&0<=e/c}:function(b){var c=b;switch(a){case "only":case "first":for(;c=c.previousSibling;)if(1===c.nodeType)return!1;if("first"===a)return!0;c=b;case "last":for(;c=c.nextSibling;)if(1===c.nodeType)return!1;return!0}}},PSEUDO:function(a,b){var d,e=u.pseudos[a]||u.setFilters[a.toLowerCase()]||c.error("unsupported pseudo: "+a);return e[K]?e(b):1<e.length?(d=[a,a,"",b],u.setFilters.hasOwnProperty(a.toLowerCase())?
X(function(a,c){for(var d,f=e(a,b),q=f.length;q--;)d=L.call(a,f[q]),a[d]=!(c[d]=f[q])}):function(a){return e(a,0,d)}):e}},pseudos:{not:X(function(a){var b=[],c=[],d=B(a.replace(R,"$1"));return d[K]?X(function(a,b,c,e){e=d(a,null,e,[]);for(var f=a.length;f--;)if(c=e[f])a[f]=!(b[f]=c)}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:X(function(a){return function(b){return 0<c(a,b).length}}),contains:X(function(a){return function(b){return-1<(b.textContent||b.innerText||C(b)).indexOf(a)}}),
enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},parent:function(a){return!u.pseudos.empty(a)},empty:function(a){var b;for(a=a.firstChild;a;){if("@"<a.nodeName||3===(b=a.nodeType)||4===b)return!1;a=a.nextSibling}return!0},header:function(a){return ea.test(a.nodeName)},
text:function(a){var b,c;return"input"===a.nodeName.toLowerCase()&&"text"===(b=a.type)&&(null==(c=a.getAttribute("type"))||c.toLowerCase()===b)},radio:d("radio"),checkbox:d("checkbox"),file:d("file"),password:d("password"),image:d("image"),submit:e("submit"),reset:e("reset"),button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return ka.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||
b.hasFocus())&&(!!a.type||!!a.href)},active:function(a){return a===a.ownerDocument.activeElement},first:h(function(a,b,c){return[0]}),last:h(function(a,b,c){return[b-1]}),eq:h(function(a,b,c){return[0>c?c+b:c]}),even:h(function(a,b,c){for(c=0;c<b;c+=2)a.push(c);return a}),odd:h(function(a,b,c){for(c=1;c<b;c+=2)a.push(c);return a}),lt:h(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:h(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}};N=U.compareDocumentPosition?function(a,
b){return a===b?(O=!0,0):(!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition:a.compareDocumentPosition(b)&4)?-1:1}:function(a,b){if(a===b)return O=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[];c=a.parentNode;d=b.parentNode;var q=c;if(c===d)return g(a,b);if(!c)return-1;if(!d)return 1;for(;q;)e.unshift(q),q=q.parentNode;for(q=d;q;)f.unshift(q),q=q.parentNode;c=e.length;d=f.length;for(q=0;q<c&&q<d;q++)if(e[q]!==f[q])return g(e[q],
f[q]);return q===c?g(a,f[q],-1):g(e[q],b,1)};[0,0].sort(N);A=!O;c.uniqueSort=function(a){var b,c=1;O=A;a.sort(N);if(O)for(;b=a[c];c++)b===a[c-1]&&a.splice(c--,1);return a};c.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};B=c.compile=function(a,b){var c,d=[],e=[],f=ab[K][a];if(!f){b||(b=m(a));for(c=b.length;c--;)f=n(b[c]),f[K]?d.push(f):e.push(f);f=ab(a,y(e,d))}return f};W.querySelectorAll&&function(){var a,b=s,d=/'|\\/g,e=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,
f=[":focus"],q=[":active",":focus"],h=U.matchesSelector||U.mozMatchesSelector||U.webkitMatchesSelector||U.oMatchesSelector||U.msMatchesSelector;fa(function(a){a.innerHTML="\x3cselect\x3e\x3coption selected\x3d''\x3e\x3c/option\x3e\x3c/select\x3e";a.querySelectorAll("[selected]").length||f.push("\\[[\\x20\\t\\r\\n\\f]*(?:checked|disabled|ismap|multiple|readonly|selected|value)");a.querySelectorAll(":checked").length||f.push(":checked")});fa(function(a){a.innerHTML="\x3cp test\x3d''\x3e\x3c/p\x3e";
a.querySelectorAll("[test^\x3d'']").length&&f.push("[*^$]\x3d[\\x20\\t\\r\\n\\f]*(?:\"\"|'')");a.innerHTML="\x3cinput type\x3d'hidden'/\x3e";a.querySelectorAll(":enabled").length||f.push(":enabled",":disabled")});f=RegExp(f.join("|"));s=function(a,c,e,q,h){if(!q&&!h&&(!f||!f.test(a))){var g,p,z=!0,k=K;p=c;g=9===c.nodeType&&a;if(1===c.nodeType&&"object"!==c.nodeName.toLowerCase()){g=m(a);(z=c.getAttribute("id"))?k=z.replace(d,"\\$\x26"):c.setAttribute("id",k);k="[id\x3d'"+k+"'] ";for(p=g.length;p--;)g[p]=
k+g[p].join("");p=Z.test(a)&&c.parentNode||c;g=g.join(",")}if(g)try{return na.apply(e,oa.call(p.querySelectorAll(g),0)),e}catch(r){}finally{z||c.removeAttribute("id")}}return b(a,c,e,q,h)};h&&(fa(function(b){a=h.call(b,"div");try{h.call(b,"[test!\x3d'']:sizzle"),q.push("!\x3d",qa)}catch(c){}}),q=RegExp(q.join("|")),c.matchesSelector=function(b,d){d=d.replace(e,"\x3d'$1']");if(!x(b)&&!q.test(d)&&(!f||!f.test(d)))try{var g=h.call(b,d);if(g||a||b.document&&11!==b.document.nodeType)return g}catch(m){}return 0<
c(d,null,null,[b]).length})}();u.pseudos.nth=u.pseudos.eq;u.filters=D.prototype=u.pseudos;u.setFilters=new D;c.attr=f.attr;f.find=c;f.expr=c.selectors;f.expr[":"]=f.expr.pseudos;f.unique=c.uniqueSort;f.text=c.getText;f.isXMLDoc=c.isXML;f.contains=c.contains})(a);var Rb=/Until$/,Sb=/^(?:parents|prev(?:Until|All))/,sb=/^.[^:#\[\.,]*$/,bb=f.expr.match.needsContext,Tb={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b,c,d,e,h,g,m=this;if("string"!=typeof a)return f(a).filter(function(){b=
0;for(c=m.length;b<c;b++)if(f.contains(m[b],this))return!0});g=this.pushStack("","find",a);b=0;for(c=this.length;b<c;b++)if(d=g.length,f.find(a,this[b],g),0<b)for(e=d;e<g.length;e++)for(h=0;h<d;h++)if(g[h]===g[e]){g.splice(e--,1);break}return g},has:function(a){var b,c=f(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(f.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(s(this,a,!1),"not",a)},filter:function(a){return this.pushStack(s(this,a,!0),"filter",a)},
is:function(a){return!!a&&("string"==typeof a?bb.test(a)?0<=f(a,this.context).index(this[0]):0<f.filter(a,this).length:0<this.filter(a).length)},closest:function(a,b){for(var c,d=0,e=this.length,h=[],g=bb.test(a)||"string"!=typeof a?f(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c.ownerDocument&&c!==b&&11!==c.nodeType;){if(g?-1<g.index(c):f.find.matchesSelector(c,a)){h.push(c);break}c=c.parentNode}return h=1<h.length?f.unique(h):h,this.pushStack(h,"closest",a)},index:function(a){return a?"string"==
typeof a?f.inArray(this[0],f(a)):f.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c="string"==typeof a?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(k(c[0])||k(d[0])?d:f.unique(d))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});f.fn.andSelf=f.fn.addBack;f.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return f.dir(a,
"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return n(a,"nextSibling")},prev:function(a){return n(a,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return f.sibling(a.firstChild)},
contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.merge([],a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);return Rb.test(a)||(d=c),d&&"string"==typeof d&&(e=f.filter(d,e)),e=1<this.length&&!Tb[a]?f.unique(e):e,1<this.length&&Sb.test(a)&&(e=e.reverse()),this.pushStack(e,a,T.call(arguments).join(","))}});f.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),1===b.length?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,
b)},dir:function(a,b,d){var e=[];for(a=a[b];a&&9!==a.nodeType&&(d===c||1!==a.nodeType||!f(a).is(d));)1===a.nodeType&&e.push(a),a=a[b];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Ka="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ub=/ jQuery\d+="(?:null|\d+)"/g,Ea=/^\s+/,cb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
db=/<([\w:]+)/,Vb=/<tbody/i,Wb=/<|&#?\w+;/,Xb=/<(?:script|style|link)/i,Yb=/<(?:script|object|embed|option|style)/i,Fa=RegExp("\x3c(?:"+Ka+")[\\s/\x3e]","i"),La=/^(?:checkbox|radio)$/,eb=/checked\s*(?:[^=]|=\s*.checked.)/i,Zb=/\/(java|ecma)script/i,$b=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,I={option:[1,"\x3cselect multiple\x3d'multiple'\x3e","\x3c/select\x3e"],legend:[1,"\x3cfieldset\x3e","\x3c/fieldset\x3e"],thead:[1,"\x3ctable\x3e","\x3c/table\x3e"],tr:[2,"\x3ctable\x3e\x3ctbody\x3e","\x3c/tbody\x3e\x3c/table\x3e"],
td:[3,"\x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e","\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e"],col:[2,"\x3ctable\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3ccolgroup\x3e","\x3c/colgroup\x3e\x3c/table\x3e"],area:[1,"\x3cmap\x3e","\x3c/map\x3e"],_default:[0,"",""]},fb=u(x),Ga=fb.appendChild(x.createElement("div"));I.optgroup=I.option;I.tbody=I.tfoot=I.colgroup=I.caption=I.thead;I.th=I.td;f.support.htmlSerialize||(I._default=[1,"X\x3cdiv\x3e","\x3c/div\x3e"]);f.fn.extend({text:function(a){return f.access(this,function(a){return a===
c?f.text(this):this.empty().append((this[0]&&this[0].ownerDocument||x).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return f.isFunction(a)?this.each(function(b){f(this).wrapInner(a.call(this,
b))}):this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(1===this.nodeType||11===this.nodeType)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,
!0,function(a){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(a,this.firstChild)})},before:function(){if(!k(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f.clean(arguments);return this.pushStack(f.merge(a,this),"before",this.selector)}},after:function(){if(!k(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=f.clean(arguments);return this.pushStack(f.merge(this,
a),"after",this.selector)}},remove:function(a,b){for(var c,d=0;null!=(c=this[d]);d++)if(!a||f.filter(a,[c]).length)!b&&1===c.nodeType&&(f.cleanData(c.getElementsByTagName("*")),f.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c);return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)for(1===a.nodeType&&f.cleanData(a.getElementsByTagName("*"));a.firstChild;)a.removeChild(a.firstChild);return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return f.clone(this,
a,b)})},html:function(a){return f.access(this,function(a){var b=this[0]||{},d=0,e=this.length;if(a===c)return 1===b.nodeType?b.innerHTML.replace(Ub,""):c;if("string"==typeof a&&!Xb.test(a)&&(f.support.htmlSerialize||!Fa.test(a))&&(f.support.leadingWhitespace||!Ea.test(a))&&!I[(db.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(cb,"\x3c$1\x3e\x3c/$2\x3e");try{for(;d<e;d++)b=this[d]||{},1===b.nodeType&&(f.cleanData(b.getElementsByTagName("*")),b.innerHTML=a);b=0}catch(h){}}b&&this.empty().append(a)},
null,a,arguments.length)},replaceWith:function(a){return k(this[0])?this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this:f.isFunction(a)?this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))}):("string"!=typeof a&&(a=f(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove();b?f(b).before(a):f(c).append(a)}))},detach:function(a){return this.remove(a,!0)},domManip:function(a,b,d){a=[].concat.apply([],a);var e,h,g,m=0,
p=a[0],k=[],r=this.length;if(!f.support.checkClone&&1<r&&"string"==typeof p&&eb.test(p))return this.each(function(){f(this).domManip(a,b,d)});if(f.isFunction(p))return this.each(function(e){var h=f(this);a[0]=p.call(this,e,b?h.html():c);h.domManip(a,b,d)});if(this[0]){e=f.buildFragment(a,this,k);g=e.fragment;h=g.firstChild;1===g.childNodes.length&&(g=h);if(h){b=b&&f.nodeName(h,"tr");for(e=e.cacheable||r-1;m<r;m++)d.call(b&&f.nodeName(this[m],"table")?this[m].getElementsByTagName("tbody")[0]||this[m].appendChild(this[m].ownerDocument.createElement("tbody")):
this[m],m===e?g:f.clone(g,!0,!0))}g=h=null;k.length&&f.each(k,function(a,b){b.src?f.ajax?f.ajax({url:b.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):f.error("no ajax"):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace($b,""));b.parentNode&&b.parentNode.removeChild(b)})}return this}});f.buildFragment=function(a,b,d){var e,h,g,m=a[0];return b=b||x,b=!b.nodeType&&b[0]||b,b=b.ownerDocument||b,1===a.length&&"string"==typeof m&&512>m.length&&b===x&&"\x3c"===m.charAt(0)&&
!Yb.test(m)&&(f.support.checkClone||!eb.test(m))&&(f.support.html5Clone||!Fa.test(m))&&(h=!0,e=f.fragments[m],g=e!==c),e||(e=b.createDocumentFragment(),f.clean(a,b,e,d),h&&(f.fragments[m]=g&&e)),{fragment:e,cacheable:h}};f.fragments={};f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d,e=0,h=[];c=f(c);var g=c.length;d=1===this.length&&this[0].parentNode;if((null==d||d&&11===d.nodeType&&1===d.childNodes.length)&&
1===g)return c[b](this[0]),this;for(;e<g;e++)d=(0<e?this.clone(!0):this).get(),f(c[e])[b](d),h=h.concat(d);return this.pushStack(h,a,c.selector)}});f.extend({clone:function(a,b,c){var d,e,g,m;f.support.html5Clone||f.isXMLDoc(a)||!Fa.test("\x3c"+a.nodeName+"\x3e")?m=a.cloneNode(!0):(Ga.innerHTML=a.outerHTML,Ga.removeChild(m=Ga.firstChild));if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(1===a.nodeType||11===a.nodeType)&&!f.isXMLDoc(a)){r(a,m);d=h(a);e=h(m);for(g=0;d[g];++g)e[g]&&r(d[g],e[g])}if(b&&
(t(a,m),c)){d=h(a);e=h(m);for(g=0;d[g];++g)t(d[g],e[g])}return m},clean:function(a,b,c,d){var e,h,g,p,k,r,l,n=b===x&&fb,y=[];if(!b||"undefined"==typeof b.createDocumentFragment)b=x;for(e=0;null!=(g=a[e]);e++)if("number"==typeof g&&(g+=""),g){if("string"==typeof g)if(Wb.test(g)){n=n||u(b);r=b.createElement("div");n.appendChild(r);g=g.replace(cb,"\x3c$1\x3e\x3c/$2\x3e");h=(db.exec(g)||["",""])[1].toLowerCase();p=I[h]||I._default;k=p[0];for(r.innerHTML=p[1]+g+p[2];k--;)r=r.lastChild;if(!f.support.tbody){k=
Vb.test(g);p="table"===h&&!k?r.firstChild&&r.firstChild.childNodes:"\x3ctable\x3e"===p[1]&&!k?r.childNodes:[];for(h=p.length-1;0<=h;--h)f.nodeName(p[h],"tbody")&&!p[h].childNodes.length&&p[h].parentNode.removeChild(p[h])}!f.support.leadingWhitespace&&Ea.test(g)&&r.insertBefore(b.createTextNode(Ea.exec(g)[0]),r.firstChild);g=r.childNodes;r.parentNode.removeChild(r)}else g=b.createTextNode(g);g.nodeType?y.push(g):f.merge(y,g)}r&&(g=r=n=null);if(!f.support.appendChecked)for(e=0;null!=(g=y[e]);e++)f.nodeName(g,
"input")?m(g):"undefined"!=typeof g.getElementsByTagName&&f.grep(g.getElementsByTagName("input"),m);if(c){a=function(a){if(!a.type||Zb.test(a.type))return d?d.push(a.parentNode?a.parentNode.removeChild(a):a):c.appendChild(a)};for(e=0;null!=(g=y[e]);e++)if(!f.nodeName(g,"script")||!a(g))c.appendChild(g),"undefined"!=typeof g.getElementsByTagName&&(l=f.grep(f.merge([],g.getElementsByTagName("script")),a),y.splice.apply(y,[e+1,0].concat(l)),e+=l.length)}return y},cleanData:function(a,b){for(var c,d,
e,h,g=0,m=f.expando,p=f.cache,k=f.support.deleteExpando,r=f.event.special;null!=(e=a[g]);g++)if(b||f.acceptData(e))if(c=(d=e[m])&&p[d]){if(c.events)for(h in c.events)r[h]?f.event.remove(e,h):f.removeEvent(e,h,c.handle);p[d]&&(delete p[d],k?delete e[m]:e.removeAttribute?e.removeAttribute(m):e[m]=null,f.deletedIds.push(d))}}});(function(){var a,b;f.uaMatch=function(a){a=a.toLowerCase();a=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||
/(msie) ([\w.]+)/.exec(a)||0>a.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}};a=f.uaMatch(qa.userAgent);b={};a.browser&&(b[a.browser]=!0,b.version=a.version);b.chrome?b.webkit=!0:b.webkit&&(b.safari=!0);f.browser=b;f.sub=function(){function a(b,c){return new a.fn.init(b,c)}f.extend(!0,a,this);a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(c,d){return d&&d instanceof f&&!(d instanceof a)&&
(d=a(d)),f.fn.init.call(this,c,d,b)};a.fn.init.prototype=a.fn;var b=a(x);return a}})();var L,Z,ea,Ha=/alpha\([^)]*\)/i,ac=/opacity=([^)]*)/,bc=/^(top|right|bottom|left)$/,cc=/^(none|table(?!-c[ea]).+)/,gb=/^margin/,tb=RegExp("^("+ua+")(.*)$","i"),ha=RegExp("^("+ua+")(?!px)[a-z%]+$","i"),dc=RegExp("^([-+])\x3d("+ua+")","i"),ya={},ec={position:"absolute",visibility:"hidden",display:"block"},hb={letterSpacing:0,fontWeight:400},ba=["Top","Right","Bottom","Left"],Ma=["Webkit","O","Moz","ms"],fc=f.fn.toggle;
f.fn.extend({css:function(a,b){return f.access(this,function(a,b,d){return d!==c?f.style(a,b,d):f.css(a,b)},a,b,1<arguments.length)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(a,b){var c="boolean"==typeof a;return f.isFunction(a)&&f.isFunction(b)?fc.apply(this,arguments):this.each(function(){(c?a:y(this))?f(this).show():f(this).hide()})}});f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=L(a,"opacity");return""===c?"1":c}}}},cssNumber:{fillOpacity:!0,
fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,d,e){if(a&&!(3===a.nodeType||8===a.nodeType||!a.style)){var h,g,m,k=f.camelCase(b),r=a.style;b=f.cssProps[k]||(f.cssProps[k]=p(r,k));m=f.cssHooks[b]||f.cssHooks[k];if(d===c)return m&&"get"in m&&(h=m.get(a,!1,e))!==c?h:r[b];g=typeof d;"string"===g&&(h=dc.exec(d))&&(d=(h[1]+1)*h[2]+parseFloat(f.css(a,b)),g="number");if(!(null==d||"number"===
g&&isNaN(d)))if("number"===g&&!f.cssNumber[k]&&(d+="px"),!m||!("set"in m)||(d=m.set(a,d,e))!==c)try{r[b]=d}catch(l){}}},css:function(a,b,d,e){var h,g,m,k=f.camelCase(b);return b=f.cssProps[k]||(f.cssProps[k]=p(a.style,k)),m=f.cssHooks[b]||f.cssHooks[k],m&&"get"in m&&(h=m.get(a,!0,e)),h===c&&(h=L(a,b)),"normal"===h&&b in hb&&(h=hb[b]),d||e!==c?(g=parseFloat(h),d||f.isNumeric(g)?g||0:h):h},swap:function(a,b,c){var d,e={};for(d in b)e[d]=a.style[d],a.style[d]=b[d];c=c.call(a);for(d in b)a.style[d]=e[d];
return c}});a.getComputedStyle?L=function(b,c){var d,e,h,g,m=a.getComputedStyle(b,null),p=b.style;return m&&(d=m[c],""===d&&!f.contains(b.ownerDocument,b)&&(d=f.style(b,c)),ha.test(d)&&gb.test(c)&&(e=p.width,h=p.minWidth,g=p.maxWidth,p.minWidth=p.maxWidth=p.width=d,d=m.width,p.width=e,p.minWidth=h,p.maxWidth=g)),d}:x.documentElement.currentStyle&&(L=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;return null==e&&f&&f[b]&&(e=f[b]),ha.test(e)&&!bc.test(b)&&(c=f.left,d=a.runtimeStyle&&
a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),f.left="fontSize"===b?"1em":e,e=f.pixelLeft+"px",f.left=c,d&&(a.runtimeStyle.left=d)),""===e?"auto":e});f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){if(c)return 0===a.offsetWidth&&cc.test(L(a,"display"))?f.swap(a,ec,function(){return H(a,b,d)}):H(a,b,d)},set:function(a,c,d){return D(a,c,d?E(a,b,d,f.support.boxSizing&&"border-box"===f.css(a,"boxSizing")):0)}}});f.support.opacity||(f.cssHooks.opacity={get:function(a,
b){return ac.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity\x3d"+100*b+")":"",h=d&&d.filter||c.filter||"";c.zoom=1;if(1<=b&&(""===f.trim(h.replace(Ha,""))&&c.removeAttribute)&&(c.removeAttribute("filter"),d&&!d.filter))return;c.filter=Ha.test(h)?h.replace(Ha,e):h+" "+e}});f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){return f.swap(a,
{display:"inline-block"},function(){if(b)return L(a,"marginRight")})}});!f.support.pixelPosition&&f.fn.position&&f.each(["top","left"],function(a,b){f.cssHooks[b]={get:function(a,c){if(c){var d=L(a,b);return ha.test(d)?f(a).position()[b]+"px":d}}}})});f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){return 0===a.offsetWidth&&0===a.offsetHeight||!f.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||L(a,"display"))},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});
f.each({margin:"",padding:"",border:"Width"},function(a,b){f.cssHooks[a+b]={expand:function(c){var d="string"==typeof c?c.split(" "):[c],e={};for(c=0;4>c;c++)e[a+ba[c]+b]=d[c]||d[c-2]||d[0];return e}};gb.test(a)||(f.cssHooks[a+b].set=D)});var gc=/%20/g,ub=/\[\]$/,ib=/\r?\n/g,hc=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,ic=/^(?:select|textarea)/i;f.fn.extend({serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?
f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ic.test(this.nodeName)||hc.test(this.type))}).map(function(a,b){var c=f(this).val();return null==c?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(ib,"\r\n")}}):{name:b.name,value:c.replace(ib,"\r\n")}}).get()}});f.param=function(a,b){var d,e=[],h=function(a,b){b=f.isFunction(b)?b():null==b?"":b;e[e.length]=encodeURIComponent(a)+"\x3d"+encodeURIComponent(b)};b===c&&(b=f.ajaxSettings&&
f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){h(this.name,this.value)});else for(d in a)S(d,a[d],b,h);return e.join("\x26").replace(gc,"+")};var Y,da,jc=/#.*$/,kc=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,lc=/^(?:GET|HEAD)$/,mc=/^\/\//,jb=/\?/,nc=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,oc=/([?&])_=[^&]*/,kb=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,lb=f.fn.load,za={},mb={},nb=["*/"]+["*"];try{da=vb.href}catch(vc){da=x.createElement("a"),
da.href="",da=da.href}Y=kb.exec(da.toLowerCase())||[];f.fn.load=function(a,b,d){if("string"!=typeof a&&lb)return lb.apply(this,arguments);if(!this.length)return this;var e,h,g,m=this,p=a.indexOf(" ");return 0<=p&&(e=a.slice(p,a.length),a=a.slice(0,p)),f.isFunction(b)?(d=b,b=c):b&&"object"==typeof b&&(h="POST"),f.ajax({url:a,type:h,dataType:"html",data:b,complete:function(a,b){d&&m.each(d,g||[a.responseText,b,a])}}).done(function(a){g=arguments;m.html(e?f("\x3cdiv\x3e").append(a.replace(nc,"")).find(e):
a)}),this};f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}});f.each(["get","post"],function(a,b){f[b]=function(a,d,e,h){return f.isFunction(d)&&(h=h||e,e=d,d=c),f.ajax({type:b,url:a,data:d,success:e,dataType:h})}});f.extend({getScript:function(a,b){return f.get(a,c,b,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?ka(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),ka(a,
b),a},ajaxSettings:{url:da,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(Y[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":nb},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,
"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:A(za),ajaxTransport:A(mb),ajax:function(a,b){function d(a,b,g,q){var k,l,z,w,t,C=b;if(2!==x){x=2;p&&clearTimeout(p);m=c;h=q||"";B.readyState=0<a?4:0;if(g){w=n;q=B;var F,E,N,O,H=w.contents,ca=w.dataTypes,Na=w.responseFields;for(E in Na)E in g&&(q[Na[E]]=g[E]);for(;"*"===ca[0];)ca.shift(),F===c&&(F=w.mimeType||q.getResponseHeader("content-type"));if(F)for(E in H)if(H[E]&&H[E].test(F)){ca.unshift(E);break}if(ca[0]in g)N=ca[0];else{for(E in g){if(!ca[0]||
w.converters[E+" "+ca[0]]){N=E;break}O||(O=E)}N=N||O}g=N?(N!==ca[0]&&ca.unshift(N),g[N]):void 0;w=g}if(200<=a&&300>a||304===a)if(n.ifModified&&(t=B.getResponseHeader("Last-Modified"),t&&(f.lastModified[e]=t),t=B.getResponseHeader("Etag"),t&&(f.etag[e]=t)),304===a)C="notmodified",k=!0;else{var A;a:{k=n;l=w;var J,C=k.dataTypes.slice();g=C[0];F={};E=0;k.dataFilter&&(l=k.dataFilter(l,k.dataType));if(C[1])for(A in k.converters)F[A.toLowerCase()]=k.converters[A];for(;z=C[++E];)if("*"!==z){if("*"!==g&&g!==
z){A=F[g+" "+z]||F["* "+z];if(!A)for(J in F)if(t=J.split(" "),t[1]===z&&(A=F[g+" "+t[0]]||F["* "+t[0]])){!0===A?A=F[J]:!0!==F[J]&&(z=t[0],C.splice(E--,0,z));break}if(!0!==A)if(A&&k["throws"])l=A(l);else try{l=A(l)}catch(Q){A={state:"parsererror",error:A?Q:"No conversion from "+g+" to "+z};break a}}g=z}A={state:"success",data:l}}k=A;C=k.state;l=k.data;z=k.error;k=!z}else if(z=C,!C||a)C="error",0>a&&(a=0);B.status=a;B.statusText=(b||C)+"";k?D.resolveWith(y,[l,C,B]):D.rejectWith(y,[B,C,z]);B.statusCode(u);
u=c;r&&s.trigger("ajax"+(k?"Success":"Error"),[B,n,k?l:z]);V.fireWith(y,[B,C]);r&&(s.trigger("ajaxComplete",[B,n]),--f.active||f.event.trigger("ajaxStop"))}}"object"==typeof a&&(b=a,a=c);b=b||{};var e,h,g,m,p,k,r,l,n=f.ajaxSetup({},b),y=n.context||n,s=y!==n&&(y.nodeType||y instanceof f)?f(y):f.event,D=f.Deferred(),V=f.Callbacks("once memory"),u=n.statusCode||{},t={},C={},x=0,E="canceled",B={readyState:0,setRequestHeader:function(a,b){if(!x){var c=a.toLowerCase();a=C[c]=C[c]||a;t[a]=b}return this},
getAllResponseHeaders:function(){return 2===x?h:null},getResponseHeader:function(a){var b;if(2===x){if(!g)for(g={};b=kc.exec(h);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return b===c?null:b},overrideMimeType:function(a){return x||(n.mimeType=a),this},abort:function(a){return a=a||E,m&&m.abort(a),d(0,a),this}};D.promise(B);B.success=B.done;B.error=B.fail;B.complete=V.add;B.statusCode=function(a){if(a){var b;if(2>x)for(b in a)u[b]=[u[b],a[b]];else b=a[B.status],B.always(b)}return this};n.url=
((a||n.url)+"").replace(jc,"").replace(mc,Y[1]+"//");n.dataTypes=f.trim(n.dataType||"*").toLowerCase().split(aa);null==n.crossDomain&&(k=kb.exec(n.url.toLowerCase())||!1,n.crossDomain=k&&k.join(":")+(k[3]?"":"http:"===k[1]?80:443)!==Y.join(":")+(Y[3]?"":"http:"===Y[1]?80:443));n.data&&n.processData&&"string"!=typeof n.data&&(n.data=f.param(n.data,n.traditional));J(za,n,b,B);if(2===x)return B;r=n.global;n.type=n.type.toUpperCase();n.hasContent=!lc.test(n.type);r&&0===f.active++&&f.event.trigger("ajaxStart");
if(!n.hasContent&&(n.data&&(n.url+=(jb.test(n.url)?"\x26":"?")+n.data,delete n.data),e=n.url,!1===n.cache)){k=f.now();var N=n.url.replace(oc,"$1_\x3d"+k);n.url=N+(N===n.url?(jb.test(n.url)?"\x26":"?")+"_\x3d"+k:"")}(n.data&&n.hasContent&&!1!==n.contentType||b.contentType)&&B.setRequestHeader("Content-Type",n.contentType);n.ifModified&&(e=e||n.url,f.lastModified[e]&&B.setRequestHeader("If-Modified-Since",f.lastModified[e]),f.etag[e]&&B.setRequestHeader("If-None-Match",f.etag[e]));B.setRequestHeader("Accept",
n.dataTypes[0]&&n.accepts[n.dataTypes[0]]?n.accepts[n.dataTypes[0]]+("*"!==n.dataTypes[0]?", "+nb+"; q\x3d0.01":""):n.accepts["*"]);for(l in n.headers)B.setRequestHeader(l,n.headers[l]);if(!n.beforeSend||!1!==n.beforeSend.call(y,B,n)&&2!==x){E="abort";for(l in{success:1,error:1,complete:1})B[l](n[l]);if(m=J(mb,n,b,B)){B.readyState=1;r&&s.trigger("ajaxSend",[B,n]);n.async&&0<n.timeout&&(p=setTimeout(function(){B.abort("timeout")},n.timeout));try{x=1,m.send(t,d)}catch(O){if(2>x)d(-1,O);else throw O;
}}else d(-1,"No Transport");return B}return B.abort()},active:0,lastModified:{},etag:{}});var ob=[],pc=/\?/,wa=/(=)\?(?=&|$)|\?\?/,qc=f.now();f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=ob.pop()||f.expando+"_"+qc++;return this[a]=!0,a}});f.ajaxPrefilter("json jsonp",function(b,d,e){var h,g,m,p=b.data,k=b.url,r=!1!==b.jsonp,l=r&&wa.test(k),n=r&&!l&&"string"==typeof p&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&wa.test(p);if("jsonp"===b.dataTypes[0]||l||n)return h=
b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,g=a[h],l?b.url=k.replace(wa,"$1"+h):n?b.data=p.replace(wa,"$1"+h):r&&(b.url+=(pc.test(k)?"\x26":"?")+b.jsonp+"\x3d"+h),b.converters["script json"]=function(){return m||f.error(h+" was not called"),m[0]},b.dataTypes[0]="json",a[h]=function(){m=arguments},e.always(function(){a[h]=g;b[h]&&(b.jsonpCallback=d.jsonpCallback,ob.push(h));m&&f.isFunction(g)&&g(m[0]);m=g=c}),"script"});f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return f.globalEval(a),a}}});f.ajaxPrefilter("script",function(a){a.cache===c&&(a.cache=!1);a.crossDomain&&(a.type="GET",a.global=!1)});f.ajaxTransport("script",function(a){if(a.crossDomain){var b,d=x.head||x.getElementsByTagName("head")[0]||x.documentElement;return{send:function(e,f){b=x.createElement("script");b.async="async";a.scriptCharset&&(b.charset=a.scriptCharset);b.src=a.url;b.onload=b.onreadystatechange=function(a,
e){if(e||!b.readyState||/loaded|complete/.test(b.readyState))b.onload=b.onreadystatechange=null,d&&b.parentNode&&d.removeChild(b),b=c,e||f(200,"success")};d.insertBefore(b,d.firstChild)},abort:function(){b&&b.onload(0,1)}}}});var ga,Ia=a.ActiveXObject?function(){for(var a in ga)ga[a](0,1)}:!1,rc=0;f.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&la()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:la;(function(a){f.extend(f.support,
{ajax:!!a,cors:!!a&&"withCredentials"in a})})(f.ajaxSettings.xhr());f.support.ajax&&f.ajaxTransport(function(b){if(!b.crossDomain||f.support.cors){var d;return{send:function(e,h){var g,m,p=b.xhr();b.username?p.open(b.type,b.url,b.async,b.username,b.password):p.open(b.type,b.url,b.async);if(b.xhrFields)for(m in b.xhrFields)p[m]=b.xhrFields[m];b.mimeType&&p.overrideMimeType&&p.overrideMimeType(b.mimeType);!b.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(m in e)p.setRequestHeader(m,
e[m])}catch(k){}p.send(b.hasContent&&b.data||null);d=function(a,e){var m,k,r,l,n;try{if(d&&(e||4===p.readyState))if(d=c,g&&(p.onreadystatechange=f.noop,Ia&&delete ga[g]),e)4!==p.readyState&&p.abort();else{m=p.status;r=p.getAllResponseHeaders();l={};(n=p.responseXML)&&n.documentElement&&(l.xml=n);try{l.text=p.responseText}catch(y){}try{k=p.statusText}catch(s){k=""}!m&&b.isLocal&&!b.crossDomain?m=l.text?200:404:1223===m&&(m=204)}}catch(D){e||h(-1,D)}l&&h(m,k,l,r)};b.async?4===p.readyState?setTimeout(d,
0):(g=++rc,Ia&&(ga||(ga={},f(a).unload(Ia)),ga[g]=d),p.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var pa,xa,sc=/^(?:toggle|show|hide)$/,tc=RegExp("^(?:([-+])\x3d|)("+ua+")([a-z%]*)$","i"),uc=/queueHooks$/,ta=[function(a,b,c){var d,e,h,g,m,p,k=this,r=a.style,l={},n=[],s=a.nodeType&&y(a);c.queue||(m=f._queueHooks(a,"fx"),null==m.unqueued&&(m.unqueued=0,p=m.empty.fire,m.empty.fire=function(){m.unqueued||p()}),m.unqueued++,k.always(function(){k.always(function(){m.unqueued--;f.queue(a,
"fx").length||m.empty.fire()})}));1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[r.overflow,r.overflowX,r.overflowY],"inline"===f.css(a,"display")&&"none"===f.css(a,"float")&&(!f.support.inlineBlockNeedsLayout||"inline"===Q(a.nodeName)?r.display="inline-block":r.zoom=1));c.overflow&&(r.overflow="hidden",f.support.shrinkWrapBlocks||k.done(function(){r.overflow=c.overflow[0];r.overflowX=c.overflow[1];r.overflowY=c.overflow[2]}));for(d in b)e=b[d],sc.exec(e)&&(delete b[d],e!==(s?"hide":"show")&&
n.push(d));if(e=n.length){h=f._data(a,"fxshow")||f._data(a,"fxshow",{});s?f(a).show():k.done(function(){f(a).hide()});k.done(function(){var b;f.removeData(a,"fxshow",!0);for(b in l)f.style(a,b,l[b])});for(d=0;d<e;d++)b=n[d],g=k.createTween(b,s?h[b]:0),l[b]=h[b]||f.style(a,b),b in h||(h[b]=g.start,s&&(g.end=g.start,g.start="width"===b||"height"===b?1:0))}}],ia={"*":[function(a,b){var c,d,e=this.createTween(a,b),h=tc.exec(b),g=e.cur(),m=+g||0,p=1,k=20;if(h){c=+h[2];d=h[3]||(f.cssNumber[a]?"":"px");
if("px"!==d&&m){m=f.css(e.elem,a,!0)||c||1;do p=p||".5",m/=p,f.style(e.elem,a,m+d);while(p!==(p=e.cur()/g)&&1!==p&&--k)}e.unit=d;e.start=m;e.end=h[1]?m+(h[1]+1)*c:c}return e}]};f.Animation=f.extend(sa,{tweener:function(a,b){f.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],ia[c]=ia[c]||[],ia[c].unshift(b)},prefilter:function(a,b){b?ta.unshift(a):ta.push(a)}});f.Tween=M;M.prototype={constructor:M,init:function(a,b,c,d,e,h){this.elem=a;this.prop=c;this.easing=e||"swing";
this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=h||(f.cssNumber[c]?"":"px")},cur:function(){var a=M.propHooks[this.prop];return a&&a.get?a.get(this):M.propHooks._default.get(this)},run:function(a){var b,c=M.propHooks[this.prop];return this.options.duration?this.pos=b=f.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):
M.propHooks._default.set(this),this}};M.prototype.init.prototype=M.prototype;M.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=f.css(a.elem,a.prop,!1,""),!b||"auto"===b?0:b):a.elem[a.prop]},set:function(a){f.fx.step[a.prop]?f.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[f.cssProps[a.prop]]||f.cssHooks[a.prop])?f.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}};M.propHooks.scrollTop=M.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&
a.elem.parentNode&&(a.elem[a.prop]=a.now)}};f.each(["toggle","show","hide"],function(a,b){var c=f.fn[b];f.fn[b]=function(d,e,h){return null==d||"boolean"==typeof d||!a&&f.isFunction(d)&&f.isFunction(e)?c.apply(this,arguments):this.animate(V(b,!0),d,e,h)}});f.fn.extend({fadeTo:function(a,b,c,d){return this.filter(y).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=f.isEmptyObject(a),h=f.speed(b,c,d);b=function(){var b=sa(this,f.extend({},a),h);e&&b.stop(!0)};
return e||!1===h.queue?this.each(b):this.queue(h.queue,b)},stop:function(a,b,d){var e=function(a){var b=a.stop;delete a.stop;b(d)};return"string"!=typeof a&&(d=b,b=a,a=c),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",h=f.timers,g=f._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&uc.test(c)&&e(g[c]);for(c=h.length;c--;)h[c].elem===this&&(null==a||h[c].queue===a)&&(h[c].anim.stop(d),b=!1,h.splice(c,1));(b||!d)&&f.dequeue(this,a)})}});
f.each({slideDown:V("show"),slideUp:V("hide"),slideToggle:V("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});f.speed=function(a,b,c){var d=a&&"object"==typeof a?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;
if(null==d.queue||!0===d.queue)d.queue="fx";return d.old=d.complete,d.complete=function(){f.isFunction(d.old)&&d.old.call(this);d.queue&&f.dequeue(this,d.queue)},d};f.easing={linear:function(a){return a},swing:function(a){return 0.5-Math.cos(a*Math.PI)/2}};f.timers=[];f.fx=M.prototype.init;f.fx.tick=function(){for(var a,b=f.timers,c=0;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()};f.fx.timer=function(a){a()&&f.timers.push(a)&&!xa&&(xa=setInterval(f.fx.tick,f.fx.interval))};
f.fx.interval=13;f.fx.stop=function(){clearInterval(xa);xa=null};f.fx.speeds={slow:600,fast:200,_default:400};f.fx.step={};f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var pb=/^(?:body|html)$/i;f.fn.offset=function(a){if(arguments.length)return a===c?this:this.each(function(b){f.offset.setOffset(this,a,b)});var b,d,e,h,g,m,p,k={top:0,left:0},r=this[0],l=r&&r.ownerDocument;if(l)return(d=l.body)===r?f.offset.bodyOffset(r):
(b=l.documentElement,f.contains(b,r)?("undefined"!=typeof r.getBoundingClientRect&&(k=r.getBoundingClientRect()),e=B(l),h=b.clientTop||d.clientTop||0,g=b.clientLeft||d.clientLeft||0,m=e.pageYOffset||b.scrollTop,p=e.pageXOffset||b.scrollLeft,{top:k.top+m-h,left:k.left+p-g}):k)};f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,
b,c){var d=f.css(a,"position");"static"===d&&(a.style.position="relative");var e=f(a),h=e.offset(),g=f.css(a,"top"),m=f.css(a,"left"),p={},k={},r,l;("absolute"===d||"fixed"===d)&&-1<f.inArray("auto",[g,m])?(k=e.position(),r=k.top,l=k.left):(r=parseFloat(g)||0,l=parseFloat(m)||0);f.isFunction(b)&&(b=b.call(a,c,h));null!=b.top&&(p.top=b.top-h.top+r);null!=b.left&&(p.left=b.left-h.left+l);"using"in b?b.using.call(a,p):e.css(p)}};f.fn.extend({position:function(){if(this[0]){var a=this[0],b=this.offsetParent(),
c=this.offset(),d=pb.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||x.body;a&&!pb.test(a.nodeName)&&"static"===f.css(a,"position");)a=a.offsetParent;return a||x.body})}});f.each({scrollLeft:"pageXOffset",
scrollTop:"pageYOffset"},function(a,b){var d=/Y/.test(b);f.fn[a]=function(e){return f.access(this,function(a,e,h){var g=B(a);if(h===c)return g?b in g?g[b]:g.document.documentElement[e]:a[e];g?g.scrollTo(d?f(g).scrollLeft():h,d?h:f(g).scrollTop()):a[e]=h},a,e,arguments.length,null)}});f.each({Height:"height",Width:"width"},function(a,b){f.each({padding:"inner"+a,content:b,"":"outer"+a},function(d,e){f.fn[e]=function(e,h){var g=arguments.length&&(d||"boolean"!=typeof e),m=d||(!0===e||!0===h?"margin":
"border");return f.access(this,function(b,d,e){var h;return f.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(h=b.documentElement,Math.max(b.body["scroll"+a],h["scroll"+a],b.body["offset"+a],h["offset"+a],h["client"+a])):e===c?f.css(b,d,e,m):f.style(b,d,e,m)},b,g?e:c,g,null)}})});a.jQuery=a.$=f;"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);/*
 MelonJS Game Engine
 @copyright (C) 2011 - 2014 Olivier Biot, Jason Oster, Aaron McLeod
 http://www.melonjs.org

 melonJS is licensed under the MIT License.
 http://www.opensource.org/licenses/mit-license.php

 Tween JS
 https://github.com/sole/Tween.js
 MinPubSub
 a micro publish/subscribe messaging framework
 @see https://github.com/daniellmb/MinPubSub 
 @author Daniel Lamb <daniellmb.com>

 Released under the MIT License
*/
window.me=window.me||{};
(function(a){function c(){if(!g){if(!d.body)return setTimeout(c,13);d.removeEventListener?d.removeEventListener("DOMContentLoaded",c,!1):a.removeEventListener("load",c,!1);g=!0;for(var b=0;b<l.length;b++)l[b].call(a,[]);l.length=0}}var d=a.document;me={mod:"melonJS",version:"1.0.0"};"function"==typeof define&&define.amd&&define("me",[],function(){return me});me.sys={fps:60,interpolation:!1,scale:null,scalingInterpolation:!1,gravity:void 0,stopOnAudioError:!0,pauseOnBlur:!0,resumeOnFocus:!0,stopOnBlur:!1,
preRender:!1,checkVersion:function(a,b){b=b||me.version;for(var c=a.split("."),d=b.split("."),e=Math.min(c.length,d.length),g=0,k=0;e>k&&!(g=+c[k]-+d[k]);k++);return g?g:c.length-d.length}};var b=!1,e=!1,g=!1,l=[];a.onReady=function(b){return e||(e=!0,"complete"===d.readyState?c():(d.addEventListener&&d.addEventListener("DOMContentLoaded",c,!1),a.addEventListener("load",c,!1))),g?b.call(a,[]):l.push(function(){return b.call(a,[])}),this};a.onReady(function(){b||(me.device._check(),me.save._init(),
me.loader.setNocache(d.location.href.match(/\?nocache/)||!1),me.timer.init(),me.mapReader=new me.TMXMapReader,me.state.init(),me.pool.init(),me.levelDirector.reset(),b=!0)});var k=!1,n=/var xyz/.test(function(){})?/\bparent\b/:/[\D|\d]*/;Object.defineProperty||(Object.defineProperty=function(a,b,c){if(!a.__defineGetter__)throw"melonJS: Object.defineProperty not supported";c.get&&a.__defineGetter__(b,c.get);c.set&&a.__defineSetter__(b,c.set)});Object.defineProperty(Object.prototype,"mixin",{value:function(a){for(var b in a)a.hasOwnProperty(b)&&
(this[b]=a[b]);return this},enumerable:!1,configurable:!1});var s=function(a){if(null==a||"object"!=typeof a)return a;var b;if(a instanceof Array){b=[];Object.setPrototypeOf(b,Object.getPrototypeOf(a));for(var c=0,d=a.length;d>c;c++)b[c]=s(a[c]);return b}if(a instanceof Date)return b=new Date,b.setTime(a.getTime()),b;b={};Object.setPrototypeOf(b,Object.getPrototypeOf(a));for(c in a)a.hasOwnProperty(c)&&(b[c]=s(a[c]));return b};if(Object.extend=function(a){function b(a,c){return function(){var b=this.parent;
this.parent=d[a];var e=c.apply(this,arguments);return this.parent=b,e}}function c(){if(!k){for(var a in this)"object"==typeof this[a]&&(this[a]=s(this[a]));this.init&&this.init.apply(this,arguments)}return this}var d=this.prototype;k=!0;var e=new this;k=!1;for(var g in a)e[g]="function"==typeof a[g]&&"function"==typeof d[g]&&n.test(a[g])?b(g,a[g]):a[g];return c.prototype=e,c.constructor=c,c.extend=Object.extend,c},"function"!=typeof Object.create&&(Object.create=function(a){var b=function(){};return b.prototype=
a,new b}),!Function.prototype.bind){var u=function(){};Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError("Function.prototype.bind called on incompatible "+b);var c=Array.prototype.slice.call(arguments,1),d=function(){if(this instanceof d){var e=b.apply(this,c.concat(Array.prototype.slice.call(arguments)));return Object(e)===e?e:this}return b.apply(a,c.concat(Array.prototype.slice.call(arguments)))};return b.prototype&&(u.prototype=b.prototype,d.prototype=new u,
u.prototype=null),d}}if(window.throttle||(window.throttle=function(a,b,c){var d,e=window.performance.now();return"boolean"!=typeof b&&(b=!1),function(){var g=window.performance.now(),k=g-e,l=arguments;return a>k?void(!1===b&&(clearTimeout(d),d=setTimeout(function(){return e=g,c.apply(null,l)},k))):(e=g,c.apply(null,l))}}),"undefined"==typeof Date.now&&(Date.now=function(){return(new Date).getTime()}),"undefined"==typeof window.performance&&(window.performance={}),!window.performance.now){var t=Date.now();
window.performance.timing&&window.performance.timing.navigationStart&&(t=window.performance.timing.navigationStart);window.performance.now=function(){return Date.now()-t}}"undefined"==typeof console&&(console={log:function(){},info:function(){},error:function(){alert(Array.prototype.slice.call(arguments).join(", "))}});Function.prototype.defer=function(){return setTimeout(this.bind.apply(this,arguments),0.01)};Object.getPrototypeOf=Object.getPrototypeOf||function(a){return a.__proto__};Object.setPrototypeOf=
Object.setPrototypeOf||function(a,b){return a.__proto__=b,a};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gm,"")});String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")});String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")});String.prototype.isNumeric=function(){return null!==this&&!isNaN(this)&&""!==this.trim()};String.prototype.isBoolean=function(){return null!==this&&
("true"===this.trim()||"false"===this.trim())};String.prototype.contains||(String.prototype.contains=function(a,b){return-1!==String.prototype.indexOf.call(this,a,b)});String.prototype.toHex=function(){for(var a="",b=0;b<this.length;)a+=this.charCodeAt(b++).toString(16);return a};Number.prototype.clamp=function(a,b){return a>this?a:this>b?b:+this};Number.prototype.random=function(a,b){return~~(Math.random()*(b-a+1))+a};Number.prototype.round=function(){var a=2>arguments.length?this:arguments[0],b=
Math.pow(10,arguments[1]||arguments[0]||0);return Math.round(a*b)/b};Number.prototype.toHex=function(){return"0123456789ABCDEF".charAt(this-this%16>>4)+"0123456789ABCDEF".charAt(this%16)};Number.prototype.sign=function(){return 0>this?-1:0<this?1:0};Number.prototype.degToRad=function(a){return(a||this)/180*Math.PI};Number.prototype.radToDeg=function(a){return(a||this)*(180/Math.PI)};Array.prototype.remove=function(a){a=Array.prototype.indexOf.call(this,a);return-1!==a&&Array.prototype.splice.call(this,
a,1),this};Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;d--;c++)a.call(b||this,this[c],c,this)});Object.defineProperty(me,"initialized",{get:function(){return b}});me.game=function(){var a={},b=null,c=!1,d=!0,e=0,g=1;return a.viewport=null,a.collisionMap=null,a.currentLevel=null,a.world=null,a.mergeGroup=!0,a.sortOn="z",a.renderer=null,a.NO_OBJECT=0,a.ENEMY_OBJECT=1,a.COLLECTABLE_OBJECT=2,a.ACTION_OBJECT=3,a.onLevelLoaded=null,a.init=function(e,g){c||(e=
e||me.video.getWidth(),g=g||me.video.getHeight(),a.viewport=new me.Viewport(0,0,e,g),a.world=new me.ObjectContainer(0,0,e,g),a.world.name="rootContainer",b=me.video.getSystemContext(),me.event.publish(me.event.GAME_INIT),me.input.translatePointerEvents(),d=!0,a.currentLevel={pos:{x:0,y:0}},c=!0)},a.reset=function(){a.world.destroy();a.viewport&&a.viewport.reset();a.currentLevel={pos:{x:0,y:0}};b.setTransform(1,0,0,1,0,0);e=0;g=Math.round(60/me.sys.fps)},a.getParentContainer=function(a){return a.ancestor},
a.collide=function(b,c){return a.world.collide(b,c)},a.collideType=function(b,c,d){return a.world.collideType(b,c,d)},a.repaint=function(){d=!0},a.update=function(b){0===++e%g&&(e=0,me.timer.update(b),d=a.world.update(me.timer.getDelta())||d,d=a.viewport.update(me.timer.getDelta())||d)},a.draw=function(){if(d){var c=a.viewport.pos.x+~~a.viewport.offset.x,e=a.viewport.pos.y+~~a.viewport.offset.y;a.world.transform.translate(-c,-e);a.viewport.screenX=c-a.currentLevel.pos.x;a.viewport.screenY=e-a.currentLevel.pos.y;
a.world.draw(b,a.viewport);a.world.transform.translate(c,e);a.viewport.draw(b)}d=!1;me.video.blitSurface()},a}()})(window);
(function(a){me.device=function(){function c(a){a.reading?(b.accelerationX=a.reading.accelerationX,b.accelerationY=a.reading.accelerationY,b.accelerationZ=a.reading.accelerationZ):(b.accelerationX=a.accelerationIncludingGravity.x,b.accelerationY=a.accelerationIncludingGravity.y,b.accelerationZ=a.accelerationIncludingGravity.z)}function d(a){b.gamma=a.gamma;b.beta=a.beta;b.alpha=a.alpha}var b={},e=!1,g=!1,l=null;return b._check=function(){me.device.pointerEnabled=navigator.pointerEnabled||navigator.msPointerEnabled;
navigator.maxTouchPoints=navigator.maxTouchPoints||navigator.msMaxTouchPoints||0;a.gesture=a.gesture||a.MSGesture;me.device.touch="createTouch"in document||"ontouchstart"in a||navigator.isCocoonJS||0<navigator.maxTouchPoints;me.device.isMobile=me.device.ua.match(/Android|iPhone|iPad|iPod|BlackBerry|Windows Phone|Mobi/i)||!1;me.device.hasAccelerometer="undefined"!=typeof a.DeviceMotionEvent||"undefined"!=typeof a.Windows&&"function"==typeof Windows.Devices.Sensors.Accelerometer;(this.hasPointerLockSupport=
"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document)&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock);a.DeviceOrientationEvent&&(me.device.hasDeviceOrientation=!0);this.hasFullScreenSupport=document.fullscreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled;document.exitFullscreen=document.cancelFullScreen||document.exitFullscreen||
document.webkitCancelFullScreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate;try{b.localStorage=!!a.localStorage}catch(c){b.localStorage=!1}me.device._detectAudio()},b._detectAudio=function(){if(me.device.sound=!Howler.noAudio,me.device.sound){var a=new Audio;me.device.audioCodecs={mp3:!!a.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!a.canPlayType('audio/ogg; codecs\x3d"opus"').replace(/^no$/,
""),ogg:!!a.canPlayType('audio/ogg; codecs\x3d"vorbis"').replace(/^no$/,""),wav:!!a.canPlayType('audio/wav; codecs\x3d"1"').replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!a.canPlayType('audio/webm; codecs\x3d"vorbis"').replace(/^no$/,"")}}},b.ua=navigator.userAgent,b.audioCodecs={},b.sound=!1,b.localStorage=!1,b.hasAccelerometer=!1,b.hasDeviceOrientation=
!1,b.hasFullScreenSupport=!1,b.hasPointerLockSupport=!1,b.nativeBase64="function"==typeof a.atob,b.touch=!1,b.isMobile=!1,b.orientation=0,b.accelerationX=0,b.accelerationY=0,b.accelerationZ=0,b.gamma=0,b.beta=0,b.alpha=0,b.requestFullscreen=function(a){this.hasFullScreenSupport&&(a=a||me.video.getWrapper(),a.requestFullscreen=a.requestFullscreen||a.webkitRequestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen,a.requestFullscreen())},b.exitFullscreen=function(){this.hasFullScreenSupport&&
document.exitFullscreen()},b.getPixelRatio=function(){if(null===l){var b=me.video.getScreenContext();l=(a.devicePixelRatio||1)/(b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1)}return l},b.getStorage=function(a){switch(a=a||"local"){case "local":return me.save}throw"melonJS : storage type "+a+" not supported";},b.turnOnPointerLock=function(){if(this.hasPointerLockSupport){var a=me.video.getWrapper();if(me.device.ua.match(/Firefox/i)){var b=
function(){(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement)===a&&(document.removeEventListener("fullscreenchange",b),document.removeEventListener("mozfullscreenchange",b),a.requestPointerLock=a.requestPointerLock||a.mozRequestPointerLock||a.webkitRequestPointerLock,a.requestPointerLock())};document.addEventListener("fullscreenchange",b,!1);document.addEventListener("mozfullscreenchange",b,!1);me.device.requestFullscreen()}else a.requestPointerLock()}},
b.turnOffPointerLock=function(){this.hasPointerLockSupport&&document.exitPointerLock()},b.watchAccelerometer=function(){if(me.device.hasAccelerometer){if(!e){if("undefined"==typeof Windows)a.addEventListener("devicemotion",c,!1);else{var b=Windows.Devices.Sensors.Accelerometer.getDefault();if(b){var d=b.minimumReportInterval;b.reportInterval=16<=d?d:25;b.addEventListener("readingchanged",c,!1)}}e=!0}return!0}return!1},b.unwatchAccelerometer=function(){e&&("undefined"==typeof Windows?a.removeEventListener("devicemotion",
c,!1):Windows.Device.Sensors.Accelerometer.getDefault().removeEventListener("readingchanged",c,!1),e=!1)},b.watchDeviceOrientation=function(){return me.device.hasDeviceOrientation&&!g&&(a.addEventListener("deviceorientation",d,!1),g=!0),!1},b.unwatchDeviceOrientation=function(){g&&(a.removeEventListener("deviceorientation",d,!1),g=!1)},b.vibrate=function(a){navigator.vibrate&&navigator.vibrate(a)},b}();Object.defineProperty(me.device,"isFullscreen",{get:function(){return me.device.hasFullScreenSupport?
(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement)===me.video.getWrapper():!1}})})(window);
(function(a){me.timer=function(){var c={},d=0,b=0,e=0,g=0,l=0,k=Math.ceil(1E3/me.sys.fps),n=1.25*(1E3/me.sys.fps),s=[],u=0,t=function(a){for(var b=0,c=s.length;c>b;b++)if(s[b].timerId===a){s.splice(b,1);break}},r=function(a){for(var b=0,c=s.length;c>b;b++){var d=s[b];d.pauseable&&me.state.isPaused()||(d.elapsed+=a);d.elapsed>=d.delay&&(d.func.apply(this),!0===d.repeat?d.elapsed-=d.delay:me.timer.clearTimeout(d.timerId))}};return c.tick=1,c.fps=0,c.init=function(){c.reset();g=e=0},c.reset=function(){e=
g=a.performance.now();d=b=l=0},c.setTimeout=function(a,b,c){return s.push({func:a,delay:b,elapsed:0,repeat:!1,timerId:++u,pauseable:!0===c||!0}),u},c.setInterval=function(a,b,c){return s.push({func:a,delay:b,elapsed:0,repeat:!0,timerId:++u,pauseable:!0===c||!0}),u},c.clearTimeout=function(a){t.defer(this,a)},c.clearInterval=function(a){t.defer(this,a)},c.getTime=function(){return g},c.getDelta=function(){return l},c.countFPS=function(){d++;b+=l;0===d%10&&(this.fps=(~~(1E3*d/b)).clamp(0,me.sys.fps),
b=0,d=0)},c.update=function(a){return e=g,g=a,l=g-e,c.tick=l>n&&me.sys.interpolation?l/k:1,r(l),l},c}()})(window);
(function(){me.pool=function(){var a={},c={};return a.init=function(){a.register("me.ObjectEntity",me.ObjectEntity);a.register("me.CollectableEntity",me.CollectableEntity);a.register("me.LevelEntity",me.LevelEntity);a.register("me.Tween",me.Tween,!0);a.register("me.Color",me.Color,!0);a.register("me.Particle",me.Particle,!0)},a.register=function(a,b,e){return e?void(c[a.toLowerCase()]={"class":b,pool:[]}):void(c[a.toLowerCase()]={"class":b,pool:void 0})},a.pull=function(a){var b="string"==typeof a?
a.toLowerCase():void 0,e=Array.prototype.slice.call(arguments);if(b&&c[b]){var g;if(!c[b].pool)return g=c[b]["class"],e[0]=g,new (g.bind.apply(g,e));var l,k=c[b];return g=k["class"],0<k.pool.length?(l=k.pool.pop(),"function"==typeof l.init&&l.init.apply(l,e.slice(1)),"function"==typeof l.onResetEvent&&l.onResetEvent.apply(l,e.slice(1))):(e[0]=g,l=new (g.bind.apply(g,e)),l.className=b),l}return(e=arguments[3])&&e.gid&&e.image?new me.SpriteObject(e.x,e.y,e.image):(b&&console.error("Cannot instantiate entity of type '"+
a+"': Class not found!"),null)},a.purge=function(){for(var a in c)c[a].pool=[]},a.push=function(a){var b=a.className;"undefined"!=typeof b&&c[b]&&c[b].pool.push(a)},a}()})(window);
(function(){me.Vector2d=Object.extend({x:0,y:0,init:function(a,c){this.x=a||0;this.y=c||0},set:function(a,c){return this.x=a,this.y=c,this},setZero:function(){return this.set(0,0)},setV:function(a){return this.x=a.x,this.y=a.y,this},add:function(a){return this.x+=a.x,this.y+=a.y,this},sub:function(a){return this.x-=a.x,this.y-=a.y,this},scale:function(a){return this.x*=a.x,this.y*=a.y,this},div:function(a){return this.x/=a,this.y/=a,this},abs:function(){return 0>this.x&&(this.x=-this.x),0>this.y&&
(this.y=-this.y),this},clamp:function(a,c){return new me.Vector2d(this.x.clamp(a,c),this.y.clamp(a,c))},clampSelf:function(a,c){return this.x=this.x.clamp(a,c),this.y=this.y.clamp(a,c),this},minV:function(a){return this.x=this.x<a.x?this.x:a.x,this.y=this.y<a.y?this.y:a.y,this},maxV:function(a){return this.x=this.x>a.x?this.x:a.x,this.y=this.y>a.y?this.y:a.y,this},floor:function(){return new me.Vector2d(~~this.x,~~this.y)},floorSelf:function(){return this.x=~~this.x,this.y=~~this.y,this},ceil:function(){return new me.Vector2d(Math.ceil(this.x),
Math.ceil(this.y))},ceilSelf:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},negate:function(){return new me.Vector2d(-this.x,-this.y)},negateSelf:function(){return this.x=-this.x,this.y=-this.y,this},copy:function(a){return this.x=a.x,this.y=a.y,this},equals:function(a){return this.x===a.x&&this.y===a.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var a=this.length();if(a<Number.MIN_VALUE)return 0;var c=1/a;return this.x*=c,this.y*=
c,a},dotProduct:function(a){return this.x*a.x+this.y*a.y},distance:function(a){return Math.sqrt((this.x-a.x)*(this.x-a.x)+(this.y-a.y)*(this.y-a.y))},angle:function(a){return Math.atan2(a.y-this.y,a.x-this.x)},clone:function(){return new me.Vector2d(this.x,this.y)},toString:function(){return"x:"+this.x+",y:"+this.y}})})(window);
(function(){me.Rect=Object.extend({pos:new me.Vector2d,rangeV:new me.Vector2d,width:0,height:0,hWidth:0,hHeight:0,shapeType:"Rectangle",init:function(a,c,d){this.pos.setV(a);this.rangeV.set(0,0);this.width=c;this.height=d;this.hWidth=~~(c/2);this.hHeight=~~(d/2);Object.defineProperty(this,"left",{get:function(){var a=this.pos.x,c=a+this.rangeV.x;return c>a?a:c},configurable:!0});Object.defineProperty(this,"right",{get:function(){var a=this.pos.x+this.width,c=a+this.rangeV.x;return a>c?a:c},configurable:!0});
Object.defineProperty(this,"top",{get:function(){var a=this.pos.y,c=a+this.rangeV.y;return c>a?a:c},configurable:!0});Object.defineProperty(this,"bottom",{get:function(){var a=this.pos.y+this.height,c=a+this.rangeV.y;return a>c?a:c},configurable:!0})},setShape:function(a,c,d){return this.pos.setV(a),this.resize(c,d),this},resize:function(a,c){return this.width=a,this.height=c,this.hWidth=~~(a/2),this.hHeight=~~(c/2),this},getBounds:function(a){return"undefined"!=typeof a?a.setShape(this.pos,this.width,
this.height):this.clone()},clone:function(){return new me.Rect(this.pos,this.width,this.height)},translate:function(a,c){return this.pos.x+=a,this.pos.y+=c,this},translateV:function(a){return this.translate(a.x,a.y)},addV:function(a){return this.rangeV.setV(a),this},union:function(a){var c=Math.min(this.left,a.left),d=Math.min(this.top,a.top);return this.resize(Math.max(this.right,a.right)-c,Math.max(this.bottom,a.bottom)-d),this.pos.set(c,d),this},flipX:function(a){return this.pos.x=a-this.width-
this.pos.x,this},flipY:function(a){return this.pos.y=a-this.height-this.pos.y,this},equals:function(a){return this.left===a.left&&this.right===a.right&&this.top===a.top&&this.bottom===a.bottom},overlaps:function(a){return this.left<a.right&&a.left<this.right&&this.top<a.bottom&&a.top<this.bottom},within:function(a){return a.contains(this)},contains:function(a){return a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom},containsPointV:function(a){return this.containsPoint(a.x,
a.y)},containsPoint:function(a,c){return a>=this.left&&a<=this.right&&c>=this.top&&c<=this.bottom},collideWithRectangle:function(a){var c=new me.Vector2d(0,0);if(this.overlaps(a)){var d=this.left+this.hWidth-a.left-a.hWidth,b=this.top+this.hHeight-a.top-a.hHeight;c.x=a.hWidth+this.hWidth-(0>d?-d:d);c.y=a.hHeight+this.hHeight-(0>b?-b:b);c.x<c.y?(c.y=0,c.x=0>d?-c.x:c.x):(c.x=0,c.y=0>b?-c.y:c.y)}return c},draw:function(a,c){a.strokeStyle=c||"red";a.strokeRect(this.left,this.top,this.width,this.height)}})})(window);
(function(){me.Ellipse=Object.extend({pos:new me.Vector2d,radius:new me.Vector2d,shapeType:"Ellipse",init:function(a,c,d){this.setShape(a,c,d)},setShape:function(a,c,d){return this.radius.set(c/2,d/2),this.pos.setV(a).add(this.radius),this},translate:function(a,c){return this.pos.x+=a,this.pos.y+=c,this},translateV:function(a){return this.pos.add(a),this},containsPointV:function(a){return this.containsPoint(a.x,a.y)},containsPoint:function(a,c){return a-=this.pos.x,c-=this.pos.y,1>=a*a/(this.radius.x*
this.radius.x)+c*c/(this.radius.y*this.radius.y)},getBounds:function(a){return"undefined"!=typeof a?a.setShape(this.pos.clone().sub(this.radius),2*this.radius.x,2*this.radius.y):new me.Rect(this.pos.clone().sub(this.radius),2*this.radius.x,2*this.radius.y)},clone:function(){return new me.Ellipse(this.pos,2*this.radius.x,2*this.radius.y)},draw:function(a,c){a.save();a.beginPath();a.translate(this.pos.x-this.radius.x,this.pos.y-this.radius.y);a.scale(this.radius.x,this.radius.y);a.arc(1,1,1,0,2*Math.PI,
!1);a.restore();a.strokeStyle=c||"red";a.stroke()}})})(window);
(function(){me.PolyShape=Object.extend({pos:new me.Vector2d,points:null,closed:!1,shapeType:"PolyShape",init:function(a,c,d){this.setShape(a,c,d)},setShape:function(a,c,d){return this.pos.setV(a),this.points=c,this.closed=!0===d,this.getBounds(),this},translate:function(a,c){return this.pos.x+=a,this.pos.y+=c,this},translateV:function(a){return this.pos.add(a),this},containsPointV:function(a){return this.containsPoint(a.x,a.y)},containsPoint:function(a,c){for(var d=!1,b=this.pos.x,e=this.pos.y,g=
this.points,l=g.length,k=0,n=l-1;l>k;n=k++){var s=g[k].y+e,u=g[k].x+b,t=g[n].y+e,n=g[n].x+b;s>c!=t>c&&(n-u)*(c-s)/(t-s)+u>a&&(d=!d)}return d},getBounds:function(a){var c=this.pos.clone(),d=0,b=0;return this.points.forEach(function(a){c.x=Math.min(c.x,a.x);c.y=Math.min(c.y,a.y);d=Math.max(d,a.x);b=Math.max(b,a.y)}),"undefined"!=typeof a?a.setShape(c,d-c.x,b-c.y):new me.Rect(c,d-c.x,b-c.y)},clone:function(){var a=[];return this.points.forEach(function(c){a.push(new me.Vector2d(c.x,c.y))}),new me.PolyShape(this.pos.clone(),
a,this.closed)},draw:function(a,c){a.save();a.translate(-this.pos.x,-this.pos.y);a.strokeStyle=c||"red";a.beginPath();a.moveTo(this.points[0].x,this.points[0].y);this.points.forEach(function(c){a.lineTo(c.x,c.y);a.moveTo(c.x,c.y)});!0===this.closed&&a.lineTo(this.points[0].x,this.points[0].y);a.stroke();a.restore()}})})(window);
(function(){me.Matrix2d=Object.extend({a:1,b:0,c:0,d:1,e:0,f:0,init:function(a,c,d,b,e,g){this.set(a||1,c||0,d||0,b||1,e||0,g||0)},identity:function(){return this.set(1,0,0,1,0,0),this},set:function(a,c,d,b,e,g){return this.a=a,this.b=c,this.c=d,this.d=b,this.e="undefined"!=typeof e?e:this.e,this.f="undefined"!=typeof g?g:this.f,this},multiply:function(a,c,d,b,e,g){var l=this.a,k=this.b,n=this.c,s=this.d;return this.a=a*l+c*n,this.b=a*k+c*s,this.c=d*l+b*n,this.d=d*k+b*s,this.e=e*l+g*n+this.e,this.f=
e*k+g*s+this.f,this},scale:function(a,c){return this.a*=a,this.d*=c,this.e*=a,this.f*=c,this},rotate:function(a){if(0!==a){var c=Math.cos(a);a=Math.sin(a);var d=this.a,b=this.b,e=this.c,g=this.d,l=this.e,k=this.f;this.a=d*c-b*a;this.b=d*a+b*c;this.c=e*c-g*a;this.d=e*a+g*c;this.e=l*c-k*a;this.f=l*a+k*c}return this},translate:function(a,c){return this.e+=a,this.f+=c,this},translateV:function(a){return this.translate(a.x,a.y)},isIdentity:function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&
0===this.e&&0===this.f},clone:function(){return new me.Matrix2d(this.a,this.b,this.c,this.d,this.e,this.f)}})})(window);(function(){me.debug={renderCollisionMap:!1}})(window);
(function(){me.Renderable=me.Rect.extend({isRenderable:!0,GUID:void 0,visible:!0,inViewport:!1,alwaysUpdate:!1,updateWhenPaused:!1,isPersistent:!1,floating:!1,z:0,anchorPoint:new me.Vector2d,alpha:1,init:function(a,c,d){this.parent(a,c,d);this.anchorPoint.set(0.5,0.5);this.setOpacity(1)},getOpacity:function(){return this.alpha},setOpacity:function(a){"number"==typeof a&&(this.alpha=a.clamp(0,1))},update:function(){return!1},draw:function(a,c){this.parent(a,c)}})})(window);
(function(){me.SpriteObject=me.Renderable.extend({scale:new me.Vector2d,scaleFlag:!1,lastflipX:!1,lastflipY:!1,z:0,offset:new me.Vector2d,angle:0,_sourceAngle:0,image:null,flickering:!1,flickerDuration:0,flickercb:null,flickerState:!1,init:function(a,c,d,b,e){this.isSprite=!0;this.parent(new me.Vector2d(a,c),b||d.width,e||d.height);this.image=d;this.scale.set(1,1);this.scaleFlag=this.lastflipX=this.lastflipY=!1;this.offset.set(0,0);this.visible=!0;this.flickering=this.isPersistent=!1},setTransparency:function(a){a=
"#"===a.charAt(0)?a.substring(1,7):a;this.image=me.video.applyRGBFilter(this.image,"transparent",a.toUpperCase()).canvas},isFlickering:function(){return this.flickering},flicker:function(a,c){this.flickerDuration=a;0>=this.flickerDuration?(this.flickering=!1,this.flickercb=null):this.flickering||(this.flickercb=c,this.flickering=!0)},flipX:function(a){a!==this.lastflipX&&(this.lastflipX=a,this.scale.x=-this.scale.x,this.scaleFlag=1!==this.scale.x||1!==this.scale.y)},flipY:function(a){a!==this.lastflipY&&
(this.lastflipY=a,this.scale.y=-this.scale.y,this.scaleFlag=1!==this.scale.x||1!==this.scale.y)},resize:function(a){0<a&&(this.scale.x=0>this.scale.x?-a:a,this.scale.y=0>this.scale.y?-a:a,this.scaleFlag=1!==this.scale.x||1!==this.scale.y)},update:function(a){return this.flickering?(this.flickerDuration-=a,0>this.flickerDuration&&(this.flickercb&&this.flickercb(),this.flicker(-1)),!0):!1},draw:function(a){if(!this.flickering||(this.flickerState=!this.flickerState,this.flickerState)){a.save();a.globalAlpha*=
this.getOpacity();var c=~~this.pos.x,d=~~this.pos.y,b=this.width,e=this.height,g=this.angle+this._sourceAngle;if(this.scaleFlag||0!==g){var l=b*this.anchorPoint.x,k=e*this.anchorPoint.y;a.translate(c+l,d+k);this.scaleFlag&&a.scale(this.scale.x,this.scale.y);0!==g&&a.rotate(g);0!==this._sourceAngle?(b=this.height,e=this.width,c=-k,d=-l):(c=-l,d=-k)}a.drawImage(this.image,this.offset.x,this.offset.y,b,e,c,d,b,e);a.restore()}},destroy:function(){this.onDestroyEvent.apply(this,arguments)},onDestroyEvent:function(){}});
me.AnimationSheet=me.SpriteObject.extend({spacing:0,margin:0,animationpause:!1,animationspeed:100,init:function(a,c,d,b,e,g,l,k,n){this.anim={};this.current=this.resetAnim=null;this.animationspeed=100;this.spacing=g||0;this.margin=l||0;this.parent(a,c,d,b,e,g,l);this.atlasIndices=this.textureAtlas=null;this.buildLocalAtlas(k||void 0,n||void 0);this.addAnimation("default",null);this.setCurrentAnimation("default")},buildLocalAtlas:function(a,c){if(void 0!==a)this.textureAtlas=a,this.atlasIndices=c;
else{this.textureAtlas=[];for(var d=new me.Vector2d(~~((this.image.width-this.margin)/(this.width+this.spacing)),~~((this.image.height-this.margin)/(this.height+this.spacing))),b=0,e=d.x*d.y;e>b;b++)this.textureAtlas[b]={name:""+b,offset:new me.Vector2d(this.margin+(this.spacing+this.width)*(b%d.x),this.margin+(this.spacing+this.height)*~~(b/d.x)),width:this.width,height:this.height,hWidth:this.width/2,hHeight:this.height/2,angle:0}}},addAnimation:function(a,c,d){if(this.anim[a]={name:a,frame:[],
idx:0,length:0,animationspeed:d||this.animationspeed,nextFrame:0},null==c){c=[];var b=0;this.textureAtlas.forEach(function(){c[b]=b++})}d=0;for(var e=c.length;e>d;d++)if("number"==typeof c[d])this.anim[a].frame[d]=this.textureAtlas[c[d]];else{if(null===this.atlasIndices)throw"melonjs: string parameters for addAnimation are only allowed for TextureAtlas ";this.anim[a].frame[d]=this.textureAtlas[this.atlasIndices[c[d]]]}this.anim[a].length=this.anim[a].frame.length},setCurrentAnimation:function(a,c){if(!this.anim[a])throw"melonJS: animation id '"+
a+"' not defined";this.current=this.anim[a];this.resetAnim=c||null;this.setAnimationFrame(this.current.idx);this.current.nextFrame=this.current.animationspeed},isCurrentAnimation:function(a){return this.current.name===a},setAnimationFrame:function(a){this.current.idx=(a||0)%this.current.length;a=this.current.frame[this.current.idx];this.offset=a.offset;this.width=a.width;this.height=a.height;this.hWidth=a.hWidth;this.hHeight=a.hHeight;this._sourceAngle=a.angle},getCurrentAnimationFrame:function(){return this.current.idx},
update:function(a){if(!this.animationpause&&(this.current.nextFrame-=a,0>=this.current.nextFrame)){if(this.setAnimationFrame(++this.current.idx),0===this.current.idx&&this.resetAnim)if("string"==typeof this.resetAnim)this.setCurrentAnimation(this.resetAnim);else if("function"==typeof this.resetAnim&&!1===this.resetAnim())return this.current.idx=this.current.length-1,this.setAnimationFrame(this.current.idx),this.parent(a),!1;return this.current.nextFrame=this.current.animationspeed,this.parent(a)||
!0}return this.parent(a)}})})(window);
(function(){var a=-(Math.PI/2);me.TextureAtlas=Object.extend({format:null,texture:null,atlas:null,init:function(a,d){if(a&&a.meta){if(a.meta.app.contains("texturepacker"))if(this.format="texturepacker",void 0===d){var b=me.utils.getBasename(a.meta.image);if(this.texture=me.loader.getImage(b),null===this.texture)throw"melonjs: Atlas texture '"+b+"' not found";}else this.texture=d;if(a.meta.app.contains("ShoeBox")){if(!a.meta.exporter||!a.meta.exporter.contains("melonJS"))throw"melonjs: ShoeBox requires the JSON exporter : https://github.com/melonjs/melonJS/tree/master/media/shoebox_JSON_export.sbx";this.format=
"ShoeBox";this.texture=d}this.atlas=this.initFromTexturePacker(a)}if(null===this.atlas)throw"melonjs: texture atlas format not supported";},initFromTexturePacker:function(a){var d={};return a.frames.forEach(function(a){a.hasOwnProperty("filename")&&(d[a.filename]={frame:new me.Rect(new me.Vector2d(a.frame.x,a.frame.y),a.frame.w,a.frame.h),source:new me.Rect(new me.Vector2d(a.spriteSourceSize.x,a.spriteSourceSize.y),a.spriteSourceSize.w,a.spriteSourceSize.h),rotated:!0===a.rotated,trimmed:!0===a.trimmed})}),
d},getTexture:function(){return this.texture},getRegion:function(c){var d=this.atlas[c];return d?{name:c,pos:d.source.pos.clone(),offset:d.frame.pos.clone(),width:d.frame.width,height:d.frame.height,hWidth:d.frame.width/2,hHeight:d.frame.height/2,angle:!0===d.rotated?a:0}:null},createSpriteFromName:function(a){var d=this.getRegion(a);if(d)return a=new me.SpriteObject(0,0,this.getTexture(),d.width,d.height),a.offset.setV(d.offset),a._sourceAngle=d.angle,a;throw"melonjs: TextureAtlas - region for "+
a+" not found";},createAnimationFromName:function(a){for(var d=[],b={},e=0;e<a.length;++e)if(d[e]=this.getRegion(a[e]),b[a[e]]=e,null==d[e])throw"melonjs: TextureAtlas - region for "+a[e]+" not found";return new me.AnimationSheet(0,0,this.texture,0,0,0,0,d,b)}})})(window);
(function(){var a=Math.min,c=Math.max;me.Viewport=me.Renderable.extend({AXIS:{NONE:0,HORIZONTAL:1,VERTICAL:2,BOTH:3},bounds:null,deadzone:null,target:null,follow_axis:0,_shake:null,_fadeIn:null,_fadeOut:null,screenX:0,screenY:0,init:function(a,b,c,g){this.parent(new me.Vector2d(a,b),c-a,g-b);this.bounds=new me.Rect(new me.Vector2d(-1/0,-1/0),1/0,1/0);this.offset=new me.Vector2d;this.target=null;this.follow_axis=this.AXIS.NONE;this._shake={intensity:0,duration:0,axis:this.AXIS.BOTH,onComplete:null};
this._fadeOut={color:null,duration:0,tween:null};this._fadeIn={color:null,duration:0,tween:null};this.setDeadzone(this.width/6,this.height/6)},_followH:function(d){var b=this.pos.x;return d.x-this.pos.x>this.deadzone.right?this.pos.x=~~a(d.x-this.deadzone.right,this.bounds.width-this.width):d.x-this.pos.x<this.deadzone.pos.x&&(this.pos.x=~~c(d.x-this.deadzone.pos.x,this.bounds.pos.x)),b!==this.pos.x},_followV:function(d){var b=this.pos.y;return d.y-this.pos.y>this.deadzone.bottom?this.pos.y=~~a(d.y-
this.deadzone.bottom,this.bounds.height-this.height):d.y-this.pos.y<this.deadzone.pos.y&&(this.pos.y=~~c(d.y-this.deadzone.pos.y,this.bounds.pos.y)),b!==this.pos.y},reset:function(a,b){this.pos.x=a||0;this.pos.y=b||0;this.follow_axis=this.target=null},setDeadzone:function(a,b){null===this.deadzone&&(this.deadzone=new me.Rect(new me.Vector2d,0,0));this.deadzone.pos.set(~~((this.width-a)/2),~~((this.height-b)/2-0.25*b));this.deadzone.resize(a,b);this.updateTarget()},setBounds:function(a,b,c,g){this.bounds.pos.set(a,
b);this.bounds.resize(c,g)},follow:function(a,b){if(a instanceof me.ObjectEntity)this.target=a.pos;else{if(!(a instanceof me.Vector2d))throw"melonJS: invalid target for viewport.follow";this.target=a}this.follow_axis="undefined"==typeof b?this.AXIS.BOTH:b;this.updateTarget()},move:function(a,b){this.moveTo(~~(this.pos.x+a),~~(this.pos.y+b))},moveTo:function(a,b){this.pos.x=(~~a).clamp(this.bounds.pos.x,this.bounds.width-this.width);this.pos.y=(~~b).clamp(this.bounds.pos.y,this.bounds.height-this.height);
me.event.publish(me.event.VIEWPORT_ONCHANGE,[this.pos])},updateTarget:function(){var a=!1;if(this.target)switch(this.follow_axis){case this.AXIS.HORIZONTAL:a=this._followH(this.target);break;case this.AXIS.VERTICAL:a=this._followV(this.target);break;case this.AXIS.BOTH:a=this._followH(this.target),a=this._followV(this.target)||a}return a},update:function(a){var b=this.updateTarget();return 0<this._shake.duration&&(this._shake.duration-=a,0>=this._shake.duration?(this._shake.duration=0,this.offset.setZero(),
"function"==typeof this._shake.onComplete&&this._shake.onComplete()):((this._shake.axis===this.AXIS.BOTH||this._shake.axis===this.AXIS.HORIZONTAL)&&(this.offset.x=(Math.random()-0.5)*this._shake.intensity),(this._shake.axis===this.AXIS.BOTH||this._shake.axis===this.AXIS.VERTICAL)&&(this.offset.y=(Math.random()-0.5)*this._shake.intensity)),b=!0),!0===b&&me.event.publish(me.event.VIEWPORT_ONCHANGE,[this.pos]),(null!=this._fadeIn.tween||null!=this._fadeOut.tween)&&(b=!0),b},shake:function(a,b,c,g){0<
this._shake.duration||(this._shake={intensity:a,duration:b,axis:c||this.AXIS.BOTH,onComplete:g})},fadeOut:function(a,b,c){this._fadeOut.color=me.pool.pull("me.Color").parseHex(a);this._fadeOut.color.alpha=1;this._fadeOut.duration=b||1E3;this._fadeOut.tween=me.pool.pull("me.Tween",this._fadeOut.color).to({alpha:0},this._fadeOut.duration).onComplete(c||null);this._fadeOut.tween.start()},fadeIn:function(a,b,c){this._fadeIn.color=me.pool.pull("me.Color").parseHex(a);this._fadeIn.color.alpha=0;this._fadeIn.duration=
b||1E3;this._fadeIn.tween=me.pool.pull("me.Tween",this._fadeIn.color).to({alpha:1},this._fadeIn.duration).onComplete(c||null);this._fadeIn.tween.start()},getWidth:function(){return this.width},getHeight:function(){return this.height},focusOn:function(a){var b=a.getBounds();this.moveTo(a.pos.x+b.pos.x+b.hWidth,a.pos.y+b.pos.y+b.hHeight)},isVisible:function(a){return a.overlaps(this)},localToWorld:function(a,b){return(new me.Vector2d(a,b)).add(this.pos).sub(me.game.currentLevel.pos)},worldToLocal:function(a,
b){return(new me.Vector2d(a,b)).sub(this.pos).add(me.game.currentLevel.pos)},draw:function(a){this._fadeIn.tween&&(me.video.clearSurface(a,this._fadeIn.color.toRGBA()),1===this._fadeIn.color.alpha&&(this._fadeIn.tween=null,me.pool.push(this._fadeIn.color),this._fadeIn.color=null));this._fadeOut.tween&&(me.video.clearSurface(a,this._fadeOut.color.toRGBA()),0===this._fadeOut.color.alpha&&(this._fadeOut.tween=null,me.pool.push(this._fadeOut.color),this._fadeOut.color=null))}})})(window);
(function(){me.GUI_Object=me.SpriteObject.extend({isClickable:!0,updated:!1,init:function(a,c,d){this.parent(a,c,"string"==typeof d.image?me.loader.getImage(d.image):d.image,d.spritewidth,d.spriteheight);this.floating=!0;me.input.registerPointerEvent("mousedown",this,this.clicked.bind(this))},update:function(){return this.updated?(this.updated=!1,!0):!1},clicked:function(a){return this.isClickable?(this.updated=!0,this.onClick(a)):void 0},onClick:function(){return!1},onDestroyEvent:function(){me.input.releasePointerEvent("mousedown",
this)}})})(window);
(function(){var a=function(a,c){a.ancestor&&a.ancestor.removeChildNow(a,c)},c=new me.Rect(new me.Vector2d,0,0),d=0;me.ObjectContainer=me.Renderable.extend({sortOn:"z",autoSort:!0,pendingSort:null,children:null,bounds:null,collidable:!0,transform:new me.Matrix2d,init:function(a,c,d,l){this.parent(new me.Vector2d(a||0,c||0),d||1/0,l||1/0);this.bounds=new me.Rect(new me.Vector2d(0,0),0,0);this.children=[];this.sortOn=me.game.sortOn;this.autoSort=!0;this.transform.identity()},addChild:function(a,c){"undefined"!=
typeof a.ancestor?a.ancestor.removeChildNow(a):a.isRenderable&&(a.GUID=me.utils.createGUID());"number"==typeof c&&(a.z=c);"undefined"==typeof a.z&&(a.z=1/0);a.ancestor=this;this.children.push(a);!0===this.autoSort&&this.sort()},addChildAt:function(a,c){if(!(0<=c&&c<this.children.length))throw"melonJS (me.ObjectContainer): Index ("+c+") Out Of Bounds for addChildAt()";"undefined"!=typeof a.ancestor?a.ancestor.removeChildNow(a):a.isRenderable&&(a.GUID=me.utils.createGUID());a.ancestor=this;this.children.splice(c,
0,a)},swapChildren:function(a,c){var d=this.getChildIndex(a),l=this.getChildIndex(c);if(-1===d||-1===l)throw"melonJS (me.ObjectContainer): "+a+" Both the supplied childs must be a child of the caller "+this;var k=a.z;a.z=c.z;c.z=k;this.children[d]=c;this.children[l]=a},getChildAt:function(a){if(0<=a&&a<this.children.length)return this.children[a];throw"melonJS (me.ObjectContainer): Index ("+a+") Out Of Bounds for getChildAt()";},getChildIndex:function(a){return this.children.indexOf(a)},hasChild:function(a){return this===
a.ancestor},getChildByProp:function(a,c){function d(a,b){"string"==typeof a[b]?a[b].match(n)&&k.push(a):a[b]===c&&k.push(a)}for(var l,k=[],n=RegExp(c,"i"),s=this.children.length;s--,l=this.children[s];)l instanceof me.ObjectContainer?(d(l,a),k=k.concat(l.getChildByProp(a,c))):d(l,a);return k},getChildByName:function(a){return this.getChildByProp("name",a)},getChildByGUID:function(a){a=this.getChildByProp("GUID",a);return 0<a.length?a[0]:null},getBounds:function(a){a="undefined"!=typeof a?a:this.bounds;
a.pos.set(1/0,1/0);a.resize(-1/0,-1/0);for(var c,d,l=this.children.length;l--,d=this.children[l];)d.isRenderable&&d.visible&&(c=d.getBounds(),null!==c&&a.union(c));return a},removeChild:function(b,c){b.ancestor&&a.defer(this,b,c)},removeChildNow:function(a,c){if(!this.hasChild(a))throw"melonJS (me.ObjectContainer): "+a+" The supplied child must be a child of the caller "+this;a.ancestor=void 0;c||("function"==typeof a.destroy&&a.destroy(),me.pool.push(a));this.children.splice(this.getChildIndex(a),
1)},setChildsProperty:function(a,c,d){for(var l,k=this.children.length;k--,l=this.children[k];)!0===d&&l instanceof me.ObjectContainer&&l.setChildsProperty(a,c,d),l[a]=c},moveUp:function(a){var c=this.getChildIndex(a);0<=c-1&&this.swapChildren(a,this.getChildAt(c-1))},moveDown:function(a){var c=this.getChildIndex(a);c+1<this.children.length&&this.swapChildren(a,this.getChildAt(c+1))},moveToTop:function(a){var c=this.getChildIndex(a);0<c&&(this.splice(0,0,this.splice(c,1)[0]),a.z=this.children[1].z+
1)},moveToBottom:function(a){var c=this.getChildIndex(a);c<this.children.length-1&&(this.splice(this.children.length-1,0,this.splice(c,1)[0]),a.z=this.children[this.children.length-2].z-1)},collide:function(a,c){return this.collideType(a,null,c)},collideType:function(a,c,d){var l,k;d=!0===d?!0:!1;!0===d&&(k=[]);for(var n,s=this.children.length;s--,n=this.children[s];)if((n.inViewport||n.alwaysUpdate)&&n.collidable)if(n instanceof me.ObjectContainer)if(l=n.collideType(a,c,d),d)k.concat(l);else{if(l)return l}else if(n!==
a&&(!c||n.type===c)&&(this._boundsA=n.getBounds(this._boundsA).translateV(n.pos),this._boundsB=a.getBounds(this._boundsB).translateV(a.pos),l=this._boundsA["collideWith"+this._boundsB.shapeType].call(this._boundsA,this._boundsB),0!==l.x||0!==l.y)){if(n.onCollision.call(n,l,a),l.type=n.type,l.obj=n,!d)return l;k.push(l)}return d?k:null},sort:function(a){if(null===this.pendingSort){if(!0===a)for(var c,d=this.children.length;d--,c=this.children[d];)c instanceof me.ObjectContainer&&c.sort(a);this.pendingSort=
function(a){a.children.sort(a["_sort"+a.sortOn.toUpperCase()]);a.pendingSort=null;me.game.repaint()}.defer(this,this)}},_sortZ:function(a,c){return c.z-a.z},_sortX:function(a,c){var d=c.z-a.z;return d?d:(c.pos&&c.pos.x)-(a.pos&&a.pos.x)||0},_sortY:function(a,c){var d=c.z-a.z;return d?d:(c.pos&&c.pos.y)-(a.pos&&a.pos.y)||0},destroy:function(){this.pendingSort&&(clearTimeout(this.pendingSort),this.pendingSort=null);for(var a,c=this.children.length;c--,a=this.children[c];)a.isPersistent||this.removeChildNow(a);
this.transform.identity()},update:function(a){for(var e,g,l,k,n=!1,s=!1,u=me.state.isPaused(),t=me.game.viewport,r=this.children.length;r--,k=this.children[r];)(!u||k.updateWhenPaused)&&(k.isRenderable?(s=0<d||k.floating,s&&d++,e=k.visible&&!s,e&&(g=k.pos.x,l=k.pos.y,c.translateV(k.pos),c.resize(k.width,k.height)),k.inViewport=k.visible&&(s||t.isVisible(c)),n|=(k.inViewport||k.alwaysUpdate)&&k.update(a),e&&c.translate(-g,-l),0<d&&d--):n|=k.update(a));return n},draw:function(a,c){var d=me.game.viewport,
l=!1;this.drawCount=0;a.save();a.transform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.e,this.transform.f);a.globalAlpha*=this.getOpacity();a.translate(this.pos.x,this.pos.y);for(var k,n=this.children.length;n--,k=this.children[n];)l=k.floating,(k.inViewport||l&&k.visible)&&k.isRenderable&&(!0===l&&(a.save(),a.translate(d.screenX-this.pos.x,d.screenY-this.pos.y)),k.draw(a,c),!0===l&&a.restore(),this.drawCount++);a.restore()}})})(window);
(function(){me.ObjectSettings={name:null,image:null,transparent_color:null,spritewidth:null,spriteheight:null,type:0,collidable:!0};me.ObjectEntity=me.Renderable.extend({type:0,collidable:!0,shapes:[],shapeIndex:0,renderable:null,lastflipX:!1,lastflipY:!1,init:function(a,c,d){if(this.parent(this.pos.set(a,c),d.width,d.height),d.image)a="string"==typeof d.image?me.loader.getImage(d.image):d.image,this.renderable=new me.AnimationSheet(0,0,a,~~d.spritewidth,~~d.spriteheight,~~d.spacing,~~d.margin),d.transparent_color&&
this.renderable.setTransparency(d.transparent_color);this.name=d.name?d.name.toLowerCase():"";void 0===this.vel&&(this.vel=new me.Vector2d);this.vel.set(0,0);void 0===this.accel&&(this.accel=new me.Vector2d);this.accel.set(0,0);void 0===this.friction&&(this.friction=new me.Vector2d);this.friction.set(0,0);void 0===this.maxVel&&(this.maxVel=new me.Vector2d);this.maxVel.set(1E3,1E3);this.gravity=void 0!==me.sys.gravity?me.sys.gravity:0.98;this.alive=!0;this.falling=!1;this.jumping=!0;this.slopeY=0;
this.disableTopLadderCollision=this.onladder=this.onslope=!1;this.collidable="undefined"!=typeof d.collidable?d.collidable:!0;this.type=d.type||0;this.lastflipX=this.lastflipY=!1;this.collisionMap=me.game.collisionMap;this.canBreakTile=!1;this.onTileBreak=null;"function"==typeof d.getShape&&(this.addShape(d.getShape()),"PolyShape"===this.getShape().shapeType&&(this._bounds=this.getBounds(),this.resize(this._bounds.width,this._bounds.height)))},addShape:function(a){this.shapes.push(a)},getShape:function(){return this.shapes[this.shapeIndex]},
setShape:function(a){if("undefined"!=typeof this.shapes[a])return void(this.shapeIndex=a);throw"melonJS (me.Entity): Shape ("+a+") not defined";},onCollision:function(){this.collidable&&this.type===me.game.COLLECTABLE_OBJECT&&me.game.world.removeChild(this)},setVelocity:function(a,c){this.accel.x=0!==a?a:this.accel.x;this.accel.y=0!==c?c:this.accel.y;this.setMaxVelocity(a,c)},setMaxVelocity:function(a,c){this.maxVel.x=a;this.maxVel.y=c},setFriction:function(a,c){this.friction.x=a||0;this.friction.y=
c||0},flipX:function(a){a!==this.lastflipX&&(this.lastflipX=a,this.renderable&&this.renderable.flipX&&this.renderable.flipX(a),this.getShape().flipX&&this.getShape().flipX(this.width))},flipY:function(a){a!==this.lastflipY&&(this.lastflipY=a,this.renderable&&this.renderable.flipY&&this.renderable.flipY(a),this.getShape().flipY&&this.getShape().flipY(this.height))},distanceTo:function(a){var c=this.pos.x+this.hWidth-(a.pos.x+a.hWidth);a=this.pos.y+this.hHeight-(a.pos.y+a.hHeight);return Math.sqrt(c*
c+a*a)},distanceToPoint:function(a){var c=this.pos.x+this.hWidth-a.x;a=this.pos.y+this.hHeight-a.y;return Math.sqrt(c*c+a*a)},angleTo:function(a){return Math.atan2(a.pos.y+a.hHeight-(this.pos.y+this.hHeight),a.pos.x+a.hWidth-(this.pos.x+this.hWidth))},angleToPoint:function(a){return Math.atan2(a.y-(this.pos.y+this.hHeight),a.x-(this.pos.x+this.hWidth))},checkSlope:function(a,c,d){a.pos.y=c.pos.y-a.height;this.slopeY=d?c.height-(a.right+this.vel.x-c.pos.x):a.left+this.vel.x-c.pos.x;this.vel.y=0;a.pos.y+=
this.slopeY.clamp(0,c.height)},computeVelocity:function(a){this.gravity&&(a.y+=this.onladder?0:this.gravity*me.timer.tick,this.falling=0<a.y,this.jumping=this.falling?!1:this.jumping);this.friction.x&&(a.x=me.utils.applyFriction(a.x,this.friction.x));this.friction.y&&(a.y=me.utils.applyFriction(a.y,this.friction.y));0!==a.y&&(a.y=a.y.clamp(-this.maxVel.y,this.maxVel.y));0!==a.x&&(a.x=a.x.clamp(-this.maxVel.x,this.maxVel.x))},updateMovement:function(){this.computeVelocity(this.vel);var a;return this.collidable&&
(this._bounds=this.getBounds(this._bounds),this.__offsetX=this._bounds.pos.x,this.__offsetY=this._bounds.pos.y,this._bounds.translateV(this.pos),a=this.collisionMap.checkCollision(this._bounds,this.vel),this.onslope=a.yprop.isSlope||a.xprop.isSlope,this.onladder=!1,a.y&&(this.onladder=a.yprop.isLadder||a.yprop.isTopLadder,0<a.y?a.yprop.isSolid||a.yprop.isPlatform&&this._bounds.bottom-1<=a.ytile.pos.y||a.yprop.isTopLadder&&!this.disableTopLadderCollision?(this._bounds.pos.y=~~this._bounds.pos.y,this.vel.y=
this.falling?a.ytile.pos.y-this._bounds.bottom:0,this.falling=!1):a.yprop.isSlope&&!this.jumping?(this.checkSlope(this._bounds,a.ytile,a.yprop.isLeftSlope),this.falling=!1):a.yprop.isBreakable&&(this.canBreakTile?(me.game.currentLevel.clearTile(a.ytile.col,a.ytile.row),this.onTileBreak&&this.onTileBreak()):(this.collision.pos.y=~~this.collision.pos.y,this.vel.y=this.falling?a.ytile.pos.y-this._bounds.bottom:0,this.falling=!1)):0>a.y&&(a.yprop.isPlatform||a.yprop.isLadder||a.yprop.isTopLadder||(this.falling=
!0,this.vel.y=0))),a.x&&(this.onladder=a.xprop.isLadder||a.yprop.isTopLadder,a.xprop.isSlope&&!this.jumping?(this.checkSlope(this._bounds,a.xtile,a.xprop.isLeftSlope),this.falling=!1):a.xprop.isPlatform||a.xprop.isLadder||a.xprop.isTopLadder||(a.xprop.isBreakable&&this.canBreakTile?(me.game.currentLevel.clearTile(a.xtile.col,a.xtile.row),this.onTileBreak&&this.onTileBreak()):this.vel.x=0)),this.pos.set(this._bounds.pos.x-this.__offsetX,this._bounds.pos.y-this.__offsetY)),this.pos.add(this.vel),a},
collide:function(a){return me.game.collide(this,a||!1)},collideType:function(a,c){return me.game.collideType(this,a,c||!1)},update:function(a){return this.renderable?this.renderable.update(a):!1},getBounds:function(a){return this.shapes.length?this.getShape().getBounds(a):this.parent(a).translate(-this.pos.x,-this.pos.y)},draw:function(a){if(this.renderable){var c=this;this.shapes.length&&"PolyShape"===this.getShape().shapeType&&(c=this.getBounds(this._bounds).translateV(this.pos));var d=~~(c.pos.x+
this.anchorPoint.x*(c.width-this.renderable.width)),c=~~(c.pos.y+this.anchorPoint.y*(c.height-this.renderable.height));a.translate(d,c);this.renderable.draw(a);a.translate(-d,-c)}},destroy:function(){this.renderable&&(this.renderable.destroy.apply(this.renderable,arguments),this.renderable=null);this.onDestroyEvent.apply(this,arguments);this.shapes=[];this.shapeIndex=0},onDestroyEvent:function(){}});me.CollectableEntity=me.ObjectEntity.extend({init:function(a,c,d){this.parent(a,c,d);this.type=me.game.COLLECTABLE_OBJECT}});
me.LevelEntity=me.ObjectEntity.extend({init:function(a,c,d){this.parent(a,c,d);this.nextlevel=d.to;this.fade=d.fade;this.duration=d.duration;this.fading=!1;this.gotolevel=d.to},onFadeComplete:function(){me.levelDirector.loadLevel(this.gotolevel);me.game.viewport.fadeOut(this.fade,this.duration)},goTo:function(a){this.gotolevel=a||this.nextlevel;this.fade&&this.duration?this.fading||(this.fading=!0,me.game.viewport.fadeIn(this.fade,this.duration,this.onFadeComplete.bind(this))):me.levelDirector.loadLevel(this.gotolevel)},
onCollision:function(){this.goTo()}})})(window);
(function(a){me.ScreenObject=me.Renderable.extend({init:function(){this.parent(new me.Vector2d(0,0),0,0)},reset:function(){me.game.reset();this.onResetEvent.apply(this,arguments)},destroy:function(){this.onDestroyEvent.apply(this,arguments)},onResetEvent:function(){},onDestroyEvent:function(){}});(function(){for(var a=0,d=["ms","moz","webkit","o"],b=window.requestAnimationFrame,e=window.cancelAnimationFrame,g=0;g<d.length&&(!b||!e);++g)b=window[d[g]+"RequestAnimationFrame"],e=window[d[g]+"CancelAnimationFrame"]||
window[d[g]+"CancelRequestAnimationFrame"];b&&e||(b=function(b){var d=window.performance.now(),e=Math.max(0,16-(d-a)),g=window.setTimeout(function(){b(d+e)},e);return a=d+e,g},e=function(a){window.clearTimeout(a)});window.requestAnimationFrame=b;window.cancelAnimationFrame=e})();me.state=function(){function c(){-1===l&&-1!==g&&(me.timer.reset(),l=window.requestAnimationFrame(d))}function d(a){me.game.update(a);me.game.draw();-1!==l&&(l=window.requestAnimationFrame(d))}function b(a){window.cancelAnimationFrame(l);
l=-1;n[g]&&n[g].screen.destroy();n[a]&&(g=a,n[g].screen.reset.apply(n[g].screen,r),c(),t&&t(),me.game.repaint())}var e={},g=-1,l=-1,k=!1,n={},s="",u=0,t=null,r=null,h=0;return e.LOADING=0,e.MENU=1,e.READY=2,e.PLAY=3,e.GAMEOVER=4,e.GAME_END=5,e.SCORE=6,e.CREDITS=7,e.SETTINGS=8,e.USER=100,e.onPause=null,e.onResume=null,e.onStop=null,e.onRestart=null,e.init=function(){e.set(e.LOADING,new me.DefaultLoadingScreen);a.addEventListener("blur",function(){g!==e.LOADING&&(me.sys.stopOnBlur&&(e.stop(!0),e.onStop&&
e.onStop()),me.sys.pauseOnBlur&&(e.pause(!0),e.onPause&&e.onPause()))},!1);a.addEventListener("focus",function(){g!==e.LOADING&&(me.sys.resumeOnFocus&&(e.resume(!0),e.onResume&&e.onResume()),me.sys.stopOnBlur&&(e.restart(!0),me.game.repaint(),e.onRestart&&e.onRestart()))},!1)},e.stop=function(a){window.cancelAnimationFrame(l);l=-1;a&&me.audio.pauseTrack();h=window.performance.now();me.event.publish(me.event.STATE_STOP)},e.pause=function(a){k=!0;a&&me.audio.pauseTrack();h=window.performance.now();
me.event.publish(me.event.STATE_PAUSE)},e.restart=function(a){c();a&&me.audio.resumeTrack();h=window.performance.now()-h;me.event.publish(me.event.STATE_RESTART,[h])},e.resume=function(a){k&&-1!==g&&(me.timer.reset(),k=!1);a&&me.audio.resumeTrack();h=window.performance.now()-h;me.event.publish(me.event.STATE_RESUME,[h])},e.isRunning=function(){return-1!==l},e.isPaused=function(){return k},e.set=function(a,b){n[a]={};n[a].screen=b;n[a].transition=!0},e.current=function(){return n[g].screen},e.transition=
function(a,b,c){"fade"===a&&(s=b,u=c)},e.setTransition=function(a,b){n[a].transition=b},e.change=function(a){if("undefined"==typeof n[a])throw"melonJS : Undefined ScreenObject for state '"+a+"'";r=null;1<arguments.length&&(r=Array.prototype.slice.call(arguments,1));u&&n[a].transition?(t=function(){me.game.viewport.fadeOut(s,u)},me.game.viewport.fadeIn(s,u,function(){b.defer(this,a)})):b.defer(this,a)},e.isCurrent=function(a){return g===a},e}()})(window);
(function(){var a=me.Renderable.extend({invalidate:!1,barHeight:4,progress:0,onProgressUpdate:function(a){this.progress=Math.floor(a*this.width);this.invalidate=!0},update:function(){return!0===this.invalidate?(this.invalidate=!1,!0):!1},draw:function(a){a.fillStyle="black";a.fillRect(0,this.height/2-this.barHeight/2,this.width,this.barHeight);a.fillStyle="#55aa00";a.fillRect(2,this.height/2-this.barHeight/2,this.progress,this.barHeight)}}),c=me.Renderable.extend({init:function(a,c){this.parent(new me.Vector2d(a,
c),100,85)},draw:function(a){a.save();a.translate(this.pos.x,this.pos.y);a.beginPath();a.moveTo(0.7,48.9);a.bezierCurveTo(10.8,68.9,38.4,75.8,62.2,64.5);a.bezierCurveTo(86.1,53.1,97.2,27.7,87,7.7);a.lineTo(87,7.7);a.bezierCurveTo(89.9,15.4,73.9,30.2,50.5,41.4);a.bezierCurveTo(27.1,52.5,5.2,55.8,0.7,48.9);a.lineTo(0.7,48.9);a.lineTo(0.7,48.9);a.closePath();a.fillStyle="rgb(255, 255, 255)";a.fill();a.beginPath();a.moveTo(84,7);a.bezierCurveTo(87.6,14.7,72.5,30.2,50.2,41.6);a.bezierCurveTo(27.9,53,6.9,
55.9,3.2,48.2);a.bezierCurveTo(-0.5,40.4,14.6,24.9,36.9,13.5);a.bezierCurveTo(59.2,2.2,80.3,-0.8,84,7);a.lineTo(84,7);a.closePath();a.lineWidth=5.3;a.strokeStyle="rgb(255, 255, 255)";a.lineJoin="miter";a.miterLimit=4;a.stroke();a.restore()}}),d=me.Renderable.extend({init:function(a,c){this.parent(new me.Vector2d,a,c);this.logo1=new me.Font("century gothic",32,"white","middle");this.logo2=new me.Font("century gothic",32,"#55aa00","middle");this.logo2.bold();this.logo1.textBaseline=this.logo2.textBaseline=
"alphabetic"},draw:function(a){var c=this.logo1.measureText(a,"melon").width,d=(this.width-c-this.logo2.measureText(a,"JS").width)/2,l=this.height/2+this.logo2.measureText(a,"melon").height;this.logo1.draw(a,"melon",d,l);this.logo2.draw(a,"JS",d+c,l)}});me.DefaultLoadingScreen=me.ScreenObject.extend({onResetEvent:function(){me.game.reset();me.game.world.addChild(new me.ColorLayer("background","#202020",0));var b=new a(new me.Vector2d,me.video.getWidth(),me.video.getHeight());this.handle=me.event.subscribe(me.event.LOADER_PROGRESS,
b.onProgressUpdate.bind(b));me.game.world.addChild(b,1);b=new c((me.video.getWidth()-100)/2,me.video.getHeight()/2-b.barHeight/2-90);me.game.world.addChild(b,1);me.game.world.addChild(new d(me.video.getWidth(),me.video.getHeight()),1)},onDestroyEvent:function(){this.handle&&(me.event.unsubscribe(this.handle),this.handle=null)}})})(window);
(function(){me.loader=function(){function a(){u===s?e.onload?(clearTimeout(t),setTimeout(function(){e.onload();me.event.publish(me.event.LOADER_COMPLETE)},300)):console.error("no load callback defined"):t=setTimeout(a,100)}function c(a,b,c){function d(b,c){l[a.name]={data:b,isTMX:"tmx"===a.type,format:c}}if("tmx"===a.type&&me.levelDirector.addTMXLevel(a.name),a.data)return d(a.data,a.format),void b();var g=new XMLHttpRequest,k=me.utils.getFileExtension(a.src).toLowerCase();g.overrideMimeType&&g.overrideMimeType("json"===
k?"application/json":"text/xml");g.open("GET",a.src+e.nocache,!0);g.ontimeout=c;g.onreadystatechange=function(){if(4===g.readyState)if(200===g.status||0===g.status&&g.responseText){var a=null;switch(k){case "xml":case "tmx":a=me.device.ua.match(/msie/i)||!g.responseXML?(new DOMParser).parseFromString(g.responseText,"text/xml"):g.responseXML;k="xml";break;case "json":a=JSON.parse(g.responseText);break;default:throw"melonJS: TMX file format "+k+"not supported !";}d(a,k);b()}else c()};g.send(null)}function d(a,
b,c){var d=new XMLHttpRequest;d.overrideMimeType&&d.overrideMimeType("application/json");d.open("GET",a.src+e.nocache,!0);d.ontimeout=c;d.onreadystatechange=function(){4===d.readyState&&(200===d.status||0===d.status&&d.responseText?(n[a.name]=JSON.parse(d.responseText),b()):c())};d.send(null)}function b(a,b,c){var d=new XMLHttpRequest;d.open("GET",a.src+e.nocache,!0);d.responseType="arraybuffer";d.onerror=c;d.onload=function(){var c=d.response;if(c){for(var c=new Uint8Array(c),e=[],g=0;g<c.byteLength;g++)e[g]=
String.fromCharCode(c[g]);k[a.name]=e.join("");b()}};d.send()}var e={},g={},l={},k={},n={},s=0,u=0,t=0;return e.nocache="",e.onload=void 0,e.onProgress=void 0,e.onResourceLoaded=function(a){u++;var b=e.getLoadProgress();e.onProgress&&e.onProgress(b,a);me.event.publish(me.event.LOADER_PROGRESS,[b,a])},e.onLoadingError=function(a){throw"melonJS: Failed loading resource "+a.src;},e.setNocache=function(a){e.nocache=a?"?"+parseInt(1E7*Math.random(),10):""},e.preload=function(b){for(var c=0;c<b.length;c++)s+=
e.load(b[c],e.onResourceLoaded.bind(e,b[c]),e.onLoadingError.bind(e,b[c]));a()},e.load=function(a,h,m){switch(a.name=a.name.toLowerCase(),a.type){case "binary":return b.call(this,a,h,m),1;case "image":return g[a.name]=new Image,g[a.name].onload=h,g[a.name].onerror=m,g[a.name].src=a.src+e.nocache,1;case "json":return d.call(this,a,h,m),1;case "tmx":case "tsx":return c.call(this,a,h,m),1;case "audio":return me.audio.load(a,h,m),1;default:throw"melonJS: me.loader.load : unknown or invalid resource type : "+
a.type;}},e.unload=function(a){switch(a.name=a.name.toLowerCase(),a.type){case "binary":return a.name in k?(delete k[a.name],!0):!1;case "image":return a.name in g?("function"==typeof g[a.name].dispose&&g[a.name].dispose(),delete g[a.name],!0):!1;case "json":return a.name in n?(delete n[a.name],!0):!1;case "tmx":case "tsx":return a.name in l?(delete l[a.name],!0):!1;case "audio":return me.audio.unload(a.name);default:throw"melonJS: me.loader.unload : unknown or invalid resource type : "+a.type;}},
e.unloadAll=function(){for(var a in k)e.unload({name:a,type:"binary"});for(a in g)e.unload({name:a,type:"image"});for(a in l)e.unload({name:a,type:"tmx"});for(a in n)e.unload({name:a,type:"json"});me.audio.unloadAll()},e.getTMXFormat=function(a){return a=a.toLowerCase(),a in l?l[a].format:null},e.getTMX=function(a){return a=a.toLowerCase(),a in l?l[a].data:null},e.getBinary=function(a){return a=a.toLowerCase(),a in k?k[a]:null},e.getImage=function(a){return a=a.toLowerCase(),a in g?g[a]:null},e.getJSON=
function(a){return a=a.toLowerCase(),a in n?n[a]:null},e.getLoadProgress=function(){return u/s},e}()})(window);
(function(){me.Font=me.Renderable.extend({font:new me.Vector2d,fontSize:new me.Vector2d,fillStyle:"#000000",strokeStyle:"#000000",lineWidth:1,textAlign:"left",textBaseline:"top",lineHeight:1,init:function(a,c,d,b){this.setFont(a,c,d,b);this.parent(this.pos,0,this.fontSize.y)},bold:function(){this.font="bold "+this.font},italic:function(){this.font="italic "+this.font},setFont:function(a,c,d,b){a=a.split(",").map(function(a){return a=a.trim(),/(^".*"$)|(^'.*'$)/.test(a)?a:'"'+a+'"'});this.fontSize.y=
parseInt(c,10);this.height=this.fontSize.y;"number"==typeof c&&(c+="px");this.font=c+" "+a.join(",");this.fillStyle=d;b&&(this.textAlign=b)},measureText:function(a,c){a.font=this.font;a.fillStyle=this.fillStyle;a.textAlign=this.textAlign;a.textBaseline=this.textBaseline;this.height=this.width=0;for(var d=(""+c).split("\n"),b=0;b<d.length;b++)this.width=Math.max(a.measureText(d[b].trimRight()).width,this.width),this.height+=this.fontSize.y*this.lineHeight;return{width:this.width,height:this.height}},
draw:function(a,c,d,b){this.pos.set(d,b);a.font=this.font;a.fillStyle=this.fillStyle;a.textAlign=this.textAlign;a.textBaseline=this.textBaseline;c=(""+c).split("\n");for(var e=0;e<c.length;e++)a.fillText(c[e].trimRight(),~~d,~~b),b+=this.fontSize.y*this.lineHeight},drawStroke:function(a,c,d,b){this.pos.set(d,b);a.font=this.font;a.fillStyle=this.fillStyle;a.strokeStyle=this.strokeStyle;a.lineWidth=this.lineWidth;a.textAlign=this.textAlign;a.textBaseline=this.textBaseline;c=(""+c).split("\n");for(var e=
0;e<c.length;e++){var g=c[e].trimRight();a.strokeText(g,~~d,~~b);a.fillText(g,~~d,~~b);b+=this.fontSize.y*this.lineHeight}}});me.BitmapFont=me.Font.extend({sSize:new me.Vector2d,firstChar:32,charCount:0,init:function(a,c,d,b){this.parent(a,null,null);this.firstChar=b||32;this.loadFontMetrics(a,c);this.textAlign="left";this.textBaseline="top";d&&this.resize(d)},loadFontMetrics:function(a,c){this.font=me.loader.getImage(a);this.fontSize.x=c.x||c;this.fontSize.y=c.y||this.font.height;this.sSize.copy(this.fontSize);
this.height=this.sSize.y;this.charCount=~~(this.font.width/this.fontSize.x)},set:function(a,c){this.textAlign=a;c&&this.resize(c)},resize:function(a){this.sSize.setV(this.fontSize);this.sSize.x*=a;this.sSize.y*=a;this.height=this.sSize.y},measureText:function(a,c){for(var d=(""+c).split("\n"),b=this.height=this.width=0;b<d.length;b++)this.width=Math.max(d[b].trimRight().length*this.sSize.x,this.width),this.height+=this.sSize.y*this.lineHeight;return{width:this.width,height:this.height}},draw:function(a,
c,d,b){c=(""+c).split("\n");var e=d,g=this.sSize.y*this.lineHeight;this.pos.set(d,b);for(var l=0;l<c.length;l++){d=e;var k=c[l].trimRight(),n=k.length*this.sSize.x;switch(this.textAlign){case "right":d-=n;break;case "center":d-=0.5*n}switch(this.textBaseline){case "middle":b-=0.5*g;break;case "ideographic":case "alphabetic":case "bottom":b-=g}for(var n=0,s=k.length;s>n;n++){var u=k.charCodeAt(n)-this.firstChar;0<=u&&a.drawImage(this.font,this.fontSize.x*(u%this.charCount),this.fontSize.y*~~(u/this.charCount),
this.fontSize.x,this.fontSize.y,~~d,~~b,this.sSize.x,this.sSize.y);d+=this.sSize.x}b+=g}}})})(window);
(function(){me.audio=function(){function a(a,b){if(3<l++){var c="melonJS: failed loading "+a;if(!1!==me.sys.stopOnAudioError)throw c;me.audio.disable();b&&b();console.log(c+", disabling audio")}else d[a].load()}var c={},d={},b={},e=null,g=null,l=0,k=!1,n=[];return c.init=function(a){if(!me.initialized)throw"melonJS: me.audio.init() called before engine initialization.";this.audioFormats=("string"==typeof a?a:"mp3").split(",")},c.enable=function(){this.unmuteAll()},c.disable=function(){this.muteAll()},
c.load=function(e,g,t){if(me.device.isMobile&&!navigator.isCocoonJS){if(k)return void n.push([e,g,t]);k=!0}for(var r=[],h=0;h<this.audioFormats.length;h++)r.push(e.src+e.name+"."+this.audioFormats[h]+me.loader.nocache);r=new Howl({urls:r,volume:Howler.volume(),onend:function(a){b[a]&&(b[a](),b[a]=null)},onloaderror:function(){a.call(me.audio,e.name,t)},onload:function(){k=!1;var a=n.shift();a&&c.load.apply(c,a);l=0;g&&g()}});return d[e.name]=r,1},c.play=function(a,c,e,g){return(a=d[a.toLowerCase()])&&
"undefined"!=typeof a?(a.loop(c||!1),a.volume("number"==typeof g?g.clamp(0,1):Howler.volume()),"function"==typeof e?a.play(function(a){b[a]=e}):a.play(),a):void 0},c.stop=function(a){(a=d[a.toLowerCase()])&&"undefined"!=typeof a&&a.stop()},c.pause=function(a){(a=d[a.toLowerCase()])&&"undefined"!=typeof a&&a.pause()},c.playTrack=function(a,b){g=me.audio.play(a,!0,null,b);e=a.toLowerCase()},c.stopTrack=function(){g&&(g.pause(),e=null,g=null)},c.setVolume=function(a){Howler.volume(a)},c.getVolume=function(){return Howler.volume()},
c.mute=function(a,b){var c=d[a.toLowerCase()];c&&"undefined"!=typeof c&&c.mute(!0)},c.unmute=function(a){c.mute(a,!1)},c.muteAll=function(){Howler.mute()},c.unmuteAll=function(){Howler.unmute()},c.getCurrentTrack=function(){return e},c.pauseTrack=function(){g&&g.pause()},c.resumeTrack=function(){g&&g.play()},c.unload=function(a){return a=a.toLowerCase(),a in d?(e===a?c.stopTrack():c.stop(a),d[a].unload(),delete d[a],!0):!1},c.unloadAll=function(){for(var a in d)c.unload(a)},c}()})(window);
(function(){me.video=function(){var a={},c=null,d=null,b=null,e=null,g=null,l=-1,k=!1,n=0,s=0,u=!1,t=!0,r=1/0,h=1/0;return a.init=function(h,p,l,r,D,E){if(!me.initialized)throw"melonJS: me.video.init() called before engine initialization.";if(k=r||!1,u="auto"===D||!1,t=void 0!==E?E:!0,D="auto"!==D?parseFloat(D||1):1,me.sys.scale=new me.Vector2d(D,D),(u||1!==D)&&(k=!0),n=p*me.sys.scale.x,s=l*me.sys.scale.y,window.addEventListener("resize",throttle(100,!1,function(a){me.event.publish(me.event.WINDOW_ONRESIZE,
[a])}),!1),window.addEventListener("orientationchange",function(a){me.event.publish(me.event.WINDOW_ONORIENTATION_CHANGE,[a])},!1),me.event.subscribe(me.event.WINDOW_ONRESIZE,me.video.onresize.bind(me.video)),me.event.subscribe(me.event.WINDOW_ONORIENTATION_CHANGE,me.video.onresize.bind(me.video)),c=a.createCanvas(n,s,!0),h&&(g=document.getElementById(h)),g||(g=document.body),g.appendChild(c),!c.getContext)return!1;if(d=a.getContext2d(c),1<me.device.getPixelRatio()&&(c.style.width=c.width/me.device.getPixelRatio()+
"px",c.style.height=c.height/me.device.getPixelRatio()+"px"),k?(b=a.createCanvas(p,l,!1),e=a.getContext2d(b)):(b=c,e=d),window.getComputedStyle)h=window.getComputedStyle(c,null),me.video.setMaxSize(parseInt(h.maxWidth,10),parseInt(h.maxHeight,10));return me.video.onresize(null),me.game.init(),!0},a.getWrapper=function(){return g},a.getWidth=function(){return b.width},a.getPos=function(a){return a=a||c,a.getBoundingClientRect?a.getBoundingClientRect():{left:0,top:0}},a.getHeight=function(){return b.height},
a.setMaxSize=function(a,b){r=a||1/0;h=b||1/0},a.createCanvas=function(a,c,d){if(0===a||0===c)throw Error("melonJS: width or height was zero, Canvas could not be initialized !");var e=document.createElement("canvas");return!0===d&&navigator.isCocoonJS&&(e.screencanvas=!0),e.width=a||b.width,e.height=c||b.height,e},a.getContext2d=function(a){var b;return b=navigator.isCocoonJS?a.getContext("2d",{antialias:me.sys.scalingInterpolation}):a.getContext("2d"),b.canvas||(b.canvas=a),me.video.setImageSmoothing(b,
me.sys.scalingInterpolation),b},a.getScreenCanvas=function(){return c},a.getScreenContext=function(){return d},a.getSystemCanvas=function(){return b},a.getSystemContext=function(){return e},a.onresize=function(){var a=1,b=1;if(me.device.orientation="undefined"!=typeof window.orientation?window.orientation:window.outerWidth>window.outerHeight?90:0,u)if(b=me.video.getScreenCanvas().parentNode,a=Math.min(r,b.width||window.innerWidth),b=Math.min(h,b.height||window.innerHeight),t?a=b=me.video.getWidth()/
me.video.getHeight()>a/b?a/me.video.getWidth():b/me.video.getHeight():(a/=me.video.getWidth(),b/=me.video.getHeight()),a*=me.device.getPixelRatio(),b*=me.device.getPixelRatio(),1!==a||1!==b)return 0<=l&&clearTimeout(l),void(l=me.video.updateDisplaySize.defer(this,a,b));me.input.offset=me.video.getPos()},a.updateDisplaySize=function(e,g){me.sys.scale.set(e,g);c.width=n=b.width*e;c.height=s=b.height*g;1<me.device.getPixelRatio()&&(c.style.width=c.width/me.device.getPixelRatio()+"px",c.style.height=
c.height/me.device.getPixelRatio()+"px");me.video.setImageSmoothing(d,me.sys.scalingInterpolation);me.input.offset=me.video.getPos();a.blitSurface();l=-1},a.clearSurface=function(a,b){var c=a.canvas;a.save();a.setTransform(1,0,0,1,0,0);a.fillStyle=b;a.fillRect(0,0,c.width,c.height);a.restore()},a.setImageSmoothing=function(a,b){for(var c=["ms","moz","webkit","o"],d=0;d<c.length;++d)void 0!==a[c[d]+"ImageSmoothingEnabled"]&&(a[c[d]+"ImageSmoothingEnabled"]=!0===b);a.imageSmoothingEnabled=!0===b},a.setAlpha=
function(a,b){a.globalCompositeOperation=b?"source-over":"copy"},a.blitSurface=function(){a.blitSurface=k?function(){d.drawImage(b,0,0,b.width,b.height,0,0,n,s)}:function(){};a.blitSurface()},a.applyRGBFilter=function(b,c,d){var e=a.getContext2d(a.createCanvas(b.width,b.height,!1));b=me.utils.getPixels(b);var g=b.data;switch(c){case "b\x26w":c=0;for(d=g.length;d>c;c+=4){var h=3*g[c]+4*g[c+1]+g[c+2]>>>3;g[c]=h;g[c+1]=h;g[c+2]=h}break;case "brightness":h=Math.abs(d).clamp(0,1);c=0;for(d=g.length;d>
c;c+=4)g[c]*=h,g[c+1]*=h,g[c+2]*=h;break;case "transparent":var h=me.pool.pull("me.Color").parseHex(d),k=me.pool.pull("me.Color");c=0;for(d=g.length;d>c;c+=4)k.setColor(g[c],g[c+1],g[c+2]),k.equals(h)&&(g[c+3]=0);me.pool.push(h);me.pool.push(k);break;default:return null}return e.putImageData(b,0,0),e},a}()})(window);
(function(a){me.input=function(){function c(a,b){for(var c=2;c<a.length;++c)void 0!==a[c]&&me.video.getScreenCanvas().addEventListener(a[c],b,!1)}function d(){H||(t.changedTouches.push({x:0,y:0}),t.mouse.pos=new me.Vector2d(0,0),t.offset=me.video.getPos(),a.addEventListener("scroll",throttle(100,!1,function(a){t.offset=me.video.getPos();me.event.publish(me.event.WINDOW_ONSCROLL,[a])}),!1),A=a.navigator.pointerEnabled?la:a.navigator.msPointerEnabled?ma:me.device.touch?ka:J,c(A,u),Q="onwheel"in document.createElement("div")?
"wheel":"mousewheel",a.addEventListener(Q,n,!1),void 0===t.throttlingInterval&&(t.throttlingInterval=Math.floor(1E3/me.sys.fps)),17>t.throttlingInterval?me.video.getScreenCanvas().addEventListener(A[ra],s,!1):me.video.getScreenCanvas().addEventListener(A[ra],throttle(t.throttlingInterval,!1,function(a){s(a)}),!1),H=!0)}function b(a){return a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,!1}function e(a,c,d){c=c||a.keyCode||a.which;var e=
r[c];return(me.event.publish(me.event.KEYDOWN,[e,c,e?!p[e]:!0]),e)?(p[e]||(d=d?d:c,y[e][d]||(h[e]++,y[e][d]=!0)),C[c]?b(a):!0):!0}function g(a,c,d){c=c||a.keyCode||a.which;var e=r[c];return(me.event.publish(me.event.KEYUP,[e,c]),e)?(y[e][d?d:c]=void 0,0<h[e]&&h[e]--,p[e]=!1,b(a)):!0}function l(a){var b=!1,c=D[a.type];if(c||(c=A.indexOf(a.type)===M?D[A[Aa]]:D[a.type]),c)for(var d=me.game.viewport.localToWorld(0,0),e=0,g=t.changedTouches.length;g>e;e++){if("undefined"!=typeof a.timeStamp){if(a.timeStamp<
S)continue;S=a.timeStamp}me.device.pointerEnabled||(a.pointerId=t.changedTouches[e].id);a.gameScreenX=t.changedTouches[e].x;a.gameScreenY=t.changedTouches[e].y;a.gameWorldX=a.gameScreenX+d.x;a.gameWorldY=a.gameScreenY+d.y;for(var h,m=c.length;m--,h=c[m];)if(!0===h.floating?(a.gameX=a.gameScreenX,a.gameY=a.gameScreenY):(a.gameX=a.gameWorldX,a.gameY=a.gameWorldY),h.bounds.containsPoint(a.gameX-h.rect.pos.x,a.gameY-h.rect.pos.y)&&!1===h.cb(a)){b=!0;break}}return b}function k(a){var b;if(t.changedTouches.length=
0,a.touches)for(var c=0,d=a.changedTouches.length;d>c;c++){var e=a.changedTouches[c];b=t.globalToLocal(e.clientX,e.clientY);b.id=e.identifier;t.changedTouches.push(b)}else b=t.globalToLocal(a.clientX,a.clientY),b.id=a.pointerId||1,t.changedTouches.push(b);!1!==a.isPrimary&&t.mouse.pos.set(t.changedTouches[0].x,t.changedTouches[0].y)}function n(a){if(a.target===me.video.getScreenCanvas()){var c={deltaMode:1,type:"mousewheel",deltaX:a.deltaX,deltaY:a.deltaY,deltaZ:a.deltaZ};if("mousewheel"===Q&&(c.deltaY=
-0.025*a.wheelDelta,a.wheelDeltaX&&(c.deltaX=-0.025*a.wheelDeltaX)),l(c))return b(a)}return!0}function s(a){return k(a),l(a)?b(a):!0}function u(a){if(k(a),l(a))return b(a);var c=a.button||0,d=t.mouse.bind[c];return d?a.type===A[sa]?e(a,d,c+1):g(a,d,c+1):!0}var t={},r={},h={},m={},p={},y={},C={},D={},E=!1,H=!1,Q="mousewheel",S=0,A=null,J=["mousewheel","mousemove","mousedown","mouseup",void 0,"click","dblclick"],ka=[void 0,"touchmove","touchstart","touchend","touchcancel","tap","dbltap"],la=["mousewheel",
"pointermove","pointerdown","pointerup","pointercancel",void 0,void 0],ma=["mousewheel","MSPointerMove","MSPointerDown","MSPointerUp","MSPointerCancel",void 0,void 0],ra=1,sa=2,Aa=3,M=4;return t.mouse={pos:null,LEFT:0,MIDDLE:1,RIGHT:2,bind:[0,0,0]},t.offset=null,t.throttlingInterval=void 0,t.changedTouches=[],t.preventDefault=!0,t.KEY={TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,
NUM9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,PLUS:187,COMMA:188,MINUS:189,PERIOD:190},t.isKeyPressed=function(a){return h[a]&&!p[a]?(m[a]&&(p[a]=!0),!0):!1},t.keyStatus=function(a){return 0<h[a]},t.triggerKeyEvent=function(a,b){b?e({},a):g({},a)},t.bindKey=function(b,c,d,k){E||(a.addEventListener("keydown",e,!1),a.addEventListener("keyup",g,!1),E=!0);
"boolean"!=typeof k&&(k=me.input.preventDefault);r[b]=c;C[b]=k;h[c]=0;m[c]=d?d:!1;p[c]=!1;y[c]={}},t.unlockKey=function(a){p[a]=!1},t.unbindKey=function(a){h[r[a]]=0;m[r[a]]=!1;y[r[a]]={};r[a]=null;C[a]=null},t.globalToLocal=function(a,b){var c=t.offset,d=me.device.getPixelRatio();a-=c.left;b-=c.top;c=me.sys.scale;return(1!==c.x||1!==c.y)&&(a/=c.x,b/=c.y),new me.Vector2d(a*d,b*d)},t.bindMouse=function(a,b){if(d(),!r[b])throw"melonJS : no action defined for keycode "+b;t.mouse.bind[a]=b},t.unbindMouse=
function(a){t.mouse.bind[a]=null},t.bindTouch=function(a){t.bindMouse(me.input.mouse.LEFT,a)},t.unbindTouch=function(){t.unbindMouse(me.input.mouse.LEFT)},t.registerPointerEvent=function(a,b,c,e){if(d(),-1!==J.indexOf(a)&&(me.device.touch||me.device.pointerEnabled)&&(a=A[J.indexOf(a)]),a&&-1!==A.indexOf(a)){D[a]||(D[a]=[]);var g=!0===b.floating?!0:!1;e&&(g=!0===e?!0:!1);e=b.getBounds();return"undefined"==typeof b.getShape&&e.translate(-b.pos.x,-b.pos.y),void D[a].push({rect:b,bounds:e,cb:c,floating:g})}throw"melonJS : invalid event type : "+
a;},t.releasePointerEvent=function(a,b){-1!==J.indexOf(a)&&(me.device.touch||me.device.pointerEnabled)&&(a=A[J.indexOf(a)]);if(!a||-1===A.indexOf(a))throw"melonJS : invalid event type : "+a;D[a]||(D[a]=[]);var c=D[a];if(c)for(var d,e=c.length;e--,d=c[e];)d.rect===b&&(d.rect=d.bounds=d.cb=d.floating=null,D[a].splice(e,1))},t.translatePointerEvents=function(){t.registerPointerEvent("mousemove",me.game.viewport,function(a){return me.event.publish(me.event.MOUSEMOVE,[a]),!1})},t}()})(window);
(function(a){var c=function(){var c={};return c.decode=function(b){if(b=b.replace(/[^A-Za-z0-9\+\/\=]/g,""),me.device.nativeBase64)return a.atob(b);for(var c,d,l,k,n,s=[],u=0;u<b.length;)c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(b.charAt(u++)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(b.charAt(u++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(b.charAt(u++)),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".indexOf(b.charAt(u++)),
c=c<<2|d>>4,d=(15&d)<<4|k>>2,l=(3&k)<<6|n,s.push(String.fromCharCode(c)),64!==k&&s.push(String.fromCharCode(d)),64!==n&&s.push(String.fromCharCode(l));return s.join("")},c}();me.utils=function(){var a={},b="",e=0,g=/^.*(\\|\/|\:)/,l=/\.[^\.]*$/;return a.decodeBase64=function(a){return c.decode(a)},a.decodeBase64AsArray=function(a,b){b=b||1;var d,e,g,l,h=c.decode(a);l="function"==typeof window.Uint32Array?new Uint32Array(h.length/b):[];d=0;for(g=h.length/b;g>d;d++){l[d]=0;for(e=b-1;0<=e;--e)l[d]+=
h.charCodeAt(d*b+e)<<(e<<3)}return l},a.decompress=function(){throw"melonJS: GZIP/ZLIB compressed TMX Tile Map not supported!";},a.decodeCSV=function(a,b){a=a.trim().split("\n");for(var c=[],d=0;d<a.length;d++)for(var e=a[d].split(",",b),g=0;g<e.length;g++)c.push(+e[g]);return c},a.getBasename=function(a){return a.replace(g,"").replace(l,"")},a.getFileExtension=function(a){return a.substring(a.lastIndexOf(".")+1,a.length)},a.getPixels=function(a){if(a instanceof HTMLImageElement){var b=me.video.getContext2d(me.video.createCanvas(a.width,
a.height));return b.drawImage(a,0,0),b.getImageData(0,0,a.width,a.height)}return a.getContext("2d").getImageData(0,0,a.width,a.height)},a.resetGUID=function(a){b=a.toString().toUpperCase().toHex();e=0},a.createGUID=function(){return b+"-"+e++},a.applyFriction=function(a,b){return 0>a+b?a+b*me.timer.tick:0<a-b?a-b*me.timer.tick:0},a}()})(window);
(function(){var a={black:[0,0,0],silver:[192,192,129],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],orange:[255,165,0],aliceblue:[240,248,245],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],
brown:[165,42,42],burlywood:[222,184,35],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],"darkgray[*]":[169,169,169],darkgreen:[0,100,0],"darkgrey[*]":[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,
122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,
105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],
lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,
245,230],olivedrab:[107,142,35],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,
206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]};me.Color=Object.extend({r:0,g:0,b:0,alpha:1,init:function(a,d,b,e){return this.setColor(a,d,b,e),this},onResetEvent:function(){this.setColor(0,0,0,1)},add:function(a){return this.r=
Math.min(this.r+a.r,255),this.g=Math.min(this.g+a.g,255),this.b=Math.min(this.b+a.b,255),this},setColor:function(a,d,b,e){return this.r=a||0,this.g=d||0,this.b=b||0,this.alpha=e||1,this},darken:function(a){return this.r=Math.min(this.r*a,255),this.g=Math.min(this.g*a,255),this.b=Math.min(this.b*a,255),this},equals:function(a){return this.r===a.r&&this.g===a.g&&this.b===a.b&&this.alpha===a.alpha},parseCSS:function(c){var d=a[c]||d;return this.setColor(d[0],d[1],d[2],1),this},parseHex:function(a){return"#"===
a.charAt(0)&&(a=a.substring(1,a.length)),6>a.length?(this.r=parseInt(a.charAt(0)+a.charAt(0),16),this.g=parseInt(a.charAt(1)+a.charAt(1),16),this.b=parseInt(a.charAt(2)+a.charAt(2),16)):(this.r=parseInt(a.substring(0,2),16),this.g=parseInt(a.substring(2,4),16),this.b=parseInt(a.substring(4,6),16)),this.alpha=1,this},random:function(){return this.setColor(Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random()),this.alpha),this},toHex:function(){return"#"+this.r.toHex()+
this.g.toHex()+this.b.toHex()},toRGB:function(){return"rgb("+this.r+","+this.g+","+this.b+")"},toRGBA:function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.alpha+")"}})})(window);
(function(){me.save=function(){var a={},c={_init:function(){!0===me.device.localStorage&&(JSON.parse(localStorage.getItem("me.save"))||[]).forEach(function(c){a[c]=JSON.parse(localStorage.getItem("me.save."+c))})},add:function(d){Object.keys(d).forEach(function(b){"add"===b||"remove"===b||(!function(b){Object.defineProperty(c,b,{configurable:!0,enumerable:!0,get:function(){return a[b]},set:function(c){a[b]=c;!0===me.device.localStorage&&localStorage.setItem("me.save."+b,JSON.stringify(c))}})}(b),
b in a||(c[b]=d[b]))});!0===me.device.localStorage&&localStorage.setItem("me.save",JSON.stringify(Object.keys(a)))},remove:function(c){"add"===c||"remove"===c||"undefined"!=typeof a[c]&&(delete a[c],!0===me.device.localStorage&&(localStorage.removeItem("me.save."+c),localStorage.setItem("me.save",JSON.stringify(Object.keys(a)))))}};return c}()})(window);
(function(){me.COLLISION_LAYER="collision";me.TMX_TAG_MAP="map";me.TMX_TAG_NAME="name";me.TMX_TAG_VALUE="value";me.TMX_TAG_VERSION="version";me.TMX_TAG_ORIENTATION="orientation";me.TMX_TAG_WIDTH="width";me.TMX_TAG_HEIGHT="height";me.TMX_TAG_OPACITY="opacity";me.TMX_TAG_TRANS="trans";me.TMX_TAG_TILEWIDTH="tilewidth";me.TMX_TAG_TILEHEIGHT="tileheight";me.TMX_TAG_TILEOFFSET="tileoffset";me.TMX_TAG_FIRSTGID="firstgid";me.TMX_TAG_GID="gid";me.TMX_TAG_TILE="tile";me.TMX_TAG_ID="id";me.TMX_TAG_DATA="data";
me.TMX_TAG_COMPRESSION="compression";me.TMX_TAG_GZIP="gzip";me.TMX_TAG_ZLIB="zlib";me.TMX_TAG_ENCODING="encoding";me.TMX_TAG_ATTR_BASE64="base64";me.TMX_TAG_CSV="csv";me.TMX_TAG_SPACING="spacing";me.TMX_TAG_MARGIN="margin";me.TMX_TAG_PROPERTIES="properties";me.TMX_TAG_PROPERTY="property";me.TMX_TAG_IMAGE="image";me.TMX_TAG_SOURCE="source";me.TMX_TAG_VISIBLE="visible";me.TMX_TAG_TILESET="tileset";me.TMX_TAG_LAYER="layer";me.TMX_TAG_TILE_LAYER="tilelayer";me.TMX_TAG_IMAGE_LAYER="imagelayer";me.TMX_TAG_OBJECTGROUP=
"objectgroup";me.TMX_TAG_OBJECT="object";me.TMX_TAG_X="x";me.TMX_TAG_Y="y";me.TMX_TAG_WIDTH="width";me.TMX_TAG_HEIGHT="height";me.TMX_TAG_POLYGON="polygon";me.TMX_TAG_POLYLINE="polyline";me.TMX_TAG_ELLIPSE="ellipse";me.TMX_TAG_POINTS="points";me.TMX_BACKGROUND_COLOR="backgroundcolor"})(window);
(function(){me.TMXUtils=function(){function a(a){if(!a||a.isBoolean())a=a?"true"===a:!0;else if(a.isNumeric())a=Number(a);else if(a.match(/^json:/i)){var b=a.split(/^json:/i)[1];try{a=JSON.parse(b)}catch(c){throw"Unable to parse JSON: "+b;}}return a}var c={};return c.applyTMXPropertiesFromXML=function(c,b){var e=b.getElementsByTagName(me.TMX_TAG_PROPERTIES)[0];if(e)for(var e=e.getElementsByTagName(me.TMX_TAG_PROPERTY),g=0;g<e.length;g++){var l=me.mapReader.TMXParser.getStringAttribute(e[g],me.TMX_TAG_NAME),
k=me.mapReader.TMXParser.getStringAttribute(e[g],me.TMX_TAG_VALUE);c[l]=a(k)}},c.applyTMXPropertiesFromJSON=function(c,b){var e=b[me.TMX_TAG_PROPERTIES];if(e)for(var g in e)e.hasOwnProperty(g)&&(c[g]=a(e[g]))},c}()})(window);
(function(){me.TMXObjectGroup=Object.extend({name:null,width:0,height:0,visible:!1,z:0,objects:[],initFromXML:function(a,c,d,b){this.name=a;this.width=me.mapReader.TMXParser.getIntAttribute(c,me.TMX_TAG_WIDTH);this.height=me.mapReader.TMXParser.getIntAttribute(c,me.TMX_TAG_HEIGHT);this.visible=1===me.mapReader.TMXParser.getIntAttribute(c,me.TMX_TAG_VISIBLE,1);this.opacity=me.mapReader.TMXParser.getFloatAttribute(c,me.TMX_TAG_OPACITY,1).clamp(0,1);this.z=b;this.objects=[];c.firstChild&&c.firstChild.nextSibling.nodeName===
me.TMX_TAG_PROPERTIES&&me.TMXUtils.applyTMXPropertiesFromXML(this,c);a=c.getElementsByTagName(me.TMX_TAG_OBJECT);for(c=0;c<a.length;c++){var e=new me.TMXObject;e.initFromXML(a[c],d,b);this.objects.push(e)}},initFromJSON:function(a,c,d,b){var e=this;this.name=a;this.width=c[me.TMX_TAG_WIDTH];this.height=c[me.TMX_TAG_HEIGHT];this.visible=c[me.TMX_TAG_VISIBLE];this.opacity=parseFloat(c[me.TMX_TAG_OPACITY]||1).clamp(0,1);this.z=b;this.objects=[];me.TMXUtils.applyTMXPropertiesFromJSON(this,c);c.objects.forEach(function(a){var c=
new me.TMXObject;c.initFromJSON(a,d,b);e.objects.push(c)})},destroy:function(){this.objects=null},getObjectCount:function(){return this.objects.length},getObjectByIndex:function(a){return this.objects[a]}});me.TMXObject=Object.extend({name:null,x:0,y:0,width:0,height:0,z:0,gid:void 0,isPolygon:!1,isPolyline:!1,points:void 0,initFromXML:function(a,c,d){if(this.name=me.mapReader.TMXParser.getStringAttribute(a,me.TMX_TAG_NAME),this.x=me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_X),this.y=me.mapReader.TMXParser.getIntAttribute(a,
me.TMX_TAG_Y),this.z=d,this.width=me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_WIDTH,0),this.height=me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_HEIGHT,0),this.gid=me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_GID,null),this.isEllipse=!1,this.isPolygon=!1,this.isPolyline=!1,this.gid)this.setImage(this.gid,c);else if(a.getElementsByTagName(me.TMX_TAG_ELLIPSE).length)this.isEllipse=!0;else if(c=a.getElementsByTagName(me.TMX_TAG_POLYGON),c.length?this.isPolygon=!0:(c=a.getElementsByTagName(me.TMX_TAG_POLYLINE),
c.length&&(this.isPolyline=!0)),c.length){this.points=[];d=me.mapReader.TMXParser.getStringAttribute(c[0],me.TMX_TAG_POINTS).split(" ");for(var b=0;b<d.length;b++)c=d[b].split(","),this.points.push(new me.Vector2d(+c[0],+c[1]))}me.game.renderer.adjustPosition(this);me.TMXUtils.applyTMXPropertiesFromXML(this,a)},initFromJSON:function(a,c,d){if(this.name=a[me.TMX_TAG_NAME],this.x=parseInt(a[me.TMX_TAG_X],10),this.y=parseInt(a[me.TMX_TAG_Y],10),this.z=parseInt(d,10),this.width=parseInt(a[me.TMX_TAG_WIDTH]||
0,10),this.height=parseInt(a[me.TMX_TAG_HEIGHT]||0,10),this.gid=parseInt(a[me.TMX_TAG_GID],10)||null,this.isEllipse=!1,this.isPolygon=!1,this.isPolyline=!1,this.gid)this.setImage(this.gid,c);else if(void 0!==a[me.TMX_TAG_ELLIPSE])this.isEllipse=!0;else if(c=a[me.TMX_TAG_POLYGON],void 0!==c?this.isPolygon=!0:(c=a[me.TMX_TAG_POLYLINE],void 0!==c&&(this.isPolyline=!0)),void 0!==c){this.points=[];var b=this;c.forEach(function(a){b.points.push(new me.Vector2d(parseInt(a.x,10),parseInt(a.y,10)))})}me.game.renderer.adjustPosition(this);
me.TMXUtils.applyTMXPropertiesFromJSON(this,a)},setImage:function(a,c){var d=c.getTilesetByGid(this.gid);this.width=d.tilewidth;this.height=d.tileheight;this.spritewidth=this.width;var b=new me.Tile(this.x,this.y,d.tilewidth,d.tileheight,this.gid);this.image=d.getTileImage(b)},getShape:function(){return!0===this.isEllipse?new me.Ellipse(new me.Vector2d(0,0),this.width,this.height):!0===this.isPolygon||!0===this.isPolyline?new me.PolyShape(new me.Vector2d(0,0),this.points,this.isPolygon):new me.Rect(new me.Vector2d(0,
0),this.width,this.height)},getObjectPropertyByName:function(a){return this[a]}})})(window);
(function(){me.Tile=me.Rect.extend({tileId:null,tileset:null,transform:null,init:function(a,c,d,b,e){this.parent(new me.Vector2d(a*d,c*b),d,b);this.col=a;this.row=c;this.tileId=e;this.flipX=0!==(this.tileId&2147483648);this.flipY=0!==(this.tileId&1073741824);this.flipAD=0!==(this.tileId&536870912);this.flipped=this.flipX||this.flipY||this.flipAD;!0===this.flipped&&this.createTransform();this.tileId&=536870911},createTransform:function(){null===this.transform&&(this.transform=new me.Matrix2d);this.transform.identity();
this.flipAD&&(this.transform.set(0,1,1,0),this.transform.translate(0,this.height-this.width));this.flipX&&(this.transform.a*=-1,this.transform.c*=-1,this.transform.translate(this.flipAD?this.height:this.width,0));this.flipY&&(this.transform.b*=-1,this.transform.d*=-1,this.transform.translate(0,this.flipAD?this.width:this.height))}});me.TMXTileset=Object.extend({type:{SOLID:"solid",PLATFORM:"platform",L_SLOPE:"lslope",R_SLOPE:"rslope",LADDER:"ladder",TOPLADDER:"topladder",BREAKABLE:"breakable"},init:function(){this.TileProperties=
[];this.tileXOffset=[];this.tileYOffset=[]},initFromXML:function(a){this.firstgid=me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_FIRSTGID);var c=me.mapReader.TMXParser.getStringAttribute(a,me.TMX_TAG_SOURCE);if(c){if(c=me.utils.getBasename(c),a=me.loader.getTMX(c),!a)throw"melonJS:"+c+" TSX tileset not found";me.mapReader.TMXParser.parseFromString(a);a=me.mapReader.TMXParser.getFirstElementByTagName("tileset")}this.name=me.mapReader.TMXParser.getStringAttribute(a,me.TMX_TAG_NAME);this.tilewidth=
me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_TILEWIDTH);this.tileheight=me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_TILEHEIGHT);this.spacing=me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_SPACING,0);this.margin=me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_MARGIN,0);this.tileoffset=new me.Vector2d(0,0);c=a.getElementsByTagName(me.TMX_TAG_TILEOFFSET);0<c.length&&(this.tileoffset.x=me.mapReader.TMXParser.getIntAttribute(c[0],me.TMX_TAG_X),this.tileoffset.y=me.mapReader.TMXParser.getIntAttribute(c[0],
me.TMX_TAG_Y));for(var c=a.getElementsByTagName(me.TMX_TAG_TILE),d=0;d<c.length;d++){var b=me.mapReader.TMXParser.getIntAttribute(c[d],me.TMX_TAG_ID)+this.firstgid,e={};me.TMXUtils.applyTMXPropertiesFromXML(e,c[d]);this.setTileProperty(b,e)}(c=(d=a.getElementsByTagName(me.TMX_TAG_IMAGE)[0].getAttribute(me.TMX_TAG_SOURCE))?me.loader.getImage(me.utils.getBasename(d)):null)||console.log("melonJS: '"+d+"' file for tileset '"+this.name+"' not found!");a=a.getElementsByTagName(me.TMX_TAG_IMAGE)[0].getAttribute(me.TMX_TAG_TRANS);
this.initFromImage(c,a)},initFromJSON:function(a){this.firstgid=a[me.TMX_TAG_FIRSTGID];var c=a[me.TMX_TAG_SOURCE];if(c&&(c=me.utils.getBasename(c),a=me.loader.getTMX(c),!a))throw"melonJS:"+c+" TSX tileset not found";this.name=a[me.TMX_TAG_NAME];this.tilewidth=parseInt(a[me.TMX_TAG_TILEWIDTH],10);this.tileheight=parseInt(a[me.TMX_TAG_TILEHEIGHT],10);this.spacing=parseInt(a[me.TMX_TAG_SPACING]||0,10);this.margin=parseInt(a[me.TMX_TAG_MARGIN]||0,10);this.tileoffset=new me.Vector2d(0,0);(c=a[me.TMX_TAG_TILEOFFSET])&&
(this.tileoffset.x=parseInt(c[me.TMX_TAG_X],10),this.tileoffset.y=parseInt(c[me.TMX_TAG_Y],10));var c=a.tileproperties,d;for(d in c){var b={};b.mixin(c[d]);this.setTileProperty(parseInt(d,10)+this.firstgid,b)}(c=(d=me.utils.getBasename(a[me.TMX_TAG_IMAGE]))?me.loader.getImage(d):null)||console.log("melonJS: '"+d+"' file for tileset '"+this.name+"' not found!");this.initFromImage(c,a[me.TMX_TAG_TRANS]||null)},initFromImage:function(a,c){a&&(this.image=a,this.hTileCount=~~((this.image.width-this.margin)/
(this.tilewidth+this.spacing)),this.vTileCount=~~((this.image.height-this.margin)/(this.tileheight+this.spacing)));this.lastgid=this.firstgid+(this.hTileCount*this.vTileCount-1||0);null!==c&&this.image&&(this.image=me.video.applyRGBFilter(this.image,"transparent",c.toUpperCase()).canvas)},setTileProperty:function(a,c){c.isSolid=c.type?c.type.toLowerCase()===this.type.SOLID:!1;c.isPlatform=c.type?c.type.toLowerCase()===this.type.PLATFORM:!1;c.isLeftSlope=c.type?c.type.toLowerCase()===this.type.L_SLOPE:
!1;c.isRightSlope=c.type?c.type.toLowerCase()===this.type.R_SLOPE:!1;c.isBreakable=c.type?c.type.toLowerCase()===this.type.BREAKABLE:!1;c.isLadder=c.type?c.type.toLowerCase()===this.type.LADDER:!1;c.isTopLadder=c.type?c.type.toLowerCase()===this.type.TOPLADDER:!1;c.isSlope=c.isLeftSlope||c.isRightSlope;c.isCollidable=!!c.type;this.TileProperties[a]=c},contains:function(a){return a>=this.firstgid&&a<=this.lastgid},getTileImage:function(a){var c=me.video.getContext2d(me.video.createCanvas(this.tilewidth,
this.tileheight));return this.drawTile(c,0,0,a),c.canvas},getTileProperties:function(a){return this.TileProperties[a]},isTileCollidable:function(a){return this.TileProperties[a].isCollidable},getTileOffsetX:function(a){var c=this.tileXOffset[a];return"undefined"==typeof c&&(c=this.tileXOffset[a]=this.margin+(this.spacing+this.tilewidth)*(a%this.hTileCount)),c},getTileOffsetY:function(a){var c=this.tileYOffset[a];return"undefined"==typeof c&&(c=this.tileYOffset[a]=this.margin+(this.spacing+this.tileheight)*
~~(a/this.hTileCount)),c},drawTile:function(a,c,d,b){if(b.flipped){a.save();var e=b.transform;a.transform(e.a,e.b,e.c,e.d,e.e+c,e.f+d);c=d=0}e=b.tileId-this.firstgid;a.drawImage(this.image,this.getTileOffsetX(e),this.getTileOffsetY(e),this.tilewidth,this.tileheight,c,d,this.tilewidth,this.tileheight);b.flipped&&a.restore()}});me.TMXTilesetGroup=Object.extend({init:function(){this.tilesets=[]},add:function(a){this.tilesets.push(a)},getTilesetByIndex:function(a){return this.tilesets[a]},getTilesetByGid:function(a){for(var c=
-1,d=0,b=this.tilesets.length;b>d;d++){if(this.tilesets[d].contains(a))return this.tilesets[d];this.tilesets[d].firstgid===this.tilesets[d].lastgid&&a>=this.tilesets[d].firstgid&&(c=d)}if(-1!==c)return this.tilesets[c];throw"no matching tileset found for gid "+a;}})})(window);
(function(){me.TMXOrthogonalRenderer=Object.extend({init:function(a,c,d,b){this.cols=a;this.rows=c;this.tilewidth=d;this.tileheight=b},canRender:function(a){return"orthogonal"===a.orientation&&this.cols===a.cols&&this.rows===a.rows&&this.tilewidth===a.tilewidth&&this.tileheight===a.tileheight},pixelToTileCoords:function(a,c){return new me.Vector2d(a/this.tilewidth,c/this.tileheight)},tileToPixelCoords:function(a,c){return new me.Vector2d(a*this.tilewidth,c*this.tileheight)},adjustPosition:function(a){"number"==
typeof a.gid&&(a.y-=a.height)},drawTile:function(a,c,d,b,e){e.drawTile(a,e.tileoffset.x+c*this.tilewidth,e.tileoffset.y+(d+1)*this.tileheight-e.tileheight,b)},drawTileLayer:function(a,c,d){var b=this.pixelToTileCoords(d.pos.x,d.pos.y).floorSelf();d=this.pixelToTileCoords(d.pos.x+d.width+this.tilewidth,d.pos.y+d.height+this.tileheight).ceilSelf();d.x=d.x>this.cols?this.cols:d.x;d.y=d.y>this.rows?this.rows:d.y;for(var e=b.y;e<d.y;e++)for(var g=b.x;g<d.x;g++){var l=c.layerData[g][e];l&&this.drawTile(a,
g,e,l,l.tileset)}}});me.TMXIsometricRenderer=Object.extend({init:function(a,c,d,b){this.cols=a;this.rows=c;this.tilewidth=d;this.tileheight=b;this.hTilewidth=d/2;this.hTileheight=b/2;this.originX=this.rows*this.hTilewidth},canRender:function(a){return"isometric"===a.orientation&&this.cols===a.cols&&this.rows===a.rows&&this.tilewidth===a.tilewidth&&this.tileheight===a.tileheight},pixelToTileCoords:function(a,c){a-=this.originX;var d=c/this.tileheight,b=a/this.tilewidth;return new me.Vector2d(d+b,d-
b)},tileToPixelCoords:function(a,c){return new me.Vector2d((a-c)*this.hTilewidth+this.originX,(a+c)*this.hTileheight)},adjustPosition:function(a){var c=this.tileToPixelCoords(a.x/this.hTilewidth,a.y/this.tileheight);c.x-=a.width/2;c.y-=a.height;a.x=c.x;a.y=c.y},drawTile:function(a,c,d,b,e){e.drawTile(a,(this.cols-1)*e.tilewidth+(c-d)*e.tilewidth>>1,-e.tilewidth+(c+d)*e.tileheight>>2,b)},drawTileLayer:function(a,c,d){var b=c.tileset,e=b.tileoffset,g=this.pixelToTileCoords(d.pos.x-b.tilewidth,d.pos.y-
b.tileheight).floorSelf(),l=this.pixelToTileCoords(d.pos.x+d.width+b.tilewidth,d.pos.y+d.height+b.tileheight).ceilSelf(),l=this.tileToPixelCoords(l.x,l.y),k=this.tileToPixelCoords(g.x,g.y);k.x-=this.hTilewidth;k.y+=this.tileheight;var n=k.y-d.pos.y>this.hTileheight;d=d.pos.x-k.x<this.hTilewidth;n&&(d?(g.x--,k.x-=this.hTilewidth):(g.y--,k.x+=this.hTilewidth),k.y-=this.hTileheight);d^=n;for(var n=g.clone(),s=k.y;s-this.tileheight<l.y;s+=this.hTileheight){n.setV(g);for(var u=k.x;u<l.x;u+=this.tilewidth){if(0<=
n.x&&0<=n.y&&n.x<this.cols&&n.y<this.rows){var t=c.layerData[n.x][n.y];t&&(b=t.tileset,e=b.tileoffset,b.drawTile(a,e.x+u,e.y+s-b.tileheight,t))}n.x++;n.y--}d?(g.y++,k.x-=this.hTilewidth,d=!1):(g.x++,k.x+=this.hTilewidth,d=!0)}}})})(window);
(function(){me.ColorLayer=me.Renderable.extend({init:function(a,c,d){this.parent(new me.Vector2d(0,0),1/0,1/0);this.name=a;this.color=(new me.Color).parseHex(c);this.z=d},draw:function(a,c){var d=a.globalAlpha;a.globalAlpha*=this.getOpacity();a.fillStyle=this.color.toRGB();a.fillRect(c.left,c.top,c.width,c.height);a.globalAlpha=d}});me.ImageLayer=me.Renderable.extend({init:function(a,c,d,b,e,g){if(this.name=a,this.image=b?me.loader.getImage(me.utils.getBasename(b)):null,!this.image)throw"melonJS: '"+
b+"' file for Image Layer '"+this.name+"' not found!";this.imagewidth=this.image.width;this.imageheight=this.image.height;a=me.game.viewport;c=c?Math.min(a.width,c):a.width;d=d?Math.min(a.height,d):a.height;this.parent(new me.Vector2d(0,0),c,d);this.z=e;this.ratio=new me.Vector2d(1,1);g&&("number"==typeof g?this.ratio.set(g,g):this.ratio.setV(g));this.lastpos=a.pos.clone();this.floating=!0;this._repeat="repeat";this.repeatY=this.repeatX=!0;Object.defineProperty(this,"repeat",{get:function(){return this._repeat},
set:function(a){switch(this._repeat=a,this._repeat){case "no-repeat":this.repeatY=this.repeatX=!1;break;case "repeat-x":this.repeatX=!0;this.repeatY=!1;break;case "repeat-y":this.repeatX=!1;this.repeatY=!0;break;default:this.repeatY=this.repeatX=!0}}});this.anchorPoint.set(0,0);this.handle=me.event.subscribe(me.event.VIEWPORT_ONCHANGE,this.updateLayer.bind(this))},updateLayer:function(a){(0!==this.ratio.x||0!==this.ratio.y)&&(this.repeatX||this.repeatY?(this.pos.x+=(a.x-this.lastpos.x)*this.ratio.x%
this.imagewidth,this.pos.x=(this.imagewidth+this.pos.x)%this.imagewidth,this.pos.y+=(a.y-this.lastpos.y)*this.ratio.y%this.imageheight,this.pos.y=(this.imageheight+this.pos.y)%this.imageheight):(this.pos.x+=(a.x-this.lastpos.x)*this.ratio.x,this.pos.y+=(a.y-this.lastpos.y)*this.ratio.y),this.lastpos.setV(a))},draw:function(a,c){var d=me.game.viewport,b=0!==this.anchorPoint.y||0!==this.anchorPoint.x,e=~~(this.anchorPoint.x*(d.width-this.imagewidth)),d=~~(this.anchorPoint.y*(d.height-this.imageheight));
b&&a.translate(e,d);a.globalAlpha*=this.getOpacity();var g,l;if(0===this.ratio.x&&0===this.ratio.y)g=Math.min(c.width,this.imagewidth),l=Math.min(c.height,this.imageheight),a.drawImage(this.image,c.left,c.top,g,l,c.left,c.top,g,l);else{var k=~~this.pos.x,n=~~this.pos.y,s=0,u=0;g=Math.min(this.imagewidth-k,this.width);for(l=Math.min(this.imageheight-n,this.height);;){do a.drawImage(this.image,k,n,g,l,s,u,g,l),n=0,u+=l,l=Math.min(this.imageheight,this.height-u);while(this.repeatY&&u<this.height);if(s+=
g,!this.repeatX||s>=this.width)break;k=0;g=Math.min(this.imagewidth,this.width-s);n=~~this.pos.y;u=0;l=Math.min(this.imageheight-~~this.pos.y,this.height)}}b&&a.translate(-e,-d)},destroy:function(){this.handle&&(me.event.unsubscribe(this.handle),this.handle=null);this.lastpos=this.image=null}});me.CollisionTiledLayer=me.Renderable.extend({init:function(a,c){this.parent(new me.Vector2d(0,0),a,c);this.isCollisionMap=!0},checkCollision:function(a,c){var d=0>c.x?a.left+c.x:a.right+c.x,b=0>c.y?a.top+c.y:
a.bottom+c.y,e={x:0,y:0,xprop:{},yprop:{}};return(0>=d||d>=this.width)&&(e.x=c.x),(0>=b||b>=this.height)&&(e.y=c.y),e}});me.TMXLayer=me.Renderable.extend({layerData:null,init:function(a,c,d,b,e){this.parent(new me.Vector2d(0,0),0,0);this.tilewidth=a;this.tileheight=c;this.orientation=d;this.tileset=(this.tilesets=b)?this.tilesets.getTilesetByIndex(0):null;this.z=e},initFromXML:function(a){this.name=me.mapReader.TMXParser.getStringAttribute(a,me.TMX_TAG_NAME);this.visible=1===me.mapReader.TMXParser.getIntAttribute(a,
me.TMX_TAG_VISIBLE,1);this.cols=me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_WIDTH);this.rows=me.mapReader.TMXParser.getIntAttribute(a,me.TMX_TAG_HEIGHT);this.setOpacity(me.mapReader.TMXParser.getFloatAttribute(a,me.TMX_TAG_OPACITY,1));this.width=this.cols*this.tilewidth;this.height=this.rows*this.tileheight;me.TMXUtils.applyTMXPropertiesFromXML(this,a);"undefined"==typeof this.preRender&&(this.preRender=me.sys.preRender);(this.isCollisionMap=this.name.toLowerCase().contains(me.COLLISION_LAYER))&&
!me.debug.renderCollisionMap&&(this.visible=!1);!0===this.preRender&&(this.layerCanvas=me.video.createCanvas(this.cols*this.tilewidth,this.rows*this.tileheight),this.layerSurface=me.video.getContext2d(this.layerCanvas))},initFromJSON:function(a){this.name=a[me.TMX_TAG_NAME];this.visible=a[me.TMX_TAG_VISIBLE];this.cols=parseInt(a[me.TMX_TAG_WIDTH],10);this.rows=parseInt(a[me.TMX_TAG_HEIGHT],10);this.setOpacity(parseFloat(a[me.TMX_TAG_OPACITY]));this.width=this.cols*this.tilewidth;this.height=this.rows*
this.tileheight;me.TMXUtils.applyTMXPropertiesFromJSON(this,a);"undefined"==typeof this.preRender&&(this.preRender=me.sys.preRender);(this.isCollisionMap=this.name.toLowerCase().contains(me.COLLISION_LAYER))&&!me.debug.renderCollisionMap&&(this.visible=!1);!0===this.preRender&&(this.layerCanvas=me.video.createCanvas(this.cols*this.tilewidth,this.rows*this.tileheight),this.layerSurface=me.video.getContext2d(this.layerCanvas))},destroy:function(){this.preRender&&(this.layerCanvas=null,this.layerSurface=
null);this.tilesets=this.tileset=this.layerData=this.renderer=null},setRenderer:function(a){this.renderer=a},initArray:function(a,c){this.layerData=[];for(var d=0;a>d;d++){this.layerData[d]=[];for(var b=0;c>b;b++)this.layerData[d][b]=null}},getTileId:function(a,c){var d=this.getTile(a,c);return d?d.tileId:null},getTile:function(a,c){return this.layerData[~~(a/this.tilewidth)][~~(c/this.tileheight)]},setTile:function(a,c,d){d=new me.Tile(a,c,this.tilewidth,this.tileheight,d);return d.tileset=this.tileset.contains(d.tileId)?
this.tileset:this.tileset=this.tilesets.getTilesetByGid(d.tileId),this.layerData[a][c]=d,d},clearTile:function(a,c){this.layerData[a][c]=null;this.visible&&this.preRender&&this.layerSurface.clearRect(a*this.tilewidth,c*this.tileheight,this.tilewidth,this.tileheight)},checkCollision:function(a,c){var d=0>c.x?~~(a.left+c.x):Math.ceil(a.right-1+c.x),b=0>c.y?~~(a.top+c.y):Math.ceil(a.bottom-1+c.y),e={x:0,xtile:void 0,xprop:{},y:0,ytile:void 0,yprop:{}};return 0>=d||d>=this.width?e.x=c.x:0!==c.x&&(e.xtile=
this.getTile(d,Math.ceil(a.bottom-1)),e.xtile&&this.tileset.isTileCollidable(e.xtile.tileId)?(e.x=c.x,e.xprop=this.tileset.getTileProperties(e.xtile.tileId)):(e.xtile=this.getTile(d,~~a.top),e.xtile&&this.tileset.isTileCollidable(e.xtile.tileId)&&(e.x=c.x,e.xprop=this.tileset.getTileProperties(e.xtile.tileId)))),e.ytile=this.getTile(0>c.x?~~a.left:Math.ceil(a.right-1),b),e.ytile&&this.tileset.isTileCollidable(e.ytile.tileId)?(e.y=c.y||1,e.yprop=this.tileset.getTileProperties(e.ytile.tileId)):(e.ytile=
this.getTile(0>c.x?Math.ceil(a.right-1):~~a.left,b),e.ytile&&this.tileset.isTileCollidable(e.ytile.tileId)&&(e.y=c.y||1,e.yprop=this.tileset.getTileProperties(e.ytile.tileId))),e},draw:function(a,c){if(this.preRender){var d=Math.min(c.width,this.width),b=Math.min(c.height,this.height);this.layerSurface.globalAlpha=a.globalAlpha*this.getOpacity();a.drawImage(this.layerCanvas,c.pos.x,c.pos.y,d,b,c.pos.x,c.pos.y,d,b)}else d=a.globalAlpha,a.globalAlpha*=this.getOpacity(),this.renderer.drawTileLayer(a,
this,c),a.globalAlpha=d}})})(window);
(function(){me.TMXTileMap=me.Renderable.extend({init:function(a){this.levelId=a;this.z=0;this.name=null;this.tileheight=this.tilewidth=this.rows=this.cols=0;this.tilesets=null;this.mapLayers=[];this.objectGroups=[];this.orientation=this.version="";this.tilesets=null;this.initialized=!1;this.parent(new me.Vector2d,0,0)},getObjectGroupByName:function(a){var c=null;a=a.trim().toLowerCase();for(var d=this.objectGroups.length;d--;)if(this.objectGroups[d].name.toLowerCase().contains(a)){c=this.objectGroups[d];
break}return c},getObjectGroups:function(){return this.objectGroups},getLayers:function(){return this.mapLayers},getLayerByName:function(a){var c=null;a=a.trim().toLowerCase();for(var d=this.mapLayers.length;d--;)if(this.mapLayers[d].name.toLowerCase().contains(a)){c=this.mapLayers[d];break}return a.toLowerCase().contains(me.COLLISION_LAYER)&&null==c&&(c=new me.CollisionTiledLayer(me.game.currentLevel.width,me.game.currentLevel.height)),c},clearTile:function(a,c){for(var d=this.mapLayers.length;d--;)this.mapLayers[d]instanceof
me.TMXLayer&&this.mapLayers[d].clearTile(a,c)},destroy:function(){var a;if(!0===this.initialized){for(a=this.mapLayers.length;a--;)this.mapLayers[a]=null;for(a=this.objectGroups.length;a--;)this.objectGroups[a].destroy(),this.objectGroups[a]=null;this.tilesets=null;this.mapLayers.length=0;this.objectGroups.length=0;this.pos.set(0,0);this.initialized=!1}}})})(window);
(function(){function a(){return{tmxDoc:null,setData:function(a){this.tmxDoc=a},getFirstElementByTagName:function(a){return this.tmxDoc?this.tmxDoc.getElementsByTagName(a)[0]:null},getAllTagElements:function(){return this.tmxDoc?this.tmxDoc.getElementsByTagName("*"):null},getStringAttribute:function(a,c,d){return(a=a.getAttribute(c))?a.trim():d},getIntAttribute:function(a,c,d){return(a=this.getStringAttribute(a,c,d))?parseInt(a,10):d},getFloatAttribute:function(a,c,d){return(a=this.getStringAttribute(a,
c,d))?parseFloat(a):d},getBooleanAttribute:function(a,c,d){return(a=this.getStringAttribute(a,c,d))?"true"===a:d},free:function(){this.tmxDoc=null}}}me.TMXMapReader=Object.extend({XMLReader:null,JSONReader:null,TMXParser:null,readMap:function(a){if(!a.initialized){if("xml"===me.loader.getTMXFormat(a.levelId)?(null===this.XMLReader&&(this.XMLReader=new c),this.TMXParser=this.XMLReader.TMXParser,this.XMLReader.readXMLMap(a,me.loader.getTMX(a.levelId))):(null===this.JSONReader&&(this.JSONReader=new d),
this.JSONReader.readJSONMap(a,me.loader.getTMX(a.levelId))),a.width<me.game.viewport.width||a.height<me.game.viewport.height){var e=~~((me.game.viewport.width-a.width)/2),g=~~((me.game.viewport.height-a.height)/2);a.pos.add({x:0<e?e:0,y:0<g?g:0})}a.initialized=!0}},getNewDefaultRenderer:function(a){switch(a.orientation){case "orthogonal":return new me.TMXOrthogonalRenderer(a.cols,a.rows,a.tilewidth,a.tileheight);case "isometric":return new me.TMXIsometricRenderer(a.cols,a.rows,a.tilewidth,a.tileheight);
default:throw"melonJS: "+a.orientation+" type TMX Tile Map not supported!";}},setLayerData:function(a,c,d,l){switch(a.initArray(a.cols,a.rows),d){case null:c=c.getElementsByTagName(me.TMX_TAG_TILE);break;case "json":break;case me.TMX_TAG_CSV:case me.TMX_TAG_ATTR_BASE64:for(var k="",n=0,s=c.childNodes.length;s>n;n++)k+=c.childNodes[n].nodeValue;d===me.TMX_TAG_CSV?c=me.utils.decodeCSV(k,a.cols):(c=me.utils.decodeBase64AsArray(k,4),null!==l&&(c=me.utils.decompress(c,l)));break;default:throw"melonJS: TMX Tile Map "+
d+" encoding not supported!";}for(k=l=0;k<a.rows;k++)for(n=0;n<a.cols;n++)s=null==d?this.TMXParser.getIntAttribute(c[l++],me.TMX_TAG_GID):c[l++],0!==s&&(s=a.setTile(n,k,s),a.visible&&a.preRender&&a.renderer.drawTile(a.layerSurface,n,k,s,s.tileset))}});var c=me.TMXMapReader.extend({TMXParser:null,init:function(){this.TMXParser||(this.TMXParser=new a)},readXMLMap:function(a,c){if(!c)throw"melonJS:"+a.levelId+" TMX map not found";var d=0;this.TMXParser.setData(c);for(var l=this.TMXParser.getAllTagElements(),
k=0;k<l.length;k++)switch(l.item(k).nodeName){case me.TMX_TAG_MAP:var n=l.item(k);a.version=this.TMXParser.getStringAttribute(n,me.TMX_TAG_VERSION);a.orientation=this.TMXParser.getStringAttribute(n,me.TMX_TAG_ORIENTATION);a.cols=this.TMXParser.getIntAttribute(n,me.TMX_TAG_WIDTH);a.rows=this.TMXParser.getIntAttribute(n,me.TMX_TAG_HEIGHT);a.tilewidth=this.TMXParser.getIntAttribute(n,me.TMX_TAG_TILEWIDTH);a.tileheight=this.TMXParser.getIntAttribute(n,me.TMX_TAG_TILEHEIGHT);a.width=a.cols*a.tilewidth;
a.height=a.rows*a.tileheight;a.backgroundcolor=this.TMXParser.getStringAttribute(n,me.TMX_BACKGROUND_COLOR);a.z=d++;me.TMXUtils.applyTMXPropertiesFromXML(a,n);a.backgroundcolor&&a.mapLayers.push(new me.ColorLayer("background_color",a.backgroundcolor,d++));a.background_image&&a.mapLayers.push(new me.ImageLayer("background_image",a.width,a.height,a.background_image,d++));null!==me.game.renderer&&me.game.renderer.canRender(a)||(me.game.renderer=this.getNewDefaultRenderer(a));break;case me.TMX_TAG_TILESET:a.tilesets||
(a.tilesets=new me.TMXTilesetGroup);a.tilesets.add(this.readTileset(l.item(k)));break;case me.TMX_TAG_IMAGE_LAYER:a.mapLayers.push(this.readImageLayer(a,l.item(k),d++));break;case me.TMX_TAG_LAYER:a.mapLayers.push(this.readLayer(a,l.item(k),d++));break;case me.TMX_TAG_OBJECTGROUP:a.objectGroups.push(this.readObjectGroup(a,l.item(k),d++))}this.TMXParser.free()},readLayer:function(a,c,d){a=new me.TMXLayer(a.tilewidth,a.tileheight,a.orientation,a.tilesets,d);a.initFromXML(c);c=c.getElementsByTagName(me.TMX_TAG_DATA)[0];
d=this.TMXParser.getStringAttribute(c,me.TMX_TAG_ENCODING,null);var l=this.TMXParser.getStringAttribute(c,me.TMX_TAG_COMPRESSION,null);return""===d&&(d=null),""===l&&(l=null),(!a.isCollisionMap||me.debug.renderCollisionMap)&&a.setRenderer(me.game.renderer.canRender(a)?me.game.renderer:me.mapReader.getNewDefaultRenderer(a)),this.setLayerData(a,c,d,l),a},readImageLayer:function(a,c,d){var l=this.TMXParser.getStringAttribute(c,me.TMX_TAG_NAME),k=this.TMXParser.getIntAttribute(c,me.TMX_TAG_WIDTH),n=this.TMXParser.getIntAttribute(c,
me.TMX_TAG_HEIGHT),s=c.getElementsByTagName(me.TMX_TAG_IMAGE)[0].getAttribute(me.TMX_TAG_SOURCE);a=new me.ImageLayer(l,k*a.tilewidth,n*a.tileheight,s,d);return a.visible=1===this.TMXParser.getIntAttribute(c,me.TMX_TAG_VISIBLE,1),a.setOpacity(this.TMXParser.getFloatAttribute(c,me.TMX_TAG_OPACITY,1)),me.TMXUtils.applyTMXPropertiesFromXML(a,c),"number"==typeof a.ratio&&(a.ratio=new me.Vector2d(parseFloat(a.ratio),parseFloat(a.ratio))),a},readTileset:function(a){var c=new me.TMXTileset;return c.initFromXML(a),
c},readObjectGroup:function(a,c,d){var l=this.TMXParser.getStringAttribute(c,me.TMX_TAG_NAME),k=new me.TMXObjectGroup;return k.initFromXML(l,c,a.tilesets,d),k}}),d=me.TMXMapReader.extend({readJSONMap:function(a,c){if(!c)throw"melonJS:"+a.levelId+" TMX map not found";var d=0,l=this;a.version=c[me.TMX_TAG_VERSION];a.orientation=c[me.TMX_TAG_ORIENTATION];a.cols=parseInt(c[me.TMX_TAG_WIDTH],10);a.rows=parseInt(c[me.TMX_TAG_HEIGHT],10);a.tilewidth=parseInt(c[me.TMX_TAG_TILEWIDTH],10);a.tileheight=parseInt(c[me.TMX_TAG_TILEHEIGHT],
10);a.width=a.cols*a.tilewidth;a.height=a.rows*a.tileheight;a.backgroundcolor=c[me.TMX_BACKGROUND_COLOR];a.z=d++;me.TMXUtils.applyTMXPropertiesFromJSON(a,c);a.backgroundcolor&&a.mapLayers.push(new me.ColorLayer("background_color",a.backgroundcolor,d++));a.background_image&&a.mapLayers.push(new me.ImageLayer("background_image",a.width,a.height,a.background_image,d++));null!==me.game.renderer&&me.game.renderer.canRender(a)||(me.game.renderer=this.getNewDefaultRenderer(a));a.tilesets||(a.tilesets=new me.TMXTilesetGroup);
c.tilesets.forEach(function(c){a.tilesets.add(l.readTileset(c))});c.layers.forEach(function(c){switch(c.type){case me.TMX_TAG_IMAGE_LAYER:a.mapLayers.push(l.readImageLayer(a,c,d++));break;case me.TMX_TAG_TILE_LAYER:a.mapLayers.push(l.readLayer(a,c,d++));break;case me.TMX_TAG_OBJECTGROUP:a.objectGroups.push(l.readObjectGroup(a,c,d++))}})},readLayer:function(a,c,d){a=new me.TMXLayer(a.tilewidth,a.tileheight,a.orientation,a.tilesets,d);return a.initFromJSON(c),a.isCollisionMap||a.setRenderer(me.game.renderer.canRender(a)?
me.game.renderer:me.mapReader.getNewDefaultRenderer(a)),this.setLayerData(a,c[me.TMX_TAG_DATA],"json",null),a},readImageLayer:function(a,c,d){var l=c[me.TMX_TAG_NAME],k=parseInt(c[me.TMX_TAG_WIDTH],10),n=parseInt(c[me.TMX_TAG_HEIGHT],10);a=new me.ImageLayer(l,k*a.tilewidth,n*a.tileheight,c[me.TMX_TAG_IMAGE],d);return a.visible=c[me.TMX_TAG_VISIBLE],a.setOpacity(parseFloat(c[me.TMX_TAG_OPACITY])),me.TMXUtils.applyTMXPropertiesFromJSON(a,c),"number"==typeof a.ratio&&(a.ratio=new me.Vector2d(parseFloat(a.ratio),
parseFloat(a.ratio))),a},readTileset:function(a){var c=new me.TMXTileset;return c.initFromJSON(a),c},readObjectGroup:function(a,c,d){var l=new me.TMXObjectGroup;return l.initFromJSON(c[me.TMX_TAG_NAME],c,a.tilesets,d),l}})})(window);
(function(){me.levelDirector=function(){var a={},c={},d=[],b=0;return a.reset=function(){},a.addLevel=function(){throw"melonJS: no level loader defined";},a.addTMXLevel=function(a,b){return null!=c[a]?!1:(c[a]=new me.TMXTileMap(a),c[a].name=a,d.push(a),b&&b(),!0)},a.loadLevel=function(e){if(e=e.toString().toLowerCase(),void 0===c[e])throw"melonJS: level "+e+" not found";if(!(c[e]instanceof me.TMXTileMap))throw"melonJS: no level loader defined";var g=me.state.isRunning();g&&me.state.stop();me.game.reset();
me.utils.resetGUID(e);c[a.getCurrentLevelId()]&&c[a.getCurrentLevelId()].destroy();me.mapReader.readMap(c[e]);b=d.indexOf(e);e=c[e];var l=me.game.world;l.autoSort=!1;me.game.currentLevel=e;me.game.collisionMap=me.game.currentLevel.getLayerByName("collision");me.game.collisionMap&&me.game.collisionMap.isCollisionMap||console.error("WARNING : no collision map detected");for(var k=e.getLayers(),n=k.length;n--;)k[n].visible&&l.addChild(k[n]);me.game.viewport.setBounds(0,0,Math.max(e.width,me.game.viewport.width),
Math.max(e.height,me.game.viewport.height));for(var k=l,n=e.getObjectGroups(),s=0;s<n.length;s++){var u=n[s];!1===me.game.mergeGroup&&(k=new me.ObjectContainer,k.name=u.name,k.visible=u.visible,k.z=u.z,k.setOpacity(u.opacity),k.autoSort=!1);for(var t=0;t<u.objects.length;t++){var r=u.objects[t];(r=me.pool.pull(r.name,r.x,r.y,r))&&(r.z=u.z,!0===me.game.mergeGroup&&!0===r.isRenderable&&(r.setOpacity(r.getOpacity()*u.opacity),null!==r.renderable&&r.renderable.setOpacity(r.renderable.getOpacity()*u.opacity)),
k.addChild(r))}!1===me.game.mergeGroup&&(l.addChild(k),k.autoSort=!0)}l.sort(!0);l.autoSort=!0;me.game.world.transform.translateV(me.game.currentLevel.pos);me.game.onLevelLoaded&&me.game.onLevelLoaded.call(me.game.onLevelLoaded,e.name);me.event.publish(me.event.LEVEL_LOADED,[e.name]);return g&&me.state.restart.defer(this),!0},a.getCurrentLevelId=function(){return d[b]},a.reloadLevel=function(){return a.loadLevel(a.getCurrentLevelId())},a.nextLevel=function(){return b+1<d.length?a.loadLevel(d[b+1]):
!1},a.previousLevel=function(){return 0<=b-1?a.loadLevel(d[b-1]):!1},a.levelCount=function(){return d.length},a}()})(window);
(function(){me.Tween=function(a){var c=a,d={},b={},e={},g=1E3,l=0,k=!1,n=0,s=null,u=me.Tween.Easing.Linear.None,t=me.Tween.Interpolation.Linear,r=[],h=null,m=!1,p=null,y=null,C;for(C in a)d[C]=parseFloat(a[C],10);this.onResetEvent=function(a){c=a;d={};b={};e={};u=me.Tween.Easing.Linear.None;t=me.Tween.Interpolation.Linear;k=!1;g=1E3;n=0;h=null;m=!1;y=p=null};this.to=function(a,c){return void 0!==c&&(g=c),b=a,this};this.start=function(a){m=!1;me.game.world.addChild(this);s=("undefined"==typeof a?me.timer.getTime():
a)+n;for(var h in b){if(b[h]instanceof Array){if(0===b[h].length)continue;b[h]=[c[h]].concat(b[h])}d[h]=c[h];!1==d[h]instanceof Array&&(d[h]*=1);e[h]=d[h]||0}return this};this.stop=function(){return me.game.world.hasChild(this)&&me.game.world.removeChildNow(this),this};this.delay=function(a){return n=a,this};me.event.subscribe(me.event.STATE_RESUME,function(a){s&&(s+=a)});this.repeat=function(a){return l=a,this};this.yoyo=function(a){return k=a,this};this.easing=function(a){if("function"!=typeof a)throw"melonJS: invalid easing function for me.Tween.easing()";
return u=a,this};this.interpolation=function(a){return t=a,this};this.chain=function(){return r=arguments,this};this.onStart=function(a){return h=a,this};this.onUpdate=function(a){return p=a,this};this.onComplete=function(a){return y=a,this};this.update=function(){var a,C=me.timer.getTime();if(s>C)return!0;!1===m&&(null!==h&&h.call(c),m=!0);var H=(C-s)/g,H=1<H?1:H,Q=u(H);for(a in b){var S=d[a]||0,A=b[a];A instanceof Array?c[a]=t(A,Q):("string"==typeof A&&(A=S+parseFloat(A,10)),"number"==typeof A&&
(c[a]=S+(A-S)*Q))}if(null!==p&&p.call(c,Q),1===H){if(0<l){isFinite(l)&&l--;for(a in e){if("string"==typeof b[a]&&(e[a]+=parseFloat(b[a],10)),k)H=e[a],e[a]=b[a],b[a]=H;d[a]=e[a]}return s=C+n,!0}me.game.world.removeChildNow(this);null!==y&&y.call(c);a=0;for(H=r.length;H>a;a++)r[a].start(C);return!1}return!0}};me.Tween.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?0.5*a*a:-0.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*
a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*a:0.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?0.5*a*a*a*a:-0.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*a*a*a:0.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/
2)},InOut:function(a){return 0.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?0.5*Math.pow(1024,a-1):0.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>(a*=2)?-0.5*(Math.sqrt(1-a*a)-1):0.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){var c,d=0.1;
return 0===a?0:1===a?1:(!d||1>d?(d=1,c=0.1):c=0.4*Math.asin(1/d)/(2*Math.PI),-(d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-c)*Math.PI/0.4)))},Out:function(a){var c,d=0.1;return 0===a?0:1===a?1:(!d||1>d?(d=1,c=0.1):c=0.4*Math.asin(1/d)/(2*Math.PI),d*Math.pow(2,-10*a)*Math.sin(2*(a-c)*Math.PI/0.4)+1)},InOut:function(a){var c,d=0.1;return 0===a?0:1===a?1:(!d||1>d?(d=1,c=0.1):c=0.4*Math.asin(1/d)/(2*Math.PI),1>(a*=2)?-0.5*d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-c)*Math.PI/0.4):0.5*d*Math.pow(2,-10*(a-=1))*Math.sin(2*
(a-c)*Math.PI/0.4)+1)}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*(3.5949095*a-2.5949095):0.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-me.Tween.Easing.Bounce.Out(1-a)},Out:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+0.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},InOut:function(a){return 0.5>a?0.5*me.Tween.Easing.Bounce.In(2*
a):0.5*me.Tween.Easing.Bounce.Out(2*a-1)+0.5}}};me.Tween.Interpolation={Linear:function(a,c){var d=a.length-1,b=d*c,e=Math.floor(b),g=me.Tween.Interpolation.Utils.Linear;return 0>c?g(a[0],a[1],b):1<c?g(a[d],a[d-1],d-b):g(a[e],a[e+1>d?d:e+1],b-e)},Bezier:function(a,c){var d,b=0,e=a.length-1,g=Math.pow,l=me.Tween.Interpolation.Utils.Bernstein;for(d=0;e>=d;d++)b+=g(1-c,e-d)*g(c,d)*a[d]*l(e,d);return b},CatmullRom:function(a,c){var d=a.length-1,b=d*c,e=Math.floor(b),g=me.Tween.Interpolation.Utils.CatmullRom;
return a[0]===a[d]?(0>c&&(e=Math.floor(b=d*(1+c))),g(a[(e-1+d)%d],a[e],a[(e+1)%d],a[(e+2)%d],b-e)):0>c?a[0]-(g(a[0],a[0],a[1],a[1],-b)-a[0]):1<c?a[d]-(g(a[d],a[d],a[d-1],a[d-1],b-d)-a[d]):g(a[e?e-1:0],a[e],a[e+1>d?d:e+1],a[e+2>d?d:e+2],b-e)},Utils:{Linear:function(a,c,d){return(c-a)*d+a},Bernstein:function(a,c){var d=me.Tween.Interpolation.Utils.Factorial;return d(a)/d(c)/d(a-c)},Factorial:function(){var a=[1];return function(c){var d,b=1;if(a[c])return a[c];for(d=c;1<d;d--)b*=d;return a[c]=b}}(),
CatmullRom:function(a,c,d,b,e){a=0.5*(d-a);b=0.5*(b-c);var g=e*e;return(2*c-2*d+a+b)*e*g+(-3*c+3*d-2*a-b)*g+a*e+c}}}})();
(function(){me.event=function(){var a={},c={};return a.STATE_PAUSE="me.state.onPause",a.STATE_RESUME="me.state.onResume",a.STATE_STOP="me.state.onStop",a.STATE_RESTART="me.state.onRestart",a.GAME_INIT="me.game.onInit",a.LEVEL_LOADED="me.game.onLevelLoaded",a.LOADER_COMPLETE="me.loader.onload",a.LOADER_PROGRESS="me.loader.onProgress",a.KEYDOWN="me.input.keydown",a.KEYUP="me.input.keyup",a.MOUSEMOVE="me.game.mousemove",a.DRAGSTART="me.game.dragstart",a.DRAGEND="me.game.dragend",a.WINDOW_ONRESIZE="window.onresize",
a.WINDOW_ONORIENTATION_CHANGE="window.orientationchange",a.WINDOW_ONSCROLL="window.onscroll",a.VIEWPORT_ONCHANGE="viewport.onchange",a.publish=function(a,b){for(var e=c[a],g=e?e.length:0;g--;)e[g].apply(window,b||[])},a.subscribe=function(a,b){return c[a]||(c[a]=[]),c[a].push(b),[a,b]},a.unsubscribe=function(a,b){var e=c[b?a:a[0]],g=e?e.length:0;for(b=b||a[1];g--;)e[g]===b&&e.splice(g,1)},a}()})();
(function(){var a={},c=null,d=!0,b=!1;if("undefined"!=typeof AudioContext)c=new AudioContext;else if("undefined"!=typeof webkitAudioContext)c=new webkitAudioContext;else if("undefined"!=typeof Audio){d=!1;try{new Audio}catch(e){b=!0}}else d=!1,b=!0;if(d){var g="undefined"==typeof c.createGain?c.createGainNode():c.createGain();g.gain.value=1;g.connect(c.destination)}var l=function(){this._volume=1;this._muted=!1;this.usingWebAudio=d;this.noAudio=b;this._howls=[]};l.prototype={volume:function(a){if(a=
parseFloat(a),0<=a&&1>=a){this._volume=a;d&&(g.gain.value=a);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&!1===this._howls[c]._webAudio)for(a=0;a<this._howls[c]._audioNode.length;a++)this._howls[c]._audioNode[a].volume=this._howls[c]._volume*this._volume;return this}return d?g.gain.value:this._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(a){this._muted=a;d&&(g.gain.value=a?0:this._volume);for(var c in this._howls)if(this._howls.hasOwnProperty(c)&&
!1===this._howls[c]._webAudio)for(var b=0;b<this._howls[c]._audioNode.length;b++)this._howls[c]._audioNode[b].muted=a}};var k=new l,l=null;if(!b)var l=new Audio,n={mp3:!!l.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!l.canPlayType('audio/ogg; codecs\x3d"opus"').replace(/^no$/,""),ogg:!!l.canPlayType('audio/ogg; codecs\x3d"vorbis"').replace(/^no$/,""),wav:!!l.canPlayType('audio/wav; codecs\x3d"1"').replace(/^no$/,""),m4a:!!(l.canPlayType("audio/x-m4a;")||l.canPlayType("audio/aac;")).replace(/^no$/,
""),mp4:!!(l.canPlayType("audio/x-mp4;")||l.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!l.canPlayType('audio/webm; codecs\x3d"vorbis"').replace(/^no$/,"")};var s=function(a){this._autoplay=a.autoplay||!1;this._buffer=a.buffer||!1;this._duration=a.duration||0;this._format=a.format||null;this._loop=a.loop||!1;this._loaded=!1;this._sprite=a.sprite||{};this._src=a.src||"";this._pos3d=a.pos3d||[0,0,-0.5];this._volume=void 0!==a.volume?a.volume:1;this._urls=a.urls||[];this._rate=a.rate||1;this._onload=
[a.onload||function(){}];this._onloaderror=[a.onloaderror||function(){}];this._onend=[a.onend||function(){}];this._onpause=[a.onpause||function(){}];this._onplay=[a.onplay||function(){}];this._onendTimer=[];this._webAudio=d&&!this._buffer;this._audioNode=[];this._webAudio&&this._setupAudioNode();k._howls.push(this);this.load()};if(s.prototype={load:function(){var c=this,d=null;if(b)return void c.on("loaderror");for(var e=0;e<c._urls.length;e++){var g,l;if(c._format)g=c._format;else{if(l=c._urls[e].toLowerCase().split("?")[0],
g=l.match(/.+\.([^?]+)(\?|$)/),g=g&&2<=g.length?g:l.match(/data\:audio\/([^?]+);/),!g)return void c.on("loaderror");g=g[1]}if(n[g]){d=c._urls[e];break}}if(!d)return void c.on("loaderror");if(c._src=d,c._webAudio)u(c,d);else{var r=new Audio;c._audioNode.push(r);r.src=d;r._pos=0;r.preload="auto";r.volume=k._muted?0:c._volume*k.volume();a[d]=c;var s=function(){c._duration=Math.ceil(10*r.duration)/10;0===Object.getOwnPropertyNames(c._sprite).length&&(c._sprite={_default:[0,1E3*c._duration]});c._loaded||
(c._loaded=!0,c.on("load"));c._autoplay&&c.play();r.removeEventListener("canplaythrough",s,!1)};r.addEventListener("canplaythrough",s,!1);r.load()}return c},urls:function(a){return a?(this.stop(),this._urls="string"==typeof a?[a]:a,this._loaded=!1,this.load(),this):this._urls},play:function(a,b){var d=this;return"function"==typeof a&&(b=a),a&&"function"!=typeof a||(a="_default"),d._loaded?d._sprite[a]?(d._inactiveNode(function(e){e._sprite=a;var g,l=0<e._pos?e._pos:d._sprite[a][0]/1E3,n=d._sprite[a][1]/
1E3-e._pos,s=!(!d._loop&&!d._sprite[a][2]),t="string"==typeof b?b:Math.round(Date.now()*Math.random())+"";if(function(){var c={id:t,sprite:a,loop:s};g=setTimeout(function(){!d._webAudio&&s&&d.stop(c.id,c.timer).play(a,c.id);d._webAudio&&!s&&(d._nodeById(c.id).paused=!0,d._nodeById(c.id)._pos=0);d._webAudio||s||d.stop(c.id,c.timer);d.on("end",t)},1E3*n);d._onendTimer.push(g);c.timer=d._onendTimer[d._onendTimer.length-1]}(),d._webAudio){var u=d._sprite[a][0]/1E3,A=d._sprite[a][1]/1E3;e.id=t;e.paused=
!1;r(d,[s,u,A],t);d._playStart=c.currentTime;e.gain.value=d._volume;"undefined"==typeof e.bufferSource.start?e.bufferSource.noteGrainOn(0,l,n):e.bufferSource.start(0,l,n)}else{if(4!==e.readyState)return d._clearEndTimer(g),function(){var c=a,g=b,k=function(){d.play(c,g);e.removeEventListener("canplaythrough",k,!1)};e.addEventListener("canplaythrough",k,!1)}(),d;e.id=t;e.currentTime=l;e.muted=k._muted;e.volume=d._volume*k.volume();setTimeout(function(){e.play()},0)}return d.on("play"),"function"==
typeof b&&b(t),d}),d):("function"==typeof b&&b(),d):(d.on("load",function(){d.play(a,b)}),d)},pause:function(a,c){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(c||0);var d=a?b._nodeById(a):b._activeNode();if(d)if(d._pos=b.pos(null,a),b._webAudio){if(!d.bufferSource||d.paused)return b;d.paused=!0;"undefined"==typeof d.bufferSource.stop?d.bufferSource.noteOff(0):d.bufferSource.stop(0)}else d.pause();return b.on("pause"),b},stop:function(a,c){var b=this;if(!b._loaded)return b.on("play",
function(){b.stop(a)}),b;b._clearEndTimer(c||0);var d=a?b._nodeById(a):b._activeNode();if(d)if(d._pos=0,b._webAudio){if(!d.bufferSource||d.paused)return b;d.paused=!0;"undefined"==typeof d.bufferSource.stop?d.bufferSource.noteOff(0):d.bufferSource.stop(0)}else d.pause(),d.currentTime=0;return b},mute:function(a){var c=this;if(!c._loaded)return c.on("play",function(){c.mute(a)}),c;var b=a?c._nodeById(a):c._activeNode();return b&&(c._webAudio?b.gain.value=0:b.volume=0),c},unmute:function(a){var c=this;
if(!c._loaded)return c.on("play",function(){c.unmute(a)}),c;var b=a?c._nodeById(a):c._activeNode();return b&&(c._webAudio?b.gain.value=c._volume:b.volume=c._volume),c},volume:function(a,c){var b=this;if(a=parseFloat(a),0<=a&&1>=a){if(b._volume=a,!b._loaded)return b.on("play",function(){b.volume(a,c)}),b;var d=c?b._nodeById(c):b._activeNode();return d&&(b._webAudio?d.gain.value=a:d.volume=a*k.volume()),b}return b._volume},loop:function(a){return"boolean"==typeof a?(this._loop=a,this):this._loop},sprite:function(a){return"object"==
typeof a?(this._sprite=a,this):this._sprite},pos:function(a,b){var d=this;if(!d._loaded)return d.on("load",function(){d.pos(a)}),"number"==typeof a?d:d._pos||0;a=parseFloat(a);var e=b?d._nodeById(b):d._activeNode();if(e)return 0<=a?(d.pause(b),e._pos=a,d.play(e._sprite,b),d):d._webAudio?e._pos+(c.currentTime-d._playStart):e.currentTime;if(0<=a)return d;for(e=0;e<d._audioNode.length;e++)if(d._audioNode[e].paused&&4===d._audioNode[e].readyState)return d._webAudio?d._audioNode[e]._pos:d._audioNode[e].currentTime},
pos3d:function(a,c,b,d){var e=this;if(c="undefined"!=typeof c&&c?c:0,b="undefined"!=typeof b&&b?b:-0.5,!e._loaded)return e.on("play",function(){e.pos3d(a,c,b,d)}),e;if(!(0<=a||0>a))return e._pos3d;if(e._webAudio){var g=d?e._nodeById(d):e._activeNode();g&&(e._pos3d=[a,c,b],g.panner.setPosition(a,c,b))}return e},fade:function(a,c,b,d,e){var g=this,k=Math.abs(a-c),l=a>c?"down":"up",k=k/0.01,n=b/k;if(!g._loaded)return g.on("load",function(){g.fade(a,c,b,d,e)}),g;g.volume(a,e);for(var r=1;k>=r;r++)!function(){var a=
Math.round(1E3*(g._volume+("up"===l?0.01:-0.01)*r))/1E3;setTimeout(function(){g.volume(a,e);a===c&&d&&d()},n*r)}()},fadeIn:function(a,c,b){return this.volume(0).play().fade(0,a,c,b)},fadeOut:function(a,c,b,d){var e=this;return e.fade(e._volume,a,c,function(){b&&b();e.pause(d);e.on("end")},d)},_nodeById:function(a){for(var c=this._audioNode[0],b=0;b<this._audioNode.length;b++)if(this._audioNode[b].id===a){c=this._audioNode[b];break}return c},_activeNode:function(){for(var a=null,c=0;c<this._audioNode.length;c++)if(!this._audioNode[c].paused){a=
this._audioNode[c];break}return this._drainPool(),a},_inactiveNode:function(a){for(var c=null,b=0;b<this._audioNode.length;b++)if(this._audioNode[b].paused&&4===this._audioNode[b].readyState){a(this._audioNode[b]);c=!0;break}if(this._drainPool(),!c){var d;this._webAudio?(d=this._setupAudioNode(),a(d)):(this.load(),d=this._audioNode[this._audioNode.length-1],d.addEventListener("loadedmetadata",function(){a(d)}))}},_drainPool:function(){var a,c=0;for(a=0;a<this._audioNode.length;a++)this._audioNode[a].paused&&
c++;for(a=this._audioNode.length-1;0<=a&&!(5>=c);a--)this._audioNode[a].paused&&(this._webAudio&&this._audioNode[a].disconnect(0),c--,this._audioNode.splice(a,1))},_clearEndTimer:function(a){a=this._onendTimer.indexOf(a);a=0<=a?a:0;this._onendTimer[a]&&(clearTimeout(this._onendTimer[a]),this._onendTimer.splice(a,1))},_setupAudioNode:function(){var a=this._audioNode,b=this._audioNode.length;return a[b]="undefined"==typeof c.createGain?c.createGainNode():c.createGain(),a[b].gain.value=this._volume,
a[b].paused=!0,a[b]._pos=0,a[b].readyState=4,a[b].connect(g),a[b].panner=c.createPanner(),a[b].panner.setPosition(this._pos3d[0],this._pos3d[1],this._pos3d[2]),a[b].panner.connect(a[b]),a[b]},on:function(a,c){var b=this["_on"+a];if("function"==typeof c)b.push(c);else for(var d=0;d<b.length;d++)c?b[d].call(this,c):b[d].call(this);return this},off:function(a,c){for(var b=this["_on"+a],d=c.toString(),e=0;e<b.length;e++)if(d===b[e].toString()){b.splice(e,1);break}return this},unload:function(){for(var c=
this._audioNode,b=0;b<this._audioNode.length;b++)c[b].paused||this.stop(c[b].id),this._webAudio?c[b].disconnect(0):c[b].src="";c=k._howls.indexOf(this);null!==c&&0<=c&&k._howls.splice(c,1);delete a[this._src]}},d)var u=function(b,d){if(d in a)b._duration=a[d].duration,t(b);else{var e=new XMLHttpRequest;e.open("GET",d,!0);e.responseType="arraybuffer";e.onload=function(){c.decodeAudioData(e.response,function(c){c&&(a[d]=c,t(b,c))},function(){b.on("loaderror")})};e.onerror=function(){b._webAudio&&(b._buffer=
!0,b._webAudio=!1,b._audioNode=[],delete b._gainNode,b.load())};try{e.send()}catch(g){e.onerror()}}},t=function(a,c){a._duration=c?c.duration:a._duration;0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1E3*a._duration]});a._loaded||(a._loaded=!0,a.on("load"));a._autoplay&&a.play()},r=function(b,d,e){e=b._nodeById(e);e.bufferSource=c.createBufferSource();e.bufferSource.buffer=a[b._src];e.bufferSource.connect(e.panner);e.bufferSource.loop=d[0];d[0]&&(e.bufferSource.loopStart=
d[1],e.bufferSource.loopEnd=d[1]+d[2]);e.bufferSource.playbackRate.value=b._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:k,Howl:s}});"undefined"!=typeof exports&&(exports.Howler=k,exports.Howl=s);window.Howler=k;window.Howl=s})();
(function(){me.plugin=function(){var a={};return a.Base=Object.extend({version:void 0,init:function(){}}),a.patch=function(a,d,b){if(void 0!==a.prototype&&(a=a.prototype),"function"==typeof a[d]){var e=a[d];a[d]=function(a,c){return function(){var a=this.parent;this.parent=e;var b=c.apply(this,arguments);return this.parent=a,b}}(d,b)}else console.error(d+" is not an existing function")},a.register=function(a,d){if(me.plugin[d]&&console.error("plugin "+d+" already registered"),void 0===a.prototype.version)throw"melonJS: Plugin version not defined !";
if(0<me.sys.checkVersion(a.prototype.version))throw"melonJS: Plugin version mismatch, expected: "+a.prototype.version+", got: "+me.version;var b=[];if(2<arguments.length&&(b=Array.prototype.slice.call(arguments,1)),b[0]=a,me.plugin[d]=new (a.bind.apply(a,b)),!(me.plugin[d]instanceof me.plugin.Base))throw"melonJS: Plugin should extend the me.plugin.Base Class !";},a}()})();
me.DraggableEntity=function(a,c,d,b){return a.extend({init:function(a,d,l){this.parent(a,d,l);this.dragging=!1;this.dragId=null;this.grabOffset=new b(0,0);this.onPointerEvent=c.registerPointerEvent;this.removePointerEvent=c.releasePointerEvent;this.initEvents()},initEvents:function(){var a=this;this.mouseDown=function(a){this.translatePointerEvent(a,d.DRAGSTART)};this.mouseUp=function(a){this.translatePointerEvent(a,d.DRAGEND)};this.onPointerEvent("mousedown",this,this.mouseDown.bind(this));this.onPointerEvent("mouseup",
this,this.mouseUp.bind(this));d.subscribe(d.MOUSEMOVE,this.dragMove.bind(this));d.subscribe(d.DRAGSTART,function(c,b){b===a&&a.dragStart(c)});d.subscribe(d.DRAGEND,function(c,b){b===a&&a.dragEnd(c)})},translatePointerEvent:function(a,c){d.publish(c,[a,this])},dragStart:function(a){return!1===this.dragging?(this.dragging=!0,this.dragId=a.pointerId,this.grabOffset.set(a.gameX,a.gameY),this.grabOffset.sub(this.pos),!1):void 0},dragMove:function(a){!0===this.dragging&&this.dragId===a.pointerId&&(this.pos.set(a.gameX,
a.gameY),this.pos.sub(this.grabOffset))},dragEnd:function(){return!0===this.dragging?(this.pointerId=void 0,this.dragging=!1,!1):void 0},destroy:function(){d.unsubscribe(d.MOUSEMOVE,this.dragMove);d.unsubscribe(d.DRAGSTART,this.dragStart);d.unsubscribe(d.DRAGEND,this.dragEnd);this.removePointerEvent("mousedown",this);this.removePointerEvent("mouseup",this)}})}(me.ObjectEntity,me.input,me.event,me.Vector2d);
me.DroptargetEntity=function(a,c){return a.extend({CHECKMETHOD_OVERLAP:"overlaps",CHECKMETHOD_CONTAINS:"contains",checkMethod:null,init:function(a,b,e){this.parent(a,b,e);c.subscribe(c.DRAGEND,this.checkOnMe.bind(this));this.checkMethod=this[this.CHECKMETHOD_OVERLAP]},setCheckMethod:function(a){void 0!==this[a]&&(this.checkMethod=this[a])},checkOnMe:function(a,c){c&&this.checkMethod(c.getBounds().translateV(c.pos))&&this.drop(c)},drop:function(){},destroy:function(){c.unsubscribe(c.DRAGEND,this.checkOnMe)}})}(me.ObjectEntity,
me.event,me.Rect);
(function(){var a=function(){var a=me.video.createCanvas(1,1),d=me.video.getContext2d(a);return d.fillStyle="#fff",d.fillRect(0,0,1,1),a}();me.ParticleEmitterSettings={width:0,height:0,image:a,totalParticles:50,angle:Math.PI/2,angleVariation:0,minLife:1E3,maxLife:3E3,speed:2,speedVariation:1,minRotation:0,maxRotation:0,minStartScale:1,maxStartScale:1,minEndScale:0,maxEndScale:0,gravity:0,wind:0,followTrajectory:!1,textureAdditive:!1,onlyInViewport:!0,floating:!1,maxParticles:10,frequency:100,duration:1/
0,framesToSkip:0};me.ParticleEmitter=me.Rect.extend({_stream:!1,_frequencyTimer:0,_durationTimer:0,_enabled:!1,isRenderable:!1,init:function(a,d,b){this.parent(new me.Vector2d(a,d),1/0,1/0);this.autoSort=!1;this.container=new me.ParticleContainer(this);Object.defineProperty(this,"z",{get:function(){return this.container.z},set:function(a){this.container.z=a},enumerable:!0,configurable:!0});Object.defineProperty(this,"floating",{get:function(){return this.container.floating},set:function(a){this.container.floating=
a},enumerable:!0,configurable:!0});this.reset(b)},destroy:function(){this.reset()},getRandomPoint:function(){var a=this.pos.clone();return a.x+=Number.prototype.random(-this.hWidth,this.hWidth),a.y+=Number.prototype.random(-this.hHeight,this.hHeight),a},reset:function(a){a=a||{};var d=me.ParticleEmitterSettings;this.resize("number"==typeof a.width?a.width:d.width,"number"==typeof a.height?a.height:d.height);this.image=a.image||d.image;this.totalParticles="number"==typeof a.totalParticles?a.totalParticles:
d.totalParticles;this.angle="number"==typeof a.angle?a.angle:d.angle;this.angleVariation="number"==typeof a.angleVariation?a.angleVariation:d.angleVariation;this.minLife="number"==typeof a.minLife?a.minLife:d.minLife;this.maxLife="number"==typeof a.maxLife?a.maxLife:d.maxLife;this.speed="number"==typeof a.speed?a.speed:d.speed;this.speedVariation="number"==typeof a.speedVariation?a.speedVariation:d.speedVariation;this.minRotation="number"==typeof a.minRotation?a.minRotation:d.minRotation;this.maxRotation=
"number"==typeof a.maxRotation?a.maxRotation:d.maxRotation;this.minStartScale="number"==typeof a.minStartScale?a.minStartScale:d.minStartScale;this.maxStartScale="number"==typeof a.maxStartScale?a.maxStartScale:d.maxStartScale;this.minEndScale="number"==typeof a.minEndScale?a.minEndScale:d.minEndScale;this.maxEndScale="number"==typeof a.maxEndScale?a.maxEndScale:d.maxEndScale;this.gravity="number"==typeof a.gravity?a.gravity:d.gravity;this.wind="number"==typeof a.wind?a.wind:d.wind;this.followTrajectory=
"boolean"==typeof a.followTrajectory?a.followTrajectory:d.followTrajectory;this.textureAdditive="boolean"==typeof a.textureAdditive?a.textureAdditive:d.textureAdditive;this.onlyInViewport="boolean"==typeof a.onlyInViewport?a.onlyInViewport:d.onlyInViewport;this.floating="boolean"==typeof a.floating?a.floating:d.floating;this.maxParticles="number"==typeof a.maxParticles?a.maxParticles:d.maxParticles;this.frequency="number"==typeof a.frequency?a.frequency:d.frequency;this.duration="number"==typeof a.duration?
a.duration:d.duration;this.framesToSkip="number"==typeof a.framesToSkip?a.framesToSkip:d.framesToSkip;this.container.destroy()},addParticles:function(a){for(var d=0;~~a>d;d++){var b=me.pool.pull("me.Particle",this);b.isRenderable=!1;this.container.addChild(b)}},isRunning:function(){return this._enabled&&this._stream},streamParticles:function(a){this._stream=this._enabled=!0;this.frequency=Math.max(this.frequency,1);this._durationTimer="number"==typeof a?a:this.duration},stopStream:function(){this._enabled=
!1},burstParticles:function(a){this._enabled=!0;this._stream=!1;this.addParticles("number"==typeof a?a:this.totalParticles);this._enabled=!1},update:function(a){if(this._enabled&&this._stream){if(1/0!==this._durationTimer&&(this._durationTimer-=a,0>=this._durationTimer))return this.stopStream(),!1;this._frequencyTimer+=a;a=this.container.children.length;a<this.totalParticles&&this._frequencyTimer>=this.frequency&&(this.addParticles(a+this.maxParticles<=this.totalParticles?this.maxParticles:this.totalParticles-
a),this._frequencyTimer=0)}return!0}})})(window);
(function(){me.ParticleContainer=me.ObjectContainer.extend({init:function(a){this.parent();this.autoSort=!1;this._dt=this._updateCount=0;this._emitter=a},update:function(a){if(++this._updateCount>this._emitter.framesToSkip&&(this._updateCount=0),0<this._updateCount)return this._dt+=a,!1;a+=this._dt;this._dt=0;for(var c=me.game.viewport,d=this.children.length-1;0<=d;--d){var b=this.children[d];b.isRenderable=!0;b.inViewport=this.floating||b.pos.x<c.pos.x+c.width&&c.pos.x<b.pos.x+b.width&&b.pos.y<c.pos.y+
c.height&&c.pos.y<b.pos.y+b.height;b.update(a)||this.removeChildNow(b)}return!0},draw:function(a,c){if(0<this.children.length){var d;this._emitter.textureAdditive&&(d=a.globalCompositeOperation,a.globalCompositeOperation="lighter");this.parent(a,c);this._emitter.textureAdditive&&(a.globalCompositeOperation=d)}}})})(window);
(function(){me.Particle=me.Renderable.extend({init:function(a){this.parent(a.getRandomPoint(),a.image.width,a.image.height);this.alwaysUpdate=!0;this.image=a.image;var c=a.angle+(0<a.angleVariation?(2*Math.random()-1)*a.angleVariation:0),d=a.speed+(0<a.speedVariation?(2*Math.random()-1)*a.speedVariation:0);this.vel=new me.Vector2d(d*Math.cos(c),-d*Math.sin(c));this.startLife=this.life=Number.prototype.random(a.minLife,a.maxLife);this.startScale=Number.prototype.random(a.minStartScale,a.maxStartScale).clamp(a.minStartScale,
a.maxStartScale);this.endScale=Number.prototype.random(a.minEndScale,a.maxEndScale).clamp(a.minEndScale,a.maxEndScale);this.gravity=a.gravity;this.wind=a.wind;this.followTrajectory=a.followTrajectory;this.onlyInViewport=a.onlyInViewport;this.z=a.z;this._deltaInv=me.sys.fps/1E3;this.transform=new me.Matrix2d;a.followTrajectory||(this.angle=Number.prototype.random(a.minRotation,a.maxRotation))},update:function(a){var c=a*this._deltaInv;this.life=this.life>a?this.life-a:0;var d=this.life/this.startLife;
a=this.startScale;this.startScale>this.endScale?(a*=d,a=a<this.endScale?this.endScale:a):this.startScale<this.endScale&&(a/=d,a=a>this.endScale?this.endScale:a);this.alpha=d;this.vel.x+=this.wind*c;this.vel.y+=this.gravity*c;d=this.followTrajectory?Math.atan2(this.vel.y,this.vel.x):this.angle;return this.transform.set(a,0,0,a,0,0).rotate(d),this.pos.x+=this.vel.x*c,this.pos.y+=this.vel.y*c,(this.inViewport||!this.onlyInViewport)&&0<this.life},draw:function(a){a.save();a.globalAlpha*=this.alpha;var c=
this.transform;a.transform(c.a,c.b,c.c,c.d,~~this.pos.x,~~this.pos.y);var c=this.width,d=this.height;a.drawImage(this.image,0,0,c,d,-c/2,-d/2,c,d);a.restore()}})})(window);var query=function(){var a={};if(window&&window.location.search){var c=window.location.search.substr(1).split("\x26"),d,b;for(d=0;d<c.length;++d)b=c[d].split("\x3d"),a[b[0]]=decodeURI(b[1])}a.toString=function(){var c="",b,d=0;for(b in a)a.hasOwnProperty(b)&&"toString"!==b&&(0<d&&(c+="\x26"),++d,c||(c+="?"),c+=b,c+="\x3d",c+=a[b]);return c};return a}(),game={siteUrl:"http://flappydragon.net",data:{score:0,steps:0,start:!1,newHiScore:!1},onload:function(){me.video.init("screen",900,600,!0,"auto")?
(me.audio.init("mp3,ogg"),me.loader.onload=this.loaded.bind(this),me.loader.preload(game.resources),me.state.change(me.state.LOADING)):alert("Your browser does not support HTML5 canvas.")},loaded:function(){me.state.set(me.state.MENU,new game.TitleScreen);me.state.set(me.state.PLAY,new game.PlayScreen);me.state.set(me.state.GAME_OVER,new game.GameOverScreen);me.state.transition("fade","#000",100);me.input.bindKey(me.input.KEY.SPACE,"fly",!0);me.input.bindTouch(me.input.KEY.SPACE);me.pool.register("clumsy",
BirdEntity);me.pool.register("pipe",PipeEntity,!0);me.pool.register("hit",HitEntity,!0);me.game.viewport.setBounds(0,0,900,600);me.state.change(me.state.MENU)}},replayController={_replayMode:!1,_flyItems:[],_pipeItems:[],_shortenReplayUrl:null,inReplayMode:function(){return this._replayMode},getShortenReplayUrl:function(){return this._shortenReplayUrl},eatFly:function(){return this._replayMode&&this._flyItems.length&&me.game.world.pipeGenerator.generate===this._flyItems[0]?(this._flyItems.shift(),
!0):!1},eatPipe:function(){return this._replayMode?this._flyItems.length?this._pipeItems.shift():!1:!1},init:function(a){var c=a.f;a=a.p;try{c&&a&&(this._flyItems=JSON.parse(c),this._pipeItems=JSON.parse(a)),this._flyItems&&(this._pipeItems&&this._pipeItems.length)&&(this._replayMode=!0)}catch(d){console.error("invalid parameters: ",d),this._replayMode=!1}},onGameOver:function(){var a="http://api.t.sina.com.cn/short_url/shorten.json?source\x3d3157843944\x26url_long\x3d"+encodeURIComponent(game.siteUrl+
"/"+this.queryString()),c=this;$.getJSON(a,{},function(a){a.length&&(c._shortenReplayUrl=a[0].url_short)})},reset:function(){this._replayMode=!1;this._flyItems=[];this._pipeItems=[];this._shortenReplayUrl=null},saveFly:function(){this._replayMode||this._flyItems.push(me.game.world.pipeGenerator.generate)},savePipe:function(a){this._replayMode||this._pipeItems.push(a)},queryString:function(){query.f=JSON.stringify(this._flyItems);query.p=JSON.stringify(this._pipeItems);return query.toString()}};replayController.init(query);game.resources=[{name:"bg",type:"image",src:"data/img/bg.png"},{name:"clumsy",type:"image",src:"data/img/clumsy.png"},{name:"pipe",type:"image",src:"data/img/pipe.png"},{name:"logo",type:"image",src:"data/img/logo.png"},{name:"ground",type:"image",src:"data/img/ground.png"},{name:"gameover",type:"image",src:"data/img/gameover.png"},{name:"gameoverbg",type:"image",src:"data/img/gameoverbg.png"},{name:"hit",type:"image",src:"data/img/hit.png"},{name:"getready",type:"image",src:"data/img/getready.png"},
{name:"new",type:"image",src:"data/img/new.png"},{name:"share",type:"image",src:"data/img/share.png"},{name:"tweet",type:"image",src:"data/img/tweet.png"},{name:"shareviasinaweibo",type:"image",src:"data/img/shareviasinaweibo.png"},{name:"theme",type:"audio",src:"data/bgm/"},{name:"intro",type:"audio",src:"data/bgm/"},{name:"gameover",type:"audio",src:"data/bgm/"},{name:"coin",type:"audio",src:"data/sfx/"},{name:"fly",type:"audio",src:"data/sfx/"}];var BirdEntity=me.ObjectEntity.extend({init:function(a,c){var d={};d.image=me.loader.getImage("clumsy");d.width=85;d.height=60;d.spritewidth=85;d.spriteheight=60;this.parent(a,c,d);this.alwaysUpdate=!0;this.gravity=0.2;this.gravityForce=0.01;this.maxAngleRotation=Number.prototype.degToRad(30);this.maxAngleRotationDown=Number.prototype.degToRad(90);this.renderable.addAnimation("flying",[0,1,2]);this.renderable.addAnimation("idle",[0]);this.renderable.setCurrentAnimation("flying");this.animationController=
0;this.addShape(new me.Rect(new me.Vector2d(5,5),70,50));this.flyTween=new me.Tween(this.pos);this.flyTween.easing(me.Tween.Easing.Exponential.InOut)},update:function(a){var c=!1;game.data.start&&(replayController.inReplayMode()?replayController.eatFly()&&(c=!0):(c=me.input.isKeyPressed("fly"))&&replayController.saveFly(),c?(this.gravityForce=0.01,c=this.pos.y,this.flyTween.stop(),this.flyTween.to({y:c-72},100),this.flyTween.start(),this.renderable.angle=-this.maxAngleRotation,me.audio.stop("fly"),
me.audio.play("fly",!1)):(this.gravityForce+=0.2,this.pos.y+=me.timer.tick*this.gravityForce,this.renderable.angle+=Number.prototype.degToRad(3)*me.timer.tick,this.renderable.angle>this.maxAngleRotationDown&&(this.renderable.angle=this.maxAngleRotationDown)));if(c=me.game.collide(this)){if("hit"!=c.obj.type)return me.state.change(me.state.GAME_OVER),!1;me.game.world.removeChildNow(c.obj);game.data.steps++;me.audio.play("coin",!1)}else if(this.pos.y>=me.game.viewport.height-156||-80>=this.pos.y)return me.state.change(me.state.GAME_OVER),
!1;return this.parent(a)}}),PipeEntity=me.ObjectEntity.extend({init:function(a,c){var d={};d.image=me.loader.getImage("pipe");d.width=148;d.height=1664;d.spritewidth=148;d.spriteheight=1664;this.parent(a,c,d);this.alwaysUpdate=!0;this.gravity=5;this.updateTime=!1},update:function(a){this.pos.add(new me.Vector2d(-this.gravity*me.timer.tick,0));-148>this.pos.x&&me.game.world.removeChild(this);return!0}}),PipeGenerator=me.Renderable.extend({init:function(){this.parent(new me.Vector2d,me.game.viewport.width,
me.game.viewport.height);this.alwaysUpdate=!0;this.generate=0;this.pipeFrequency=92;this.pipeHoleSize=1240;this.posX=me.game.viewport.width},update:function(a){if(0==this.generate++%this.pipeFrequency){var c=replayController.eatPipe();!1===c&&(c=Number.prototype.random(me.video.getHeight()-100,200));replayController.savePipe(c);var d=c-me.video.getHeight()-this.pipeHoleSize;a=new me.pool.pull("pipe",this.posX,c);d=new me.pool.pull("pipe",this.posX,d);c=new me.pool.pull("hit",this.posX,c-100);a.renderable.flipY();
me.game.world.addChild(a,10);me.game.world.addChild(d,10);me.game.world.addChild(c,11)}return!0}}),HitEntity=me.ObjectEntity.extend({init:function(a,c){var d={};d.image=me.loader.getImage("hit");d.width=148;d.height=60;d.spritewidth=148;d.spriteheight=60;this.parent(a,c,d);this.alwaysUpdate=!0;this.gravity=5;this.updateTime=!1;this.type="hit";this.renderable.alpha=0},update:function(){this.pos.add(new me.Vector2d(-this.gravity*me.timer.tick,0));-148>this.pos.x&&me.game.world.removeChild(this);return!0}});game.HUD=game.HUD||{};game.HUD.Container=me.ObjectContainer.extend({init:function(){this.parent();this.isPersistent=!0;this.collidable=!1;this.z=Infinity;this.name="HUD";this.addChild(new game.HUD.ScoreItem(5,5))}});
game.HUD.ScoreItem=me.Renderable.extend({init:function(a,c){this.parent(new me.Vector2d(a,c),10,10);this.stepsFont=new me.Font("Helvetica",60,"#000","center");this.floating=!0},update:function(){return!0},draw:function(a){game.data.start&&me.state.isCurrent(me.state.PLAY)&&this.stepsFont.draw(a,game.data.steps,50,10)}});
var BackgroundLayer=me.ImageLayer.extend({init:function(a,c,d){name=a;width=900;height=600;ratio=1;this.fixed=0<d?!1:!0;this.parent(name,width,height,a,c,ratio)},update:function(){this.fixed||(this.pos.x>=this.imagewidth-1&&(this.pos.x=0),this.pos.x+=this.speed);return!0}}),SHARE_VIA_SINA_WEIBO_BUTTON_WIDTH=187;
function getShareText(a){switch(a){case "zhCN":a="#flappydragon#\u6211\u521a\u521a\u5728\u86cb\u9f99\u5b9d\u5b9d\u5927\u5192\u9669\u4e2d\u83b7\u5f97\u4e86"+game.data.steps+"\u5206\uff0c\u4f60\u884c\u4e48\uff01\uff1f";replayController.getShortenReplayUrl()?a=a+"\u70b9\u51fb\u67e5\u770b\u6211\u7684\u6e38\u620f\u56de\u653e"+replayController.getShortenReplayUrl():(a+="\u70b9\u51fb\u5c31\u73a9\u513f!",a+=game.siteUrl);break;default:a="I just made "+game.data.steps+" step"+(1<game.data.steps?"s":"")+" on Flappy Dragon! Can you beat me?",
replayController.getShortenReplayUrl()?(a+=" Watch my replay here! ",a+=replayController.getShortenReplayUrl()):(a+=" Try it online here! ",a+=game.siteUrl)}return a}function getShareUrl(){var a=replayController.getShortenReplayUrl();a||(a=game.siteUrl);return a}
var Share=me.GUI_Object.extend({init:function(){var a={},c=me.video.getWidth()/2-185-SHARE_VIA_SINA_WEIBO_BUTTON_WIDTH/2,d=me.video.getHeight()/2+200;a.image="share";a.spritewidth=150;a.spriteheight=75;this.parent(c,d,a)},onClick:function(a){FB.ui({method:"feed",name:"My Flappy Dragon Score!",caption:"Share to your friends",description:getShareText("enUS"),link:getShareUrl(),picture:"http://flappydragon.net/data/img/Icon@2x.png"});return!1}}),Tweet=me.GUI_Object.extend({init:function(){var a={},c=
me.video.getWidth()/2+39+SHARE_VIA_SINA_WEIBO_BUTTON_WIDTH/2,d=me.video.getHeight()/2+200;a.image="tweet";a.spritewidth=152;a.spriteheight=75;this.parent(c,d,a)},onClick:function(a){window.open("https://twitter.com/intent/tweet?text\x3d"+getShareText("enUS")+"\x26hashtags\x3dflappydragon,clumsybird,melonjs","Tweet!","height\x3d300,width\x3d400");return!1}}),ShareViaSinaWeibo=me.GUI_Object.extend({init:function(){var a={},c=me.video.getWidth()/2-SHARE_VIA_SINA_WEIBO_BUTTON_WIDTH/2,d=me.video.getHeight()/
2+200;a.image="shareviasinaweibo";a.spritewidth=187;a.spriteheight=75;this.parent(c,d,a)},onClick:function(a){WB2.anyWhere(function(a){a.widget.publish({id:"publish",default_text:getShareText("zhCN"),default_image:"http://flappydragon.net/data/img/Icon@2x.png"})});return!1}});game.TitleScreen=me.ScreenObject.extend({onResetEvent:function(){game.data.newHiScore=!1;me.audio.playTrack("intro");me.game.world.addChild(new BackgroundLayer("bg",1));me.input.bindKey(me.input.KEY.ENTER,"enter",!0);me.input.bindKey(me.input.KEY.SPACE,"enter",!0);me.input.bindMouse(me.input.mouse.LEFT,me.input.KEY.ENTER);this.handler=me.event.subscribe(me.event.KEYDOWN,function(a,d,b){"enter"===a&&(me.state.change(me.state.PLAY),me.audio.stopTrack("intro"),me.audio.playTrack("theme"))});var a=me.loader.getImage("logo"),
a=new me.SpriteObject(me.game.viewport.width/2-170,-a,a);me.game.world.addChild(a,10);(new me.Tween(a.pos)).to({y:me.game.viewport.height/2-100},1E3).easing(me.Tween.Easing.Exponential.InOut).start();me.game.world.addChild(new (me.Renderable.extend({init:function(){this.parent(new me.Vector2d,100,100);this.font=new me.Font("Arial Black",20,"black","left");this.text=me.device.touch?"Tap to start":"PRESS SPACE OR CLICK LEFT MOUSE BUTTON TO START";replayController.inReplayMode()&&(this.text+=me.device.touch?
" reply":" REPLAY")},update:function(){return!0},draw:function(a){var d=this.font.measureText(a,this.text);this.font.draw(a,this.text,me.game.viewport.width/2-d.width/2,me.game.viewport.height/2+50)}})),12)},onDestroyEvent:function(){me.event.unsubscribe(this.handler);me.input.unbindKey(me.input.KEY.ENTER);me.input.unbindKey(me.input.KEY.SPACE);me.input.unbindMouse(me.input.mouse.LEFT)}});game.PlayScreen=me.ScreenObject.extend({onResetEvent:function(){me.input.bindKey(me.input.KEY.SPACE,"fly",!0);game.data.steps=0;game.data.start=!1;game.data.newHiscore=!1;me.game.world.addChild(new BackgroundLayer("bg",1));var a=me.loader.getImage("ground");this.ground=new me.SpriteObject(0,me.video.getHeight()-a.height,a);me.game.world.addChild(this.ground,11);this.HUD=new game.HUD.Container;me.game.world.addChild(this.HUD);this.bird=me.pool.pull("clumsy",60,me.game.viewport.height/2-100);me.game.world.addChild(this.bird,
10);me.input.bindMouse(me.input.mouse.LEFT,me.input.KEY.SPACE);me.state.transition("fade","#fff",100);this.getReady=new me.SpriteObject(me.video.getWidth()/2-200,me.video.getHeight()/2-100,me.loader.getImage("getready"));me.game.world.addChild(this.getReady,11);a=-132;replayController.inReplayMode()&&(a-=100);(new me.Tween(this.getReady.pos)).to({y:a},2E3).easing(me.Tween.Easing.Linear.None).onComplete(function(){var a=new PipeGenerator;me.game.world.pipeGenerator=a;game.data.start=!0;me.game.world.addChild(a,
0);replayController.inReplayMode()&&me.game.world.addChild(new (me.Renderable.extend({init:function(){this.parent(new me.Vector2d,100,100);this.font=new me.Font("Arial Black",20,"black","left");this.text="REPLAYING..."},draw:function(a){var c=this.font.measureText(a,this.text);this.font.draw(a,this.text,me.game.viewport.width/2-c.width/2,30)}})),12)}).start()},onDestroyEvent:function(){me.audio.stopTrack("theme");this.bird=this.HUD=null;me.input.unbindKey(me.input.KEY.SPACE)}});game.GameOverScreen=me.ScreenObject.extend({init:function(){this.shareViaSinaWeibo=this.tweet=this.share=this.dialog=this.handler=this.savedData=null},onResetEvent:function(){me.audio.play("gameover",!1);replayController.onGameOver();replayController.inReplayMode()||(this.savedData={steps:game.data.steps},me.save.add(this.savedData),me.save.topSteps||me.save.add({topSteps:game.data.steps}),game.data.steps>me.save.topSteps&&(me.save.topSteps=game.data.steps,game.data.newHiScore=!0));me.input.bindKey(me.input.KEY.ENTER,
"enter",!0);me.input.bindKey(me.input.KEY.SPACE,"enter",!1);me.input.bindMouse(me.input.mouse.LEFT,me.input.KEY.ENTER);this.handler=me.event.subscribe(me.event.KEYDOWN,function(a,d,b){"enter"===a&&(replayController.reset(),me.state.change(me.state.MENU))});me.game.world.addChild(new BackgroundLayer("bg",1));var a=me.loader.getImage("gameover");me.game.world.addChild(new me.SpriteObject(me.video.getWidth()/2-a.width/2,me.video.getHeight()/2-a.height/2-80,a),10);a=me.loader.getImage("gameoverbg");me.game.world.addChild(new me.SpriteObject(me.video.getWidth()/
2-a.width/2,me.video.getHeight()/2-a.height/2,a),10);replayController.inReplayMode()||(this.share=new Share,me.game.world.addChild(this.share,12),this.tweet=new Tweet,me.game.world.addChild(this.tweet,12),"undefined"!==typeof WB2?(this.shareViaSinaWeibo=new ShareViaSinaWeibo,me.game.world.addChild(this.shareViaSinaWeibo,12)):(this.tweet.pos.x-=SHARE_VIA_SINA_WEIBO_BUTTON_WIDTH/2,this.share.pos.x+=SHARE_VIA_SINA_WEIBO_BUTTON_WIDTH/2),game.data.newHiScore&&(a=new me.SpriteObject(235,385,me.loader.getImage("new")),
me.game.world.addChild(a,12)));this.dialog=new (me.Renderable.extend({init:function(){this.parent(new me.Vector2d,100,100);this.font=new me.Font("Arial Black",40,"black","left");this.steps="Steps: "+game.data.steps.toString();replayController.inReplayMode()||(this.topSteps="Top Step: "+me.save.topSteps.toString())},draw:function(a){var d=this.font.measureText(a,this.steps);this.font.draw(a,this.steps,me.game.viewport.width/2-d.width/2,me.game.viewport.height/2+10);!replayController.inReplayMode()&&
this.topSteps&&(d=this.font.measureText(a,this.topSteps),this.font.draw(a,this.topSteps,me.game.viewport.width/2-d.width/2,me.game.viewport.height/2+80))}}));me.game.world.addChild(this.dialog,12)},onDestroyEvent:function(){me.audio.stop("gameover");me.event.unsubscribe(this.handler);me.input.unbindKey(me.input.KEY.ENTER);me.input.unbindKey(me.input.KEY.SPACE);me.input.unbindMouse(me.input.mouse.LEFT)}});